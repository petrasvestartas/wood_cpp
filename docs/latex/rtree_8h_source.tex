\doxysection{rtree.\+h}
\hypertarget{rtree_8h_source}{}\label{rtree_8h_source}\index{C:/brg/2\_code/wood\_cpp/backend/src/wood/include/rtree.h@{C:/brg/2\_code/wood\_cpp/backend/src/wood/include/rtree.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#ifndef\ RTREE\_H}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#define\ RTREE\_H}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{comment}{//\ NOTE\ This\ file\ compiles\ under\ MSVC\ 6\ SP5\ and\ MSVC\ .Net\ 2003\ it\ may\ not\ work\ on\ other\ compilers\ without\ modification.}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{comment}{//\ NOTE\ These\ next\ few\ lines\ may\ be\ win32\ specific,\ you\ may\ need\ to\ modify\ them\ to\ compile\ on\ other\ platform}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{comment}{//\#include\ "{}../../stdafx.h"{}}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\#include\ <stdio.h>}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\#include\ <math.h>}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\#include\ <assert.h>}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\#include\ <stdlib.h>}}
\DoxyCodeLine{00014\ \textcolor{comment}{//}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\#include\ <algorithm>}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\#include\ <functional>}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\#include\ <vector>}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#define\ ASSERT\ assert\ }\textcolor{comment}{//\ RTree\ uses\ ASSERT(\ condition\ )}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\#ifndef\ Min}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\#define\ Min\ std::min}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\#endif\ //Min}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\#ifndef\ Max}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\#define\ Max\ std::max}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\#endif\ //Max}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{comment}{//}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ RTree.h}}
\DoxyCodeLine{00029\ \textcolor{comment}{//}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ RTREE\_TEMPLATE\ template\ <class\ DATATYPE,\ class\ ELEMTYPE,\ int\ NUMDIMS,\ class\ ELEMTYPEREAL,\ int\ TMAXNODES,\ int\ TMINNODES>}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ RTREE\_QUAL\ RTree<DATATYPE,\ ELEMTYPE,\ NUMDIMS,\ ELEMTYPEREAL,\ TMAXNODES,\ TMINNODES>}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ RTREE\_DONT\_USE\_MEMPOOLS\ \ \ \ }\textcolor{comment}{//\ This\ version\ does\ not\ contain\ a\ fixed\ memory\ allocator,\ fill\ in\ lines\ with\ EXAMPLE\ to\ implement\ one.}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ RTREE\_USE\_SPHERICAL\_VOLUME\ }\textcolor{comment}{//\ Better\ split\ classification,\ may\ be\ slower\ on\ some\ systems}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{comment}{//\ Fwd\ decl}}
\DoxyCodeLine{00038\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}};\ \textcolor{comment}{//\ File\ I/O\ helper\ class,\ look\ below\ for\ implementation\ and\ notes.}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00056\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }DATATYPE,\ \textcolor{keyword}{class\ }ELEMTYPE,\ \textcolor{keywordtype}{int}\ NUMDIMS,}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }ELEMTYPEREAL\ =\ ELEMTYPE,\ \textcolor{keywordtype}{int}\ TMAXNODES\ =\ 8,\ \textcolor{keywordtype}{int}\ TMINNODES\ =\ TMAXNODES\ /\ 2>}
\DoxyCodeLine{00058\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_r_tree}{RTree}}}
\DoxyCodeLine{00059\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::numeric\_limits<ELEMTYPEREAL>::is\_iec559,\ \textcolor{stringliteral}{"{}'ELEMTYPEREAL'\ accepts\ floating-\/point\ types\ only"{}});}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}};\ \textcolor{comment}{//\ Fwd\ decl.\ \ Used\ by\ other\ internal\ structs\ and\ iterator}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ These\ constant\ must\ be\ declared\ after\ Branch\ and\ before\ Node\ struct}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ Stuck\ up\ here\ for\ MSVC\ 6\ compiler.\ \ NSVC\ .NET\ 2003\ is\ much\ happier.}}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00069\ \ \ \ \ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_r_tree_afaccb2e611f17ff46b623771ad7043d7ac05afe446df73fa67991e5199453a37f}{MAXNODES}}\ =\ TMAXNODES,\ }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_r_tree_afaccb2e611f17ff46b623771ad7043d7a3be3d8c82fd5bfbd5e5a496e9877d71a}{MINNODES}}\ =\ TMINNODES,\ }
\DoxyCodeLine{00072\ \ \ \ \ \};}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{class_r_tree}{RTree}}();}
\DoxyCodeLine{00076\ \ \ \ \ \mbox{\hyperlink{class_r_tree}{RTree}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_r_tree}{RTree}}\ \&other);}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_r_tree}{\string~RTree}}();}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_tree_a98d1f0a325921db826b2a2d5a407c9be}{Insert}}(\textcolor{keyword}{const}\ ELEMTYPE\ a\_min[NUMDIMS],\ \textcolor{keyword}{const}\ ELEMTYPE\ a\_max[NUMDIMS],\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_dataId);}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_tree_a1b4b6b4c73bc47029ba696c49265c043}{Remove}}(\textcolor{keyword}{const}\ ELEMTYPE\ a\_min[NUMDIMS],\ \textcolor{keyword}{const}\ ELEMTYPE\ a\_max[NUMDIMS],\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_dataId);}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_r_tree_af98c1c13f24083a0a656b09a602c331b}{Search}}(\textcolor{keyword}{const}\ ELEMTYPE\ a\_min[NUMDIMS],\ \textcolor{keyword}{const}\ ELEMTYPE\ a\_max[NUMDIMS],\ std::function<\textcolor{keywordtype}{bool}(\textcolor{keyword}{const}\ DATATYPE\ \&)>\ callback)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_tree_a396f1031eb2c8224715741fd0b77349d}{RemoveAll}}();}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_r_tree_a813cdf63ce3e3e255821d9ba4bc9e7df}{Count}}();}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_adbd1f87715d22ed75b2b8be738583fc2}{Load}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *a\_fileName);}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_ad02dc25a34d9b5b291c8ff3f1b002b09}{Load}}(\mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_a6817692e1e8e416843be1ea628f7a074}{Save}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *a\_fileName);}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_a7066ea753180537a3a870c84e4fcefce}{Save}}(\mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream);}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_r_tree_1_1_iterator}{Iterator}}}
\DoxyCodeLine{00118\ \ \ \ \ \{}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ MAX\_STACK\ =\ 32}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \};\ \textcolor{comment}{//\ \ Max\ stack\ size.\ Allows\ almost\ n\string^32\ where\ n\ is\ number\ of\ branches\ in\ node}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }StackElement}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *m\_node;}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\_branchIndex;}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_r_tree_1_1_iterator}{Iterator}}()\ \{\ Init();\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_r_tree_1_1_iterator}{\string~Iterator}}()\ \{\}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_1_1_iterator_a23f756ac37acc2b162b61230c27732b3}{IsNull}}()\ \{\ \textcolor{keywordflow}{return}\ (m\_tos\ <=\ 0);\ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_1_1_iterator_a8cd6bf4fa228497ac736e8d7993e7daf}{IsNotNull}}()\ \{\ \textcolor{keywordflow}{return}\ (m\_tos\ >\ 0);\ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ DATATYPE\ \&\mbox{\hyperlink{class_r_tree_1_1_iterator_aa1321ced0bfd9ef4b4004238dec438c5}{operator*}}()}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(\mbox{\hyperlink{class_r_tree_1_1_iterator_a8cd6bf4fa228497ac736e8d7993e7daf}{IsNotNull}}());}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\ \&curTos\ =\ m\_stack[m\_tos\ -\/\ 1];}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ curTos.m\_node-\/>\mbox{\hyperlink{struct_r_tree_1_1_node_abc3b3eb3c889a004ca5a30628dd8775a}{m\_branch}}[curTos.m\_branchIndex].\mbox{\hyperlink{struct_r_tree_1_1_branch_afc1aee31a1a62ad4e800a536a3a9d665}{m\_data}};}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ DATATYPE\ \&\mbox{\hyperlink{class_r_tree_1_1_iterator_a865e4f60b6656520b9d95196ee7f081d}{operator*}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00152\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(\mbox{\hyperlink{class_r_tree_1_1_iterator_a8cd6bf4fa228497ac736e8d7993e7daf}{IsNotNull}}());}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\ \&curTos\ =\ m\_stack[m\_tos\ -\/\ 1];}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ curTos.m\_node-\/>\mbox{\hyperlink{struct_r_tree_1_1_node_abc3b3eb3c889a004ca5a30628dd8775a}{m\_branch}}[curTos.m\_branchIndex].\mbox{\hyperlink{struct_r_tree_1_1_branch_afc1aee31a1a62ad4e800a536a3a9d665}{m\_data}};}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_1_1_iterator_ad578bac71cfc7d324b84595032feda21}{operator++}}()\ \{\ \textcolor{keywordflow}{return}\ FindNextData();\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_tree_1_1_iterator_a65121f5016c2b1bf4696797748092709}{GetBounds}}(ELEMTYPE\ a\_min[NUMDIMS],\ ELEMTYPE\ a\_max[NUMDIMS])}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(\mbox{\hyperlink{class_r_tree_1_1_iterator_a8cd6bf4fa228497ac736e8d7993e7daf}{IsNotNull}}());}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\ \&curTos\ =\ m\_stack[m\_tos\ -\/\ 1];}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ \&curBranch\ =\ curTos.m\_node-\/>\mbox{\hyperlink{struct_r_tree_1_1_node_abc3b3eb3c889a004ca5a30628dd8775a}{m\_branch}}[curTos.m\_branchIndex];}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_min[index]\ =\ curBranch.\mbox{\hyperlink{struct_r_tree_1_1_branch_a7e98e0d7fb6afd18ec243450b22d9abe}{m\_rect}}.\mbox{\hyperlink{struct_r_tree_1_1_rect_a2b5b254493aba27b30fe6fc8df151ed5}{m\_min}}[index];}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_max[index]\ =\ curBranch.\mbox{\hyperlink{struct_r_tree_1_1_branch_a7e98e0d7fb6afd18ec243450b22d9abe}{m\_rect}}.\mbox{\hyperlink{struct_r_tree_1_1_rect_a6570c2a5a16b19b0d08cd1eaa224961b}{m\_max}}[index];}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ Init()\ \{\ m\_tos\ =\ 0;\ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ FindNextData()}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_tos\ <=\ 0)}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\ curTos\ =\ Pop();\ \textcolor{comment}{//\ Copy\ stack\ top\ cause\ it\ may\ change\ as\ we\ use\ it}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (curTos.m\_node-\/>IsLeaf())}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Keep\ walking\ through\ data\ while\ we\ can}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (curTos.m\_branchIndex\ +\ 1\ <\ curTos.m\_node-\/>m\_count)}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ There\ is\ more\ data,\ just\ point\ to\ the\ next\ one}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Push(curTos.m\_node,\ curTos.m\_branchIndex\ +\ 1);}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ more\ data,\ so\ it\ will\ fall\ back\ to\ previous\ level}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (curTos.m\_branchIndex\ +\ 1\ <\ curTos.m\_node-\/>m\_count)}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Push\ sibling\ on\ for\ future\ tree\ walk}}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ 'fall\ back'\ node\ when\ we\ finish\ with\ the\ current\ level}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Push(curTos.m\_node,\ curTos.m\_branchIndex\ +\ 1);}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Since\ cur\ node\ is\ not\ a\ leaf,\ push\ first\ of\ next\ level\ to\ get\ deeper\ into\ the\ tree}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Node\ *nextLevelnode\ =\ curTos.m\_node-\/>m\_branch[curTos.m\_branchIndex].m\_child;}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Push(nextLevelnode,\ 0);}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ pushed\ on\ a\ new\ leaf,\ exit\ as\ the\ data\ is\ ready\ at\ TOS}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nextLevelnode-\/>IsLeaf())}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ Push(Node\ *a\_node,\ \textcolor{keywordtype}{int}\ a\_branchIndex)}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ m\_stack[m\_tos].m\_node\ =\ a\_node;}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ m\_stack[m\_tos].m\_branchIndex\ =\ a\_branchIndex;}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ ++m\_tos;}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(m\_tos\ <=\ MAX\_STACK);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ StackElement\ \&Pop()}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(m\_tos\ >\ 0);}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/m\_tos;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_stack[m\_tos];}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ StackElement\ m\_stack[MAX\_STACK];\ }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\_tos;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_r_tree}{RTree}};\ \textcolor{comment}{//\ Allow\ hiding\ of\ non-\/public\ functions\ while\ allowing\ manipulation\ by\ logical\ owner}}
\DoxyCodeLine{00243\ \ \ \ \ \};}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_tree_acbcbd987b4f6549cd53e373e01b74efa}{GetFirst}}(\mbox{\hyperlink{class_r_tree_1_1_iterator}{Iterator}}\ \&a\_it)}
\DoxyCodeLine{00247\ \ \ \ \ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ a\_it.Init();}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *first\ =\ \mbox{\hyperlink{class_r_tree_a5028f4e28918519bc70cb1f615316582}{m\_root}};}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (first)}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (first-\/>IsInternalNode()\ \&\&\ first-\/>\mbox{\hyperlink{struct_r_tree_1_1_node_ab2393bb1bfe7c8baa84ec4f205d990ed}{m\_count}}\ >\ 1)}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_it.Push(first,\ 1);\ \textcolor{comment}{//\ Descend\ sibling\ branch\ later}}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (first-\/>IsLeaf())}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (first-\/>\mbox{\hyperlink{struct_r_tree_1_1_node_ab2393bb1bfe7c8baa84ec4f205d990ed}{m\_count}})}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_it.Push(first,\ 0);}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ first\ =\ first-\/>\mbox{\hyperlink{struct_r_tree_1_1_node_abc3b3eb3c889a004ca5a30628dd8775a}{m\_branch}}[0].\mbox{\hyperlink{struct_r_tree_1_1_branch_aa15f22000d06c726372eb84f46db0fa0}{m\_child}};}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00266\ \ \ \ \ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_tree_a41da97d27b44e7d7e852150ced23a610}{GetNext}}(\mbox{\hyperlink{class_r_tree_1_1_iterator}{Iterator}}\ \&a\_it)\ \{\ ++a\_it;\ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_a8b8c51698e5b8df1e715650a43aad7f4}{IsNull}}(\mbox{\hyperlink{class_r_tree_1_1_iterator}{Iterator}}\ \&a\_it)\ \{\ \textcolor{keywordflow}{return}\ a\_it.\mbox{\hyperlink{class_r_tree_1_1_iterator_a23f756ac37acc2b162b61230c27732b3}{IsNull}}();\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00275\ \ \ \ \ DATATYPE\ \&\mbox{\hyperlink{class_r_tree_a9199a66bf611567cd2b7b0229ecbc301}{GetAt}}(\mbox{\hyperlink{class_r_tree_1_1_iterator}{Iterator}}\ \&a\_it)\ \{\ \textcolor{keywordflow}{return}\ *a\_it;\ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}}
\DoxyCodeLine{00280\ \ \ \ \ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ ELEMTYPE\ \mbox{\hyperlink{struct_r_tree_1_1_rect_a2b5b254493aba27b30fe6fc8df151ed5}{m\_min}}[NUMDIMS];\ }
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ ELEMTYPE\ \mbox{\hyperlink{struct_r_tree_1_1_rect_a6570c2a5a16b19b0d08cd1eaa224961b}{m\_max}}[NUMDIMS];\ }
\DoxyCodeLine{00283\ \ \ \ \ \};}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}}
\DoxyCodeLine{00289\ \ \ \ \ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ \mbox{\hyperlink{struct_r_tree_1_1_branch_a7e98e0d7fb6afd18ec243450b22d9abe}{m\_rect}};\ \ \ \ \ }
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *\mbox{\hyperlink{struct_r_tree_1_1_branch_aa15f22000d06c726372eb84f46db0fa0}{m\_child}};\ \ \ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ DATATYPE\ \mbox{\hyperlink{struct_r_tree_1_1_branch_afc1aee31a1a62ad4e800a536a3a9d665}{m\_data}};\ }
\DoxyCodeLine{00293\ \ \ \ \ \};}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00296\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}}
\DoxyCodeLine{00297\ \ \ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ IsInternalNode()\ \{\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{struct_r_tree_1_1_node_a894162b955540567f0519bbbc33a6bf5}{m\_level}}\ >\ 0);\ \}\ \textcolor{comment}{//\ Not\ a\ leaf,\ but\ a\ internal\ node}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ IsLeaf()\ \{\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{struct_r_tree_1_1_node_a894162b955540567f0519bbbc33a6bf5}{m\_level}}\ ==\ 0);\ \}\ \ \ \ \ \ \ \ \textcolor{comment}{//\ A\ leaf,\ contains\ data}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_r_tree_1_1_node_ab2393bb1bfe7c8baa84ec4f205d990ed}{m\_count}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_r_tree_1_1_node_a894162b955540567f0519bbbc33a6bf5}{m\_level}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ \mbox{\hyperlink{struct_r_tree_1_1_node_abc3b3eb3c889a004ca5a30628dd8775a}{m\_branch}}[\mbox{\hyperlink{class_r_tree_afaccb2e611f17ff46b623771ad7043d7ac05afe446df73fa67991e5199453a37f}{MAXNODES}}];\ }
\DoxyCodeLine{00304\ \ \ \ \ \};}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_r_tree_1_1_list_node}{ListNode}}}
\DoxyCodeLine{00308\ \ \ \ \ \{}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_list_node}{ListNode}}\ *\mbox{\hyperlink{struct_r_tree_1_1_list_node_a9812899d8953b03f1772522b668942e3}{m\_next}};\ }
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *\mbox{\hyperlink{struct_r_tree_1_1_list_node_ade4b7e322e04e0a71b4e14cde8e73dca}{m\_node}};\ \ \ \ \ }
\DoxyCodeLine{00311\ \ \ \ \ \};}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_r_tree_1_1_partition_vars}{PartitionVars}}}
\DoxyCodeLine{00315\ \ \ \ \ \{}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ NOT\_TAKEN\ =\ -\/1}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \};\ \textcolor{comment}{//\ indicates\ that\ position}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\_partition[\mbox{\hyperlink{class_r_tree_afaccb2e611f17ff46b623771ad7043d7ac05afe446df73fa67991e5199453a37f}{MAXNODES}}\ +\ 1];}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\_total;}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\_minFill;}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\_count[2];}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ m\_cover[2];}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ m\_area[2];}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ m\_branchBuf[\mbox{\hyperlink{class_r_tree_afaccb2e611f17ff46b623771ad7043d7ac05afe446df73fa67991e5199453a37f}{MAXNODES}}\ +\ 1];}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\_branchCount;}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ m\_coverSplit;}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ m\_coverSplitArea;}
\DoxyCodeLine{00332\ \ \ \ \ \};}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *AllocNode();}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordtype}{void}\ FreeNode(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node);}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordtype}{void}\ InitNode(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node);}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordtype}{void}\ InitRect(\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect);}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordtype}{bool}\ InsertRectRec(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ \&a\_branch,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ **a\_newNode,\ \textcolor{keywordtype}{int}\ a\_level);}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keywordtype}{bool}\ InsertRect(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ \&a\_branch,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ **a\_root,\ \textcolor{keywordtype}{int}\ a\_level);}
\DoxyCodeLine{00340\ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ NodeCover(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node);}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordtype}{bool}\ AddBranch(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ *a\_branch,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ **a\_newNode);}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordtype}{void}\ DisconnectBranch(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \textcolor{keywordtype}{int}\ a\_index);}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordtype}{int}\ PickBranch(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node);}
\DoxyCodeLine{00344\ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ CombineRect(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rectA,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rectB);}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordtype}{void}\ SplitNode(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ *a\_branch,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ **a\_newNode);}
\DoxyCodeLine{00346\ \ \ \ \ ELEMTYPEREAL\ RectSphericalVolume(\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect);}
\DoxyCodeLine{00347\ \ \ \ \ ELEMTYPEREAL\ RectVolume(\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect);}
\DoxyCodeLine{00348\ \ \ \ \ ELEMTYPEREAL\ CalcRectVolume(\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect);}
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keywordtype}{void}\ GetBranches(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_tree_1_1_branch}{Branch}}\ *a\_branch,\ \mbox{\hyperlink{struct_r_tree_1_1_partition_vars}{PartitionVars}}\ *a\_parVars);}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordtype}{void}\ ChoosePartition(\mbox{\hyperlink{struct_r_tree_1_1_partition_vars}{PartitionVars}}\ *a\_parVars,\ \textcolor{keywordtype}{int}\ a\_minFill);}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordtype}{void}\ LoadNodes(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_nodeA,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_nodeB,\ \mbox{\hyperlink{struct_r_tree_1_1_partition_vars}{PartitionVars}}\ *a\_parVars);}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordtype}{void}\ InitParVars(\mbox{\hyperlink{struct_r_tree_1_1_partition_vars}{PartitionVars}}\ *a\_parVars,\ \textcolor{keywordtype}{int}\ a\_maxRects,\ \textcolor{keywordtype}{int}\ a\_minFill);}
\DoxyCodeLine{00353\ \ \ \ \ \textcolor{keywordtype}{void}\ PickSeeds(\mbox{\hyperlink{struct_r_tree_1_1_partition_vars}{PartitionVars}}\ *a\_parVars);}
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keywordtype}{void}\ Classify(\textcolor{keywordtype}{int}\ a\_index,\ \textcolor{keywordtype}{int}\ a\_group,\ \mbox{\hyperlink{struct_r_tree_1_1_partition_vars}{PartitionVars}}\ *a\_parVars);}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordtype}{bool}\ RemoveRect(\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect,\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_id,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ **a\_root);}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordtype}{bool}\ RemoveRectRec(\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect,\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_id,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \mbox{\hyperlink{struct_r_tree_1_1_list_node}{ListNode}}\ **a\_listNode);}
\DoxyCodeLine{00357\ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_list_node}{ListNode}}\ *AllocListNode();}
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{keywordtype}{void}\ FreeListNode(\mbox{\hyperlink{struct_r_tree_1_1_list_node}{ListNode}}\ *a\_listNode);}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordtype}{bool}\ Overlap(\mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rectA,\ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rectB)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordtype}{void}\ ReInsert(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \mbox{\hyperlink{struct_r_tree_1_1_list_node}{ListNode}}\ **a\_listNode);}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_tree_af98c1c13f24083a0a656b09a602c331b}{Search}}(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \mbox{\hyperlink{struct_r_tree_1_1_rect}{Rect}}\ *a\_rect,\ \textcolor{keywordtype}{int}\ \&a\_foundCount,\ std::function<\textcolor{keywordtype}{bool}(\textcolor{keyword}{const}\ DATATYPE\ \&)>\ callback)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordtype}{void}\ RemoveAllRec(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node);}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordtype}{void}\ Reset();}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordtype}{void}\ CountRec(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \textcolor{keywordtype}{int}\ \&a\_count);}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordtype}{bool}\ SaveRec(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream);}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordtype}{bool}\ LoadRec(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *a\_node,\ \mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream);}
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keywordtype}{void}\ CopyRec(\mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *current,\ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *other);}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{struct_r_tree_1_1_node}{Node}}\ *\mbox{\hyperlink{class_r_tree_a5028f4e28918519bc70cb1f615316582}{m\_root}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00371\ \ \ \ \ ELEMTYPEREAL\ \mbox{\hyperlink{class_r_tree_af26d4beb8ce3a381ee75eabeec4727e3}{m\_unitSphereVolume}};\ }
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{comment}{//\ return\ all\ the\ AABBs\ that\ form\ the\ RTree}}
\DoxyCodeLine{00375\ \ \ \ \ std::vector<Rect>\ ListTree()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00376\ \};}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \textcolor{comment}{//\ Because\ there\ is\ not\ stream\ support,\ this\ is\ a\ quick\ and\ dirty\ file\ I/O\ helper.}}
\DoxyCodeLine{00379\ \textcolor{comment}{//\ Users\ will\ likely\ replace\ its\ usage\ with\ a\ Stream\ implementation\ from\ their\ favorite\ API.}}
\DoxyCodeLine{00380\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}}
\DoxyCodeLine{00381\ \{}
\DoxyCodeLine{00382\ \ \ \ \ FILE\ *m\_file;}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00385\ \ \ \ \ \mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}()}
\DoxyCodeLine{00386\ \ \ \ \ \{}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ m\_file\ =\ NULL;}
\DoxyCodeLine{00388\ \ \ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \mbox{\hyperlink{class_r_t_file_stream}{\string~RTFileStream}}()}
\DoxyCodeLine{00391\ \ \ \ \ \{}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ Close();}
\DoxyCodeLine{00393\ \ \ \ \ \}}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \ \ \textcolor{keywordtype}{bool}\ Open(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *a\_fileName,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *mode)}
\DoxyCodeLine{00396\ \ \ \ \ \{}
\DoxyCodeLine{00397\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)\ \&\&\ defined(\_\_STDC\_WANT\_SECURE\_LIB\_\_)}}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ fopen\_s(\&m\_file,\ a\_fileName,\ mode)\ ==\ 0;}
\DoxyCodeLine{00399\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ m\_file\ =\ fopen(a\_fileName,\ mode);}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_file\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00402\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00403\ \ \ \ \ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordtype}{bool}\ OpenRead(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *a\_fileName)}
\DoxyCodeLine{00406\ \ \ \ \ \{}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>Open(a\_fileName,\ \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{00408\ \ \ \ \ \}}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{keywordtype}{bool}\ OpenWrite(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *a\_fileName)}
\DoxyCodeLine{00411\ \ \ \ \ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>Open(a\_fileName,\ \textcolor{stringliteral}{"{}wb"{}});}
\DoxyCodeLine{00413\ \ \ \ \ \}}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordtype}{void}\ Close()}
\DoxyCodeLine{00416\ \ \ \ \ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_file)}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ fclose(m\_file);}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ m\_file\ =\ NULL;}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00422\ \ \ \ \ \}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TYPE>}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ Write(\textcolor{keyword}{const}\ TYPE\ \&a\_value)}
\DoxyCodeLine{00426\ \ \ \ \ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ ASSERT(m\_file);}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ fwrite((\textcolor{keywordtype}{void}\ *)\&a\_value,\ \textcolor{keyword}{sizeof}(a\_value),\ 1,\ m\_file);}
\DoxyCodeLine{00429\ \ \ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TYPE>}
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ WriteArray(\textcolor{keyword}{const}\ TYPE\ *a\_array,\ \textcolor{keywordtype}{int}\ a\_count)}
\DoxyCodeLine{00433\ \ \ \ \ \{}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ ASSERT(m\_file);}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ fwrite((\textcolor{keywordtype}{void}\ *)a\_array,\ \textcolor{keyword}{sizeof}(TYPE)\ *\ a\_count,\ 1,\ m\_file);}
\DoxyCodeLine{00436\ \ \ \ \ \}}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TYPE>}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ Read(TYPE\ \&a\_value)}
\DoxyCodeLine{00440\ \ \ \ \ \{}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ ASSERT(m\_file);}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ fread((\textcolor{keywordtype}{void}\ *)\&a\_value,\ \textcolor{keyword}{sizeof}(a\_value),\ 1,\ m\_file);}
\DoxyCodeLine{00443\ \ \ \ \ \}}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TYPE>}
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ ReadArray(TYPE\ *a\_array,\ \textcolor{keywordtype}{int}\ a\_count)}
\DoxyCodeLine{00447\ \ \ \ \ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ ASSERT(m\_file);}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ fread((\textcolor{keywordtype}{void}\ *)a\_array,\ \textcolor{keyword}{sizeof}(TYPE)\ *\ a\_count,\ 1,\ m\_file);}
\DoxyCodeLine{00450\ \ \ \ \ \}}
\DoxyCodeLine{00451\ \};}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ RTREE\_TEMPLATE}
\DoxyCodeLine{00454\ RTREE\_QUAL::RTree()}
\DoxyCodeLine{00455\ \{}
\DoxyCodeLine{00456\ \ \ \ \ ASSERT(MAXNODES\ >\ MINNODES);}
\DoxyCodeLine{00457\ \ \ \ \ ASSERT(MINNODES\ >\ 0);}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{comment}{//\ Precomputed\ volumes\ of\ the\ unit\ spheres\ for\ the\ first\ few\ dimensions}}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ UNIT\_SPHERE\_VOLUMES[]\ =\ \{}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ 0.000000f,\ 2.000000f,\ 3.141593f,\ \textcolor{comment}{//\ Dimension\ \ 0,1,2}}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ 4.188790f,\ 4.934802f,\ 5.263789f,\ \textcolor{comment}{//\ Dimension\ \ 3,4,5}}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ 5.167713f,\ 4.724766f,\ 4.058712f,\ \textcolor{comment}{//\ Dimension\ \ 6,7,8}}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ 3.298509f,\ 2.550164f,\ 1.884104f,\ \textcolor{comment}{//\ Dimension\ \ 9,10,11}}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ 1.335263f,\ 0.910629f,\ 0.599265f,\ \textcolor{comment}{//\ Dimension\ \ 12,13,14}}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ 0.381443f,\ 0.235331f,\ 0.140981f,\ \textcolor{comment}{//\ Dimension\ \ 15,16,17}}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ 0.082146f,\ 0.046622f,\ 0.025807f,\ \textcolor{comment}{//\ Dimension\ \ 18,19,20}}
\DoxyCodeLine{00468\ \ \ \ \ \};}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ m\_root\ =\ AllocNode();}
\DoxyCodeLine{00471\ \ \ \ \ m\_root-\/>m\_level\ =\ 0;}
\DoxyCodeLine{00472\ \ \ \ \ m\_unitSphereVolume\ =\ (ELEMTYPEREAL)UNIT\_SPHERE\_VOLUMES[NUMDIMS];}
\DoxyCodeLine{00473\ \}}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ RTREE\_TEMPLATE}
\DoxyCodeLine{00476\ RTREE\_QUAL::RTree(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_r_tree}{RTree}}\ \&other)\ :\ \mbox{\hyperlink{class_r_tree}{RTree}}()}
\DoxyCodeLine{00477\ \{}
\DoxyCodeLine{00478\ \ \ \ \ CopyRec(m\_root,\ other.\mbox{\hyperlink{class_r_tree_a5028f4e28918519bc70cb1f615316582}{m\_root}});}
\DoxyCodeLine{00479\ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ RTREE\_TEMPLATE}
\DoxyCodeLine{00482\ RTREE\_QUAL::\string~RTree()}
\DoxyCodeLine{00483\ \{}
\DoxyCodeLine{00484\ \ \ \ \ Reset();\ \textcolor{comment}{//\ Free,\ or\ reset\ node\ memory}}
\DoxyCodeLine{00485\ \}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ RTREE\_TEMPLATE}
\DoxyCodeLine{00488\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::Insert(\textcolor{keyword}{const}\ ELEMTYPE\ a\_min[NUMDIMS],\ \textcolor{keyword}{const}\ ELEMTYPE\ a\_max[NUMDIMS],\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_dataId)}
\DoxyCodeLine{00489\ \{}
\DoxyCodeLine{00490\ \textcolor{preprocessor}{\#ifdef\ \_DEBUG}}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{00492\ \ \ \ \ \{}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ ASSERT(a\_min[index]\ <=\ a\_max[index]);}
\DoxyCodeLine{00494\ \ \ \ \ \}}
\DoxyCodeLine{00495\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\_DEBUG}}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \ \ \ \ Branch\ branch;}
\DoxyCodeLine{00498\ \ \ \ \ branch.m\_data\ =\ a\_dataId;}
\DoxyCodeLine{00499\ \ \ \ \ branch.m\_child\ =\ NULL;}
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ axis\ =\ 0;\ axis\ <\ NUMDIMS;\ ++axis)}
\DoxyCodeLine{00502\ \ \ \ \ \{}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ branch.m\_rect.m\_min[axis]\ =\ a\_min[axis];}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ branch.m\_rect.m\_max[axis]\ =\ a\_max[axis];}
\DoxyCodeLine{00505\ \ \ \ \ \}}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \ \ InsertRect(branch,\ \&m\_root,\ 0);}
\DoxyCodeLine{00508\ \}}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ RTREE\_TEMPLATE}
\DoxyCodeLine{00511\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::Remove(\textcolor{keyword}{const}\ ELEMTYPE\ a\_min[NUMDIMS],\ \textcolor{keyword}{const}\ ELEMTYPE\ a\_max[NUMDIMS],\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_dataId)}
\DoxyCodeLine{00512\ \{}
\DoxyCodeLine{00513\ \textcolor{preprocessor}{\#ifdef\ \_DEBUG}}
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{00515\ \ \ \ \ \{}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ ASSERT(a\_min[index]\ <=\ a\_max[index]);}
\DoxyCodeLine{00517\ \ \ \ \ \}}
\DoxyCodeLine{00518\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\_DEBUG}}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ Rect\ rect;}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ axis\ =\ 0;\ axis\ <\ NUMDIMS;\ ++axis)}
\DoxyCodeLine{00523\ \ \ \ \ \{}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ rect.m\_min[axis]\ =\ a\_min[axis];}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ rect.m\_max[axis]\ =\ a\_max[axis];}
\DoxyCodeLine{00526\ \ \ \ \ \}}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \ \ \ RemoveRect(\&rect,\ a\_dataId,\ \&m\_root);}
\DoxyCodeLine{00529\ \}}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ RTREE\_TEMPLATE}
\DoxyCodeLine{00532\ \textcolor{keywordtype}{int}\ RTREE\_QUAL::Search(\textcolor{keyword}{const}\ ELEMTYPE\ a\_min[NUMDIMS],\ \textcolor{keyword}{const}\ ELEMTYPE\ a\_max[NUMDIMS],\ std::function<\textcolor{keywordtype}{bool}(\textcolor{keyword}{const}\ DATATYPE\ \&)>\ callback)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00533\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00534\ \textcolor{preprocessor}{\#ifdef\ \_DEBUG}}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{00536\ \ \ \ \ \{}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ ASSERT(a\_min[index]\ <=\ a\_max[index]);}
\DoxyCodeLine{00538\ \ \ \ \ \}}
\DoxyCodeLine{00539\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\_DEBUG}}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \ \ Rect\ rect;}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ axis\ =\ 0;\ axis\ <\ NUMDIMS;\ ++axis)}
\DoxyCodeLine{00544\ \ \ \ \ \{}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ rect.m\_min[axis]\ =\ a\_min[axis];}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ rect.m\_max[axis]\ =\ a\_max[axis];}
\DoxyCodeLine{00547\ \ \ \ \ \}}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00549\ \ \ \ \ \textcolor{comment}{//\ NOTE:\ May\ want\ to\ return\ search\ result\ another\ way,\ perhaps\ returning\ the\ number\ of\ found\ elements\ here.}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{keywordtype}{int}\ foundCount\ =\ 0;}
\DoxyCodeLine{00552\ \ \ \ \ Search(m\_root,\ \&rect,\ foundCount,\ callback);}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \ \ \textcolor{keywordflow}{return}\ foundCount;}
\DoxyCodeLine{00555\ \}}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ RTREE\_TEMPLATE}
\DoxyCodeLine{00558\ \textcolor{keywordtype}{int}\ RTREE\_QUAL::Count()}
\DoxyCodeLine{00559\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \textcolor{keywordtype}{int}\ count\ =\ 0;}
\DoxyCodeLine{00561\ \ \ \ \ CountRec(m\_root,\ count);}
\DoxyCodeLine{00562\ }
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keywordflow}{return}\ count;}
\DoxyCodeLine{00564\ \}}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ RTREE\_TEMPLATE}
\DoxyCodeLine{00567\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::CountRec(Node\ *a\_node,\ \textcolor{keywordtype}{int}\ \&a\_count)}
\DoxyCodeLine{00568\ \{}
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>IsInternalNode())\ \textcolor{comment}{//\ not\ a\ leaf\ node}}
\DoxyCodeLine{00570\ \ \ \ \ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ CountRec(a\_node-\/>m\_branch[index].m\_child,\ a\_count);}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00575\ \ \ \ \ \}}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ A\ leaf\ node}}
\DoxyCodeLine{00577\ \ \ \ \ \{}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ a\_count\ +=\ a\_node-\/>m\_count;}
\DoxyCodeLine{00579\ \ \ \ \ \}}
\DoxyCodeLine{00580\ \}}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00582\ RTREE\_TEMPLATE}
\DoxyCodeLine{00583\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::Load(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *a\_fileName)}
\DoxyCodeLine{00584\ \{}
\DoxyCodeLine{00585\ \ \ \ \ RemoveAll();\ \textcolor{comment}{//\ Clear\ existing\ tree}}
\DoxyCodeLine{00586\ }
\DoxyCodeLine{00587\ \ \ \ \ \mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ stream;}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordflow}{if}\ (!stream.OpenRead(a\_fileName))}
\DoxyCodeLine{00589\ \ \ \ \ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00591\ \ \ \ \ \}}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keywordtype}{bool}\ result\ =\ Load(stream);}
\DoxyCodeLine{00594\ }
\DoxyCodeLine{00595\ \ \ \ \ stream.Close();}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00598\ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ RTREE\_TEMPLATE}
\DoxyCodeLine{00601\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::Load(\mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream)}
\DoxyCodeLine{00602\ \{}
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{comment}{//\ Write\ some\ kind\ of\ header}}
\DoxyCodeLine{00604\ \ \ \ \ \textcolor{keywordtype}{int}\ \_dataFileId\ =\ (\textcolor{charliteral}{'R'}\ <<\ 0)\ |\ (\textcolor{charliteral}{'T'}\ <<\ 8)\ |\ (\textcolor{charliteral}{'R'}\ <<\ 16)\ |\ (\textcolor{charliteral}{'E'}\ <<\ 24);}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keywordtype}{int}\ \_dataSize\ =\ \textcolor{keyword}{sizeof}(DATATYPE);}
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{keywordtype}{int}\ \_dataNumDims\ =\ NUMDIMS;}
\DoxyCodeLine{00607\ \ \ \ \ \textcolor{keywordtype}{int}\ \_dataElemSize\ =\ \textcolor{keyword}{sizeof}(ELEMTYPE);}
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keywordtype}{int}\ \_dataElemRealSize\ =\ \textcolor{keyword}{sizeof}(ELEMTYPEREAL);}
\DoxyCodeLine{00609\ \ \ \ \ \textcolor{keywordtype}{int}\ \_dataMaxNodes\ =\ TMAXNODES;}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{keywordtype}{int}\ \_dataMinNodes\ =\ TMINNODES;}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{keywordtype}{int}\ dataFileId\ =\ 0;}
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{keywordtype}{int}\ dataSize\ =\ 0;}
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordtype}{int}\ dataNumDims\ =\ 0;}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{keywordtype}{int}\ dataElemSize\ =\ 0;}
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{keywordtype}{int}\ dataElemRealSize\ =\ 0;}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keywordtype}{int}\ dataMaxNodes\ =\ 0;}
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{keywordtype}{int}\ dataMinNodes\ =\ 0;}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ \ \ a\_stream.Read(dataFileId);}
\DoxyCodeLine{00621\ \ \ \ \ a\_stream.Read(dataSize);}
\DoxyCodeLine{00622\ \ \ \ \ a\_stream.Read(dataNumDims);}
\DoxyCodeLine{00623\ \ \ \ \ a\_stream.Read(dataElemSize);}
\DoxyCodeLine{00624\ \ \ \ \ a\_stream.Read(dataElemRealSize);}
\DoxyCodeLine{00625\ \ \ \ \ a\_stream.Read(dataMaxNodes);}
\DoxyCodeLine{00626\ \ \ \ \ a\_stream.Read(dataMinNodes);}
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00628\ \ \ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \ \ \textcolor{comment}{//\ Test\ if\ header\ was\ valid\ and\ compatible}}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{keywordflow}{if}\ ((dataFileId\ ==\ \_dataFileId)\ \&\&\ (dataSize\ ==\ \_dataSize)\ \&\&\ (dataNumDims\ ==\ \_dataNumDims)\ \&\&\ (dataElemSize\ ==\ \_dataElemSize)\ \&\&\ (dataElemRealSize\ ==\ \_dataElemRealSize)\ \&\&\ (dataMaxNodes\ ==\ \_dataMaxNodes)\ \&\&\ (dataMinNodes\ ==\ \_dataMinNodes))}
\DoxyCodeLine{00632\ \ \ \ \ \{}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Recursively\ load\ tree}}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ result\ =\ LoadRec(m\_root,\ a\_stream);}
\DoxyCodeLine{00635\ \ \ \ \ \}}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00638\ \}}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ RTREE\_TEMPLATE}
\DoxyCodeLine{00641\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::LoadRec(Node\ *a\_node,\ \mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream)}
\DoxyCodeLine{00642\ \{}
\DoxyCodeLine{00643\ \ \ \ \ a\_stream.Read(a\_node-\/>m\_level);}
\DoxyCodeLine{00644\ \ \ \ \ a\_stream.Read(a\_node-\/>m\_count);}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>IsInternalNode())\ \textcolor{comment}{//\ not\ a\ leaf\ node}}
\DoxyCodeLine{00647\ \ \ \ \ \{}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *curBranch\ =\ \&a\_node-\/>m\_branch[index];}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}
\DoxyCodeLine{00654\ }
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ curBranch-\/>m\_child\ =\ AllocNode();}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ LoadRec(curBranch-\/>m\_child,\ a\_stream);}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00658\ \ \ \ \ \}}
\DoxyCodeLine{00659\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ A\ leaf\ node}}
\DoxyCodeLine{00660\ \ \ \ \ \{}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *curBranch\ =\ \&a\_node-\/>m\_branch[index];}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}
\DoxyCodeLine{00667\ }
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.Read(curBranch-\/>m\_data);}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00670\ \ \ \ \ \}}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ Should\ do\ more\ error\ checking\ on\ I/O\ operations}}
\DoxyCodeLine{00673\ \}}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ RTREE\_TEMPLATE}
\DoxyCodeLine{00676\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::CopyRec(Node\ *current,\ Node\ *other)}
\DoxyCodeLine{00677\ \{}
\DoxyCodeLine{00678\ \ \ \ \ current-\/>m\_level\ =\ other-\/>m\_level;}
\DoxyCodeLine{00679\ \ \ \ \ current-\/>m\_count\ =\ other-\/>m\_count;}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{keywordflow}{if}\ (current-\/>IsInternalNode())\ \textcolor{comment}{//\ not\ a\ leaf\ node}}
\DoxyCodeLine{00682\ \ \ \ \ \{}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ current-\/>m\_count;\ ++index)}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *currentBranch\ =\ \&current-\/>m\_branch[index];}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *otherBranch\ =\ \&other-\/>m\_branch[index];}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_min,}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_min\ +\ NUMDIMS,}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_min);}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_max,}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_max\ +\ NUMDIMS,}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_max);}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_child\ =\ AllocNode();}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ CopyRec(currentBranch-\/>m\_child,\ otherBranch-\/>m\_child);}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00699\ \ \ \ \ \}}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ A\ leaf\ node}}
\DoxyCodeLine{00701\ \ \ \ \ \{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ current-\/>m\_count;\ ++index)}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *currentBranch\ =\ \&current-\/>m\_branch[index];}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *otherBranch\ =\ \&other-\/>m\_branch[index];}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_min,}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_min\ +\ NUMDIMS,}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_min);}
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_max,}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_max\ +\ NUMDIMS,}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_max);}
\DoxyCodeLine{00714\ }
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_data\ =\ otherBranch-\/>m\_data;}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00717\ \ \ \ \ \}}
\DoxyCodeLine{00718\ \}}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ RTREE\_TEMPLATE}
\DoxyCodeLine{00721\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::Save(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *a\_fileName)}
\DoxyCodeLine{00722\ \{}
\DoxyCodeLine{00723\ \ \ \ \ \mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ stream;}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordflow}{if}\ (!stream.OpenWrite(a\_fileName))}
\DoxyCodeLine{00725\ \ \ \ \ \{}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00727\ \ \ \ \ \}}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ \ \ \textcolor{keywordtype}{bool}\ result\ =\ Save(stream);}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \ \ stream.Close();}
\DoxyCodeLine{00732\ }
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00734\ \}}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ RTREE\_TEMPLATE}
\DoxyCodeLine{00737\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::Save(\mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream)}
\DoxyCodeLine{00738\ \{}
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{comment}{//\ Write\ some\ kind\ of\ header}}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{keywordtype}{int}\ dataFileId\ =\ (\textcolor{charliteral}{'R'}\ <<\ 0)\ |\ (\textcolor{charliteral}{'T'}\ <<\ 8)\ |\ (\textcolor{charliteral}{'R'}\ <<\ 16)\ |\ (\textcolor{charliteral}{'E'}\ <<\ 24);}
\DoxyCodeLine{00741\ \ \ \ \ \textcolor{keywordtype}{int}\ dataSize\ =\ \textcolor{keyword}{sizeof}(DATATYPE);}
\DoxyCodeLine{00742\ \ \ \ \ \textcolor{keywordtype}{int}\ dataNumDims\ =\ NUMDIMS;}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{keywordtype}{int}\ dataElemSize\ =\ \textcolor{keyword}{sizeof}(ELEMTYPE);}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{keywordtype}{int}\ dataElemRealSize\ =\ \textcolor{keyword}{sizeof}(ELEMTYPEREAL);}
\DoxyCodeLine{00745\ \ \ \ \ \textcolor{keywordtype}{int}\ dataMaxNodes\ =\ TMAXNODES;}
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordtype}{int}\ dataMinNodes\ =\ TMINNODES;}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00748\ \ \ \ \ a\_stream.Write(dataFileId);}
\DoxyCodeLine{00749\ \ \ \ \ a\_stream.Write(dataSize);}
\DoxyCodeLine{00750\ \ \ \ \ a\_stream.Write(dataNumDims);}
\DoxyCodeLine{00751\ \ \ \ \ a\_stream.Write(dataElemSize);}
\DoxyCodeLine{00752\ \ \ \ \ a\_stream.Write(dataElemRealSize);}
\DoxyCodeLine{00753\ \ \ \ \ a\_stream.Write(dataMaxNodes);}
\DoxyCodeLine{00754\ \ \ \ \ a\_stream.Write(dataMinNodes);}
\DoxyCodeLine{00755\ }
\DoxyCodeLine{00756\ \ \ \ \ \textcolor{comment}{//\ Recursively\ save\ tree}}
\DoxyCodeLine{00757\ \ \ \ \ \textcolor{keywordtype}{bool}\ result\ =\ SaveRec(m\_root,\ a\_stream);}
\DoxyCodeLine{00758\ }
\DoxyCodeLine{00759\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00760\ \}}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00762\ RTREE\_TEMPLATE}
\DoxyCodeLine{00763\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::SaveRec(Node\ *a\_node,\ \mbox{\hyperlink{class_r_t_file_stream}{RTFileStream}}\ \&a\_stream)}
\DoxyCodeLine{00764\ \{}
\DoxyCodeLine{00765\ \ \ \ \ a\_stream.Write(a\_node-\/>m\_level);}
\DoxyCodeLine{00766\ \ \ \ \ a\_stream.Write(a\_node-\/>m\_count);}
\DoxyCodeLine{00767\ }
\DoxyCodeLine{00768\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>IsInternalNode())\ \textcolor{comment}{//\ not\ a\ leaf\ node}}
\DoxyCodeLine{00769\ \ \ \ \ \{}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *curBranch\ =\ \&a\_node-\/>m\_branch[index];}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}
\DoxyCodeLine{00776\ }
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ SaveRec(curBranch-\/>m\_child,\ a\_stream);}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00779\ \ \ \ \ \}}
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ A\ leaf\ node}}
\DoxyCodeLine{00781\ \ \ \ \ \{}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ *curBranch\ =\ \&a\_node-\/>m\_branch[index];}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ a\_stream.Write(curBranch-\/>m\_data);}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00791\ \ \ \ \ \}}
\DoxyCodeLine{00792\ }
\DoxyCodeLine{00793\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ Should\ do\ more\ error\ checking\ on\ I/O\ operations}}
\DoxyCodeLine{00794\ \}}
\DoxyCodeLine{00795\ }
\DoxyCodeLine{00796\ RTREE\_TEMPLATE}
\DoxyCodeLine{00797\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::RemoveAll()}
\DoxyCodeLine{00798\ \{}
\DoxyCodeLine{00799\ \ \ \ \ \textcolor{comment}{//\ Delete\ all\ existing\ nodes}}
\DoxyCodeLine{00800\ \ \ \ \ Reset();}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ \ \ m\_root\ =\ AllocNode();}
\DoxyCodeLine{00803\ \ \ \ \ m\_root-\/>m\_level\ =\ 0;}
\DoxyCodeLine{00804\ \}}
\DoxyCodeLine{00805\ }
\DoxyCodeLine{00806\ RTREE\_TEMPLATE}
\DoxyCodeLine{00807\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::Reset()}
\DoxyCodeLine{00808\ \{}
\DoxyCodeLine{00809\ \textcolor{preprocessor}{\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{comment}{//\ Delete\ all\ existing\ nodes}}
\DoxyCodeLine{00811\ \ \ \ \ RemoveAllRec(m\_root);}
\DoxyCodeLine{00812\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00813\ \ \ \ \ \textcolor{comment}{//\ Just\ reset\ memory\ pools.\ \ We\ are\ not\ using\ complex\ types}}
\DoxyCodeLine{00814\ \ \ \ \ \textcolor{comment}{//\ EXAMPLE}}
\DoxyCodeLine{00815\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00816\ \}}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00818\ RTREE\_TEMPLATE}
\DoxyCodeLine{00819\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::RemoveAllRec(Node\ *a\_node)}
\DoxyCodeLine{00820\ \{}
\DoxyCodeLine{00821\ \ \ \ \ ASSERT(a\_node);}
\DoxyCodeLine{00822\ \ \ \ \ ASSERT(a\_node-\/>m\_level\ >=\ 0);}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>IsInternalNode())\ \textcolor{comment}{//\ This\ is\ an\ internal\ node\ in\ the\ tree}}
\DoxyCodeLine{00825\ \ \ \ \ \{}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \ \ \ \ RemoveAllRec(a\_node-\/>m\_branch[index].m\_child);}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00830\ \ \ \ \ \}}
\DoxyCodeLine{00831\ \ \ \ \ FreeNode(a\_node);}
\DoxyCodeLine{00832\ \}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ RTREE\_TEMPLATE}
\DoxyCodeLine{00835\ \textcolor{keyword}{typename}\ RTREE\_QUAL::Node\ *RTREE\_QUAL::AllocNode()}
\DoxyCodeLine{00836\ \{}
\DoxyCodeLine{00837\ \ \ \ \ Node\ *newNode;}
\DoxyCodeLine{00838\ \textcolor{preprocessor}{\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00839\ \ \ \ \ newNode\ =\ \textcolor{keyword}{new}\ Node;}
\DoxyCodeLine{00840\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00841\ \ \ \ \ \textcolor{comment}{//\ EXAMPLE}}
\DoxyCodeLine{00842\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00843\ \ \ \ \ InitNode(newNode);}
\DoxyCodeLine{00844\ \ \ \ \ \textcolor{keywordflow}{return}\ newNode;}
\DoxyCodeLine{00845\ \}}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ RTREE\_TEMPLATE}
\DoxyCodeLine{00848\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::FreeNode(Node\ *a\_node)}
\DoxyCodeLine{00849\ \{}
\DoxyCodeLine{00850\ \ \ \ \ ASSERT(a\_node);}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00852\ \textcolor{preprocessor}{\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00853\ \ \ \ \ \textcolor{keyword}{delete}\ a\_node;}
\DoxyCodeLine{00854\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00855\ \ \ \ \ \textcolor{comment}{//\ EXAMPLE}}
\DoxyCodeLine{00856\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00857\ \}}
\DoxyCodeLine{00858\ }
\DoxyCodeLine{00859\ \textcolor{comment}{//\ Allocate\ space\ for\ a\ node\ in\ the\ list\ used\ in\ DeletRect\ to}}
\DoxyCodeLine{00860\ \textcolor{comment}{//\ store\ Nodes\ that\ are\ too\ empty.}}
\DoxyCodeLine{00861\ RTREE\_TEMPLATE}
\DoxyCodeLine{00862\ \textcolor{keyword}{typename}\ RTREE\_QUAL::ListNode\ *RTREE\_QUAL::AllocListNode()}
\DoxyCodeLine{00863\ \{}
\DoxyCodeLine{00864\ \textcolor{preprocessor}{\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00865\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ ListNode;}
\DoxyCodeLine{00866\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00867\ \ \ \ \ \textcolor{comment}{//\ EXAMPLE}}
\DoxyCodeLine{00868\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00869\ \}}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ RTREE\_TEMPLATE}
\DoxyCodeLine{00872\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::FreeListNode(ListNode\ *a\_listNode)}
\DoxyCodeLine{00873\ \{}
\DoxyCodeLine{00874\ \textcolor{preprocessor}{\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{keyword}{delete}\ a\_listNode;}
\DoxyCodeLine{00876\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00877\ \ \ \ \ \textcolor{comment}{//\ EXAMPLE}}
\DoxyCodeLine{00878\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{00879\ \}}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ RTREE\_TEMPLATE}
\DoxyCodeLine{00882\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::InitNode(Node\ *a\_node)}
\DoxyCodeLine{00883\ \{}
\DoxyCodeLine{00884\ \ \ \ \ a\_node-\/>m\_count\ =\ 0;}
\DoxyCodeLine{00885\ \ \ \ \ a\_node-\/>m\_level\ =\ -\/1;}
\DoxyCodeLine{00886\ \}}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ RTREE\_TEMPLATE}
\DoxyCodeLine{00889\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::InitRect(Rect\ *a\_rect)}
\DoxyCodeLine{00890\ \{}
\DoxyCodeLine{00891\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{00892\ \ \ \ \ \{}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ a\_rect-\/>m\_min[index]\ =\ (ELEMTYPE)0;}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ a\_rect-\/>m\_max[index]\ =\ (ELEMTYPE)0;}
\DoxyCodeLine{00895\ \ \ \ \ \}}
\DoxyCodeLine{00896\ \}}
\DoxyCodeLine{00897\ }
\DoxyCodeLine{00898\ \textcolor{comment}{//\ Inserts\ a\ new\ data\ rectangle\ into\ the\ index\ structure.}}
\DoxyCodeLine{00899\ \textcolor{comment}{//\ Recursively\ descends\ tree,\ propagates\ splits\ back\ up.}}
\DoxyCodeLine{00900\ \textcolor{comment}{//\ Returns\ 0\ if\ node\ was\ not\ split.\ \ Old\ node\ updated.}}
\DoxyCodeLine{00901\ \textcolor{comment}{//\ If\ node\ was\ split,\ returns\ 1\ and\ sets\ the\ pointer\ pointed\ to\ by}}
\DoxyCodeLine{00902\ \textcolor{comment}{//\ new\_node\ to\ point\ to\ the\ new\ node.\ \ Old\ node\ updated\ to\ become\ one\ of\ two.}}
\DoxyCodeLine{00903\ \textcolor{comment}{//\ The\ level\ argument\ specifies\ the\ number\ of\ steps\ up\ from\ the\ leaf}}
\DoxyCodeLine{00904\ \textcolor{comment}{//\ level\ to\ insert;\ e.g.\ a\ data\ rectangle\ goes\ in\ at\ level\ =\ 0.}}
\DoxyCodeLine{00905\ RTREE\_TEMPLATE}
\DoxyCodeLine{00906\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::InsertRectRec(\textcolor{keyword}{const}\ Branch\ \&a\_branch,\ Node\ *a\_node,\ Node\ **a\_newNode,\ \textcolor{keywordtype}{int}\ a\_level)}
\DoxyCodeLine{00907\ \{}
\DoxyCodeLine{00908\ \ \ \ \ ASSERT(a\_node\ \&\&\ a\_newNode);}
\DoxyCodeLine{00909\ \ \ \ \ ASSERT(a\_level\ >=\ 0\ \&\&\ a\_level\ <=\ a\_node-\/>m\_level);}
\DoxyCodeLine{00910\ }
\DoxyCodeLine{00911\ \ \ \ \ \textcolor{comment}{//\ recurse\ until\ we\ reach\ the\ correct\ level\ for\ the\ new\ record.\ data\ records}}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{comment}{//\ will\ always\ be\ called\ with\ a\_level\ ==\ 0\ (leaf)}}
\DoxyCodeLine{00913\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>m\_level\ >\ a\_level)}
\DoxyCodeLine{00914\ \ \ \ \ \{}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Still\ above\ level\ for\ insertion,\ go\ down\ tree\ recursively}}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ Node\ *otherNode;}
\DoxyCodeLine{00917\ }
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ find\ the\ optimal\ branch\ for\ this\ record}}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ PickBranch(\&a\_branch.m\_rect,\ a\_node);}
\DoxyCodeLine{00920\ }
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ recursively\ insert\ this\ record\ into\ the\ picked\ branch}}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ childWasSplit\ =\ InsertRectRec(a\_branch,\ a\_node-\/>m\_branch[index].m\_child,\ \&otherNode,\ a\_level);}
\DoxyCodeLine{00923\ }
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!childWasSplit)}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Child\ was\ not\ split.\ Merge\ the\ bounding\ box\ of\ the\ new\ record\ with\ the}}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ existing\ bounding\ box}}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ a\_node-\/>m\_branch[index].m\_rect\ =\ CombineRect(\&a\_branch.m\_rect,\ \&(a\_node-\/>m\_branch[index].m\_rect));}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Child\ was\ split.\ The\ old\ branches\ are\ now\ re-\/partitioned\ to\ two\ nodes}}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ so\ we\ have\ to\ re-\/calculate\ the\ bounding\ boxes\ of\ each\ node}}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ \ \ a\_node-\/>m\_branch[index].m\_rect\ =\ NodeCover(a\_node-\/>m\_branch[index].m\_child);}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ Branch\ branch;}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \ \ \ \ branch.m\_child\ =\ otherNode;}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ branch.m\_rect\ =\ NodeCover(otherNode);}
\DoxyCodeLine{00939\ }
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ old\ node\ is\ already\ a\ child\ of\ a\_node.\ Now\ add\ the\ newly-\/created}}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ node\ to\ a\_node\ as\ well.\ a\_node\ might\ be\ split\ because\ of\ that.}}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ AddBranch(\&branch,\ a\_node,\ a\_newNode);}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00944\ \ \ \ \ \}}
\DoxyCodeLine{00945\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (a\_node-\/>m\_level\ ==\ a\_level)}
\DoxyCodeLine{00946\ \ \ \ \ \{}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ reached\ level\ for\ insertion.\ Add\ rect,\ split\ if\ necessary}}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ AddBranch(\&a\_branch,\ a\_node,\ a\_newNode);}
\DoxyCodeLine{00949\ \ \ \ \ \}}
\DoxyCodeLine{00950\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00951\ \ \ \ \ \{}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Should\ never\ occur}}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ ASSERT(0);}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00955\ \ \ \ \ \}}
\DoxyCodeLine{00956\ \}}
\DoxyCodeLine{00957\ }
\DoxyCodeLine{00958\ \textcolor{comment}{//\ Insert\ a\ data\ rectangle\ into\ an\ index\ structure.}}
\DoxyCodeLine{00959\ \textcolor{comment}{//\ InsertRect\ provides\ for\ splitting\ the\ root;}}
\DoxyCodeLine{00960\ \textcolor{comment}{//\ returns\ 1\ if\ root\ was\ split,\ 0\ if\ it\ was\ not.}}
\DoxyCodeLine{00961\ \textcolor{comment}{//\ The\ level\ argument\ specifies\ the\ number\ of\ steps\ up\ from\ the\ leaf}}
\DoxyCodeLine{00962\ \textcolor{comment}{//\ level\ to\ insert;\ e.g.\ a\ data\ rectangle\ goes\ in\ at\ level\ =\ 0.}}
\DoxyCodeLine{00963\ \textcolor{comment}{//\ InsertRect2\ does\ the\ recursion.}}
\DoxyCodeLine{00964\ \textcolor{comment}{//}}
\DoxyCodeLine{00965\ RTREE\_TEMPLATE}
\DoxyCodeLine{00966\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::InsertRect(\textcolor{keyword}{const}\ Branch\ \&a\_branch,\ Node\ **a\_root,\ \textcolor{keywordtype}{int}\ a\_level)}
\DoxyCodeLine{00967\ \{}
\DoxyCodeLine{00968\ \ \ \ \ ASSERT(a\_root);}
\DoxyCodeLine{00969\ \ \ \ \ ASSERT(a\_level\ >=\ 0\ \&\&\ a\_level\ <=\ (*a\_root)-\/>m\_level);}
\DoxyCodeLine{00970\ \textcolor{preprocessor}{\#ifdef\ \_DEBUG}}
\DoxyCodeLine{00971\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{00972\ \ \ \ \ \{}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ ASSERT(a\_branch.m\_rect.m\_min[index]\ <=\ a\_branch.m\_rect.m\_max[index]);}
\DoxyCodeLine{00974\ \ \ \ \ \}}
\DoxyCodeLine{00975\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\_DEBUG}}
\DoxyCodeLine{00976\ }
\DoxyCodeLine{00977\ \ \ \ \ Node\ *newNode;}
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00979\ \ \ \ \ \textcolor{keywordflow}{if}\ (InsertRectRec(a\_branch,\ *a\_root,\ \&newNode,\ a\_level))\ \textcolor{comment}{//\ Root\ split}}
\DoxyCodeLine{00980\ \ \ \ \ \{}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Grow\ tree\ taller\ and\ new\ root}}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ Node\ *newRoot\ =\ AllocNode();}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ newRoot-\/>m\_level\ =\ (*a\_root)-\/>m\_level\ +\ 1;}
\DoxyCodeLine{00984\ }
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ Branch\ branch;}
\DoxyCodeLine{00986\ }
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ old\ root\ node\ as\ a\ child\ of\ the\ new\ root}}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ branch.m\_rect\ =\ NodeCover(*a\_root);}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ branch.m\_child\ =\ *a\_root;}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ AddBranch(\&branch,\ newRoot,\ NULL);}
\DoxyCodeLine{00991\ }
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ the\ split\ node\ as\ a\ child\ of\ the\ new\ root}}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ branch.m\_rect\ =\ NodeCover(newNode);}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ branch.m\_child\ =\ newNode;}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \ \ AddBranch(\&branch,\ newRoot,\ NULL);}
\DoxyCodeLine{00996\ }
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ the\ new\ root\ as\ the\ root\ node}}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ *a\_root\ =\ newRoot;}
\DoxyCodeLine{00999\ }
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01001\ \ \ \ \ \}}
\DoxyCodeLine{01002\ }
\DoxyCodeLine{01003\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01004\ \}}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ \textcolor{comment}{//\ Find\ the\ smallest\ rectangle\ that\ includes\ all\ rectangles\ in\ branches\ of\ a\ node.}}
\DoxyCodeLine{01007\ RTREE\_TEMPLATE}
\DoxyCodeLine{01008\ \textcolor{keyword}{typename}\ RTREE\_QUAL::Rect\ RTREE\_QUAL::NodeCover(Node\ *a\_node)}
\DoxyCodeLine{01009\ \{}
\DoxyCodeLine{01010\ \ \ \ \ ASSERT(a\_node);}
\DoxyCodeLine{01011\ }
\DoxyCodeLine{01012\ \ \ \ \ Rect\ rect\ =\ a\_node-\/>m\_branch[0].m\_rect;}
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 1;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01014\ \ \ \ \ \{}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ rect\ =\ CombineRect(\&rect,\ \&(a\_node-\/>m\_branch[index].m\_rect));}
\DoxyCodeLine{01016\ \ \ \ \ \}}
\DoxyCodeLine{01017\ }
\DoxyCodeLine{01018\ \ \ \ \ \textcolor{keywordflow}{return}\ rect;}
\DoxyCodeLine{01019\ \}}
\DoxyCodeLine{01020\ }
\DoxyCodeLine{01021\ \textcolor{comment}{//\ Add\ a\ branch\ to\ a\ node.\ \ Split\ the\ node\ if\ necessary.}}
\DoxyCodeLine{01022\ \textcolor{comment}{//\ Returns\ 0\ if\ node\ not\ split.\ \ Old\ node\ updated.}}
\DoxyCodeLine{01023\ \textcolor{comment}{//\ Returns\ 1\ if\ node\ split,\ sets\ *new\_node\ to\ address\ of\ new\ node.}}
\DoxyCodeLine{01024\ \textcolor{comment}{//\ Old\ node\ updated,\ becomes\ one\ of\ two.}}
\DoxyCodeLine{01025\ RTREE\_TEMPLATE}
\DoxyCodeLine{01026\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::AddBranch(\textcolor{keyword}{const}\ Branch\ *a\_branch,\ Node\ *a\_node,\ Node\ **a\_newNode)}
\DoxyCodeLine{01027\ \{}
\DoxyCodeLine{01028\ \ \ \ \ ASSERT(a\_branch);}
\DoxyCodeLine{01029\ \ \ \ \ ASSERT(a\_node);}
\DoxyCodeLine{01030\ }
\DoxyCodeLine{01031\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>m\_count\ <\ MAXNODES)\ \textcolor{comment}{//\ Split\ won't\ be\ necessary}}
\DoxyCodeLine{01032\ \ \ \ \ \{}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ a\_node-\/>m\_branch[a\_node-\/>m\_count]\ =\ *a\_branch;}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ ++a\_node-\/>m\_count;}
\DoxyCodeLine{01035\ }
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01037\ \ \ \ \ \}}
\DoxyCodeLine{01038\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01039\ \ \ \ \ \{}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ ASSERT(a\_newNode);}
\DoxyCodeLine{01041\ }
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ SplitNode(a\_node,\ a\_branch,\ a\_newNode);}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01044\ \ \ \ \ \}}
\DoxyCodeLine{01045\ \}}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \textcolor{comment}{//\ Disconnect\ a\ dependent\ node.}}
\DoxyCodeLine{01048\ \textcolor{comment}{//\ Caller\ must\ return\ (or\ stop\ using\ iteration\ index)\ after\ this\ as\ count\ has\ changed}}
\DoxyCodeLine{01049\ RTREE\_TEMPLATE}
\DoxyCodeLine{01050\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::DisconnectBranch(Node\ *a\_node,\ \textcolor{keywordtype}{int}\ a\_index)}
\DoxyCodeLine{01051\ \{}
\DoxyCodeLine{01052\ \ \ \ \ ASSERT(a\_node\ \&\&\ (a\_index\ >=\ 0)\ \&\&\ (a\_index\ <\ MAXNODES));}
\DoxyCodeLine{01053\ \ \ \ \ ASSERT(a\_node-\/>m\_count\ >\ 0);}
\DoxyCodeLine{01054\ }
\DoxyCodeLine{01055\ \ \ \ \ \textcolor{comment}{//\ Remove\ element\ by\ swapping\ with\ the\ last\ element\ to\ prevent\ gaps\ in\ array}}
\DoxyCodeLine{01056\ \ \ \ \ a\_node-\/>m\_branch[a\_index]\ =\ a\_node-\/>m\_branch[a\_node-\/>m\_count\ -\/\ 1];}
\DoxyCodeLine{01057\ }
\DoxyCodeLine{01058\ \ \ \ \ -\/-\/a\_node-\/>m\_count;}
\DoxyCodeLine{01059\ \}}
\DoxyCodeLine{01060\ }
\DoxyCodeLine{01061\ \textcolor{comment}{//\ Pick\ a\ branch.\ \ Pick\ the\ one\ that\ will\ need\ the\ smallest\ increase}}
\DoxyCodeLine{01062\ \textcolor{comment}{//\ in\ area\ to\ accomodate\ the\ new\ rectangle.\ \ This\ will\ result\ in\ the}}
\DoxyCodeLine{01063\ \textcolor{comment}{//\ least\ total\ area\ for\ the\ covering\ rectangles\ in\ the\ current\ node.}}
\DoxyCodeLine{01064\ \textcolor{comment}{//\ In\ case\ of\ a\ tie,\ pick\ the\ one\ which\ was\ smaller\ before,\ to\ get}}
\DoxyCodeLine{01065\ \textcolor{comment}{//\ the\ best\ resolution\ when\ searching.}}
\DoxyCodeLine{01066\ RTREE\_TEMPLATE}
\DoxyCodeLine{01067\ \textcolor{keywordtype}{int}\ RTREE\_QUAL::PickBranch(\textcolor{keyword}{const}\ Rect\ *a\_rect,\ Node\ *a\_node)}
\DoxyCodeLine{01068\ \{}
\DoxyCodeLine{01069\ \ \ \ \ ASSERT(a\_rect\ \&\&\ a\_node);}
\DoxyCodeLine{01070\ }
\DoxyCodeLine{01071\ \ \ \ \ \textcolor{keywordtype}{bool}\ firstTime\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01072\ \ \ \ \ ELEMTYPEREAL\ increase;}
\DoxyCodeLine{01073\ \ \ \ \ ELEMTYPEREAL\ bestIncr\ =\ (ELEMTYPEREAL)-\/1;}
\DoxyCodeLine{01074\ \ \ \ \ ELEMTYPEREAL\ area;}
\DoxyCodeLine{01075\ \ \ \ \ ELEMTYPEREAL\ bestArea;}
\DoxyCodeLine{01076\ \ \ \ \ \textcolor{keywordtype}{int}\ best\ =\ 0;}
\DoxyCodeLine{01077\ \ \ \ \ Rect\ tempRect;}
\DoxyCodeLine{01078\ }
\DoxyCodeLine{01079\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01080\ \ \ \ \ \{}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ Rect\ *curRect\ =\ \&a\_node-\/>m\_branch[index].m\_rect;}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ area\ =\ CalcRectVolume(curRect);}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ tempRect\ =\ CombineRect(a\_rect,\ curRect);}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ increase\ =\ CalcRectVolume(\&tempRect)\ -\/\ area;}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((increase\ <\ bestIncr)\ ||\ firstTime)}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ \ \ \ \ best\ =\ index;}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \ \ \ \ bestArea\ =\ area;}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ \ \ \ \ bestIncr\ =\ increase;}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ \ \ firstTime\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((increase\ ==\ bestIncr)\ \&\&\ (area\ <\ bestArea))}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ \ \ \ \ best\ =\ index;}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ \ \ \ \ bestArea\ =\ area;}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \ \ \ \ bestIncr\ =\ increase;}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01098\ \ \ \ \ \}}
\DoxyCodeLine{01099\ \ \ \ \ \textcolor{keywordflow}{return}\ best;}
\DoxyCodeLine{01100\ \}}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \textcolor{comment}{//\ Combine\ two\ rectangles\ into\ larger\ one\ containing\ both}}
\DoxyCodeLine{01103\ RTREE\_TEMPLATE}
\DoxyCodeLine{01104\ \textcolor{keyword}{typename}\ RTREE\_QUAL::Rect\ RTREE\_QUAL::CombineRect(\textcolor{keyword}{const}\ Rect\ *a\_rectA,\ \textcolor{keyword}{const}\ Rect\ *a\_rectB)}
\DoxyCodeLine{01105\ \{}
\DoxyCodeLine{01106\ \ \ \ \ ASSERT(a\_rectA\ \&\&\ a\_rectB);}
\DoxyCodeLine{01107\ }
\DoxyCodeLine{01108\ \ \ \ \ Rect\ newRect;}
\DoxyCodeLine{01109\ }
\DoxyCodeLine{01110\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{01111\ \ \ \ \ \{}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ newRect.m\_min[index]\ =\ std::min(a\_rectA-\/>m\_min[index],\ a\_rectB-\/>m\_min[index]);}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ newRect.m\_max[index]\ =\ std::max(a\_rectA-\/>m\_max[index],\ a\_rectB-\/>m\_max[index]);}
\DoxyCodeLine{01114\ \ \ \ \ \}}
\DoxyCodeLine{01115\ }
\DoxyCodeLine{01116\ \ \ \ \ \textcolor{keywordflow}{return}\ newRect;}
\DoxyCodeLine{01117\ \}}
\DoxyCodeLine{01118\ }
\DoxyCodeLine{01119\ \textcolor{comment}{//\ Split\ a\ node.}}
\DoxyCodeLine{01120\ \textcolor{comment}{//\ Divides\ the\ nodes\ branches\ and\ the\ extra\ one\ between\ two\ nodes.}}
\DoxyCodeLine{01121\ \textcolor{comment}{//\ Old\ node\ is\ one\ of\ the\ new\ ones,\ and\ one\ really\ new\ one\ is\ created.}}
\DoxyCodeLine{01122\ \textcolor{comment}{//\ Tries\ more\ than\ one\ method\ for\ choosing\ a\ partition,\ uses\ best\ result.}}
\DoxyCodeLine{01123\ RTREE\_TEMPLATE}
\DoxyCodeLine{01124\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::SplitNode(Node\ *a\_node,\ \textcolor{keyword}{const}\ Branch\ *a\_branch,\ Node\ **a\_newNode)}
\DoxyCodeLine{01125\ \{}
\DoxyCodeLine{01126\ \ \ \ \ ASSERT(a\_node);}
\DoxyCodeLine{01127\ \ \ \ \ ASSERT(a\_branch);}
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01129\ \ \ \ \ \textcolor{comment}{//\ Could\ just\ use\ local\ here,\ but\ member\ or\ external\ is\ faster\ since\ it\ is\ reused}}
\DoxyCodeLine{01130\ \ \ \ \ PartitionVars\ localVars;}
\DoxyCodeLine{01131\ \ \ \ \ PartitionVars\ *parVars\ =\ \&localVars;}
\DoxyCodeLine{01132\ }
\DoxyCodeLine{01133\ \ \ \ \ \textcolor{comment}{//\ Load\ all\ the\ branches\ into\ a\ buffer,\ initialize\ old\ node}}
\DoxyCodeLine{01134\ \ \ \ \ GetBranches(a\_node,\ a\_branch,\ parVars);}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \ \ \textcolor{comment}{//\ Find\ partition}}
\DoxyCodeLine{01137\ \ \ \ \ ChoosePartition(parVars,\ MINNODES);}
\DoxyCodeLine{01138\ }
\DoxyCodeLine{01139\ \ \ \ \ \textcolor{comment}{//\ Create\ a\ new\ node\ to\ hold\ (about)\ half\ of\ the\ branches}}
\DoxyCodeLine{01140\ \ \ \ \ *a\_newNode\ =\ AllocNode();}
\DoxyCodeLine{01141\ \ \ \ \ (*a\_newNode)-\/>m\_level\ =\ a\_node-\/>m\_level;}
\DoxyCodeLine{01142\ }
\DoxyCodeLine{01143\ \ \ \ \ \textcolor{comment}{//\ Put\ branches\ from\ buffer\ into\ 2\ nodes\ according\ to\ the\ chosen\ partition}}
\DoxyCodeLine{01144\ \ \ \ \ a\_node-\/>m\_count\ =\ 0;}
\DoxyCodeLine{01145\ \ \ \ \ LoadNodes(a\_node,\ *a\_newNode,\ parVars);}
\DoxyCodeLine{01146\ }
\DoxyCodeLine{01147\ \ \ \ \ ASSERT((a\_node-\/>m\_count\ +\ (*a\_newNode)-\/>m\_count)\ ==\ parVars-\/>m\_total);}
\DoxyCodeLine{01148\ \}}
\DoxyCodeLine{01149\ }
\DoxyCodeLine{01150\ \textcolor{comment}{//\ Calculate\ the\ n-\/dimensional\ volume\ of\ a\ rectangle}}
\DoxyCodeLine{01151\ RTREE\_TEMPLATE}
\DoxyCodeLine{01152\ ELEMTYPEREAL\ RTREE\_QUAL::RectVolume(Rect\ *a\_rect)}
\DoxyCodeLine{01153\ \{}
\DoxyCodeLine{01154\ \ \ \ \ ASSERT(a\_rect);}
\DoxyCodeLine{01155\ }
\DoxyCodeLine{01156\ \ \ \ \ ELEMTYPEREAL\ volume\ =\ (ELEMTYPEREAL)1;}
\DoxyCodeLine{01157\ }
\DoxyCodeLine{01158\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{01159\ \ \ \ \ \{}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ volume\ *=\ a\_rect-\/>m\_max[index]\ -\/\ a\_rect-\/>m\_min[index];}
\DoxyCodeLine{01161\ \ \ \ \ \}}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \ \ ASSERT(volume\ >=\ (ELEMTYPEREAL)0);}
\DoxyCodeLine{01164\ }
\DoxyCodeLine{01165\ \ \ \ \ \textcolor{keywordflow}{return}\ volume;}
\DoxyCodeLine{01166\ \}}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ \textcolor{comment}{//\ The\ exact\ volume\ of\ the\ bounding\ sphere\ for\ the\ given\ Rect}}
\DoxyCodeLine{01169\ RTREE\_TEMPLATE}
\DoxyCodeLine{01170\ ELEMTYPEREAL\ RTREE\_QUAL::RectSphericalVolume(Rect\ *a\_rect)}
\DoxyCodeLine{01171\ \{}
\DoxyCodeLine{01172\ \ \ \ \ ASSERT(a\_rect);}
\DoxyCodeLine{01173\ }
\DoxyCodeLine{01174\ \ \ \ \ ELEMTYPEREAL\ sumOfSquares\ =\ (ELEMTYPEREAL)0;}
\DoxyCodeLine{01175\ \ \ \ \ ELEMTYPEREAL\ radius;}
\DoxyCodeLine{01176\ }
\DoxyCodeLine{01177\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{01178\ \ \ \ \ \{}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ halfExtent\ =\ ((ELEMTYPEREAL)a\_rect-\/>m\_max[index]\ -\/\ (ELEMTYPEREAL)a\_rect-\/>m\_min[index])\ *\ (ELEMTYPEREAL)0.5;}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ sumOfSquares\ +=\ halfExtent\ *\ halfExtent;}
\DoxyCodeLine{01181\ \ \ \ \ \}}
\DoxyCodeLine{01182\ }
\DoxyCodeLine{01183\ \ \ \ \ radius\ =\ (ELEMTYPEREAL)sqrt(sumOfSquares);}
\DoxyCodeLine{01184\ }
\DoxyCodeLine{01185\ \ \ \ \ \textcolor{comment}{//\ Pow\ maybe\ slow,\ so\ test\ for\ common\ dims\ like\ 2,3\ and\ just\ use\ x*x,\ x*x*x.}}
\DoxyCodeLine{01186\ \ \ \ \ \textcolor{keywordflow}{if}\ (NUMDIMS\ ==\ 3)}
\DoxyCodeLine{01187\ \ \ \ \ \{}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (radius\ *\ radius\ *\ radius\ *\ m\_unitSphereVolume);}
\DoxyCodeLine{01189\ \ \ \ \ \}}
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (NUMDIMS\ ==\ 2)}
\DoxyCodeLine{01191\ \ \ \ \ \{}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (radius\ *\ radius\ *\ m\_unitSphereVolume);}
\DoxyCodeLine{01193\ \ \ \ \ \}}
\DoxyCodeLine{01194\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01195\ \ \ \ \ \{}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (ELEMTYPEREAL)(pow(radius,\ NUMDIMS)\ *\ m\_unitSphereVolume);}
\DoxyCodeLine{01197\ \ \ \ \ \}}
\DoxyCodeLine{01198\ \}}
\DoxyCodeLine{01199\ }
\DoxyCodeLine{01200\ \textcolor{comment}{//\ Use\ one\ of\ the\ methods\ to\ calculate\ retangle\ volume}}
\DoxyCodeLine{01201\ RTREE\_TEMPLATE}
\DoxyCodeLine{01202\ ELEMTYPEREAL\ RTREE\_QUAL::CalcRectVolume(Rect\ *a\_rect)}
\DoxyCodeLine{01203\ \{}
\DoxyCodeLine{01204\ \textcolor{preprocessor}{\#ifdef\ RTREE\_USE\_SPHERICAL\_VOLUME}}
\DoxyCodeLine{01205\ \ \ \ \ \textcolor{keywordflow}{return}\ RectSphericalVolume(a\_rect);\ \textcolor{comment}{//\ Slower\ but\ helps\ certain\ merge\ cases}}
\DoxyCodeLine{01206\ \textcolor{preprocessor}{\#else\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ RTREE\_USE\_SPHERICAL\_VOLUME}}
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{keywordflow}{return}\ RectVolume(a\_rect);\ \textcolor{comment}{//\ Faster\ but\ can\ cause\ poor\ merges}}
\DoxyCodeLine{01208\ \textcolor{preprocessor}{\#endif\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ RTREE\_USE\_SPHERICAL\_VOLUME}}
\DoxyCodeLine{01209\ \}}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \textcolor{comment}{//\ Load\ branch\ buffer\ with\ branches\ from\ full\ node\ plus\ the\ extra\ branch.}}
\DoxyCodeLine{01212\ RTREE\_TEMPLATE}
\DoxyCodeLine{01213\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::GetBranches(Node\ *a\_node,\ \textcolor{keyword}{const}\ Branch\ *a\_branch,\ PartitionVars\ *a\_parVars)}
\DoxyCodeLine{01214\ \{}
\DoxyCodeLine{01215\ \ \ \ \ ASSERT(a\_node);}
\DoxyCodeLine{01216\ \ \ \ \ ASSERT(a\_branch);}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ \ \ \ \ ASSERT(a\_node-\/>m\_count\ ==\ MAXNODES);}
\DoxyCodeLine{01219\ }
\DoxyCodeLine{01220\ \ \ \ \ \textcolor{comment}{//\ Load\ the\ branch\ buffer}}
\DoxyCodeLine{01221\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ MAXNODES;\ ++index)}
\DoxyCodeLine{01222\ \ \ \ \ \{}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ a\_parVars-\/>m\_branchBuf[index]\ =\ a\_node-\/>m\_branch[index];}
\DoxyCodeLine{01224\ \ \ \ \ \}}
\DoxyCodeLine{01225\ \ \ \ \ a\_parVars-\/>m\_branchBuf[MAXNODES]\ =\ *a\_branch;}
\DoxyCodeLine{01226\ \ \ \ \ a\_parVars-\/>m\_branchCount\ =\ MAXNODES\ +\ 1;}
\DoxyCodeLine{01227\ }
\DoxyCodeLine{01228\ \ \ \ \ \textcolor{comment}{//\ Calculate\ rect\ containing\ all\ in\ the\ set}}
\DoxyCodeLine{01229\ \ \ \ \ a\_parVars-\/>m\_coverSplit\ =\ a\_parVars-\/>m\_branchBuf[0].m\_rect;}
\DoxyCodeLine{01230\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 1;\ index\ <\ MAXNODES\ +\ 1;\ ++index)}
\DoxyCodeLine{01231\ \ \ \ \ \{}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ a\_parVars-\/>m\_coverSplit\ =\ CombineRect(\&a\_parVars-\/>m\_coverSplit,\ \&a\_parVars-\/>m\_branchBuf[index].m\_rect);}
\DoxyCodeLine{01233\ \ \ \ \ \}}
\DoxyCodeLine{01234\ \ \ \ \ a\_parVars-\/>m\_coverSplitArea\ =\ CalcRectVolume(\&a\_parVars-\/>m\_coverSplit);}
\DoxyCodeLine{01235\ \}}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \textcolor{comment}{//\ Method\ \#0\ for\ choosing\ a\ partition:}}
\DoxyCodeLine{01238\ \textcolor{comment}{//\ As\ the\ seeds\ for\ the\ two\ groups,\ pick\ the\ two\ rects\ that\ would\ waste\ the}}
\DoxyCodeLine{01239\ \textcolor{comment}{//\ most\ area\ if\ covered\ by\ a\ single\ rectangle,\ i.e.\ evidently\ the\ worst\ pair}}
\DoxyCodeLine{01240\ \textcolor{comment}{//\ to\ have\ in\ the\ same\ group.}}
\DoxyCodeLine{01241\ \textcolor{comment}{//\ Of\ the\ remaining,\ one\ at\ a\ time\ is\ chosen\ to\ be\ put\ in\ one\ of\ the\ two\ groups.}}
\DoxyCodeLine{01242\ \textcolor{comment}{//\ The\ one\ chosen\ is\ the\ one\ with\ the\ greatest\ difference\ in\ area\ expansion}}
\DoxyCodeLine{01243\ \textcolor{comment}{//\ depending\ on\ which\ group\ -\/\ the\ rect\ most\ strongly\ attracted\ to\ one\ group}}
\DoxyCodeLine{01244\ \textcolor{comment}{//\ and\ repelled\ from\ the\ other.}}
\DoxyCodeLine{01245\ \textcolor{comment}{//\ If\ one\ group\ gets\ too\ full\ (more\ would\ force\ other\ group\ to\ violate\ min}}
\DoxyCodeLine{01246\ \textcolor{comment}{//\ fill\ requirement)\ then\ other\ group\ gets\ the\ rest.}}
\DoxyCodeLine{01247\ \textcolor{comment}{//\ These\ last\ are\ the\ ones\ that\ can\ go\ in\ either\ group\ most\ easily.}}
\DoxyCodeLine{01248\ RTREE\_TEMPLATE}
\DoxyCodeLine{01249\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::ChoosePartition(PartitionVars\ *a\_parVars,\ \textcolor{keywordtype}{int}\ a\_minFill)}
\DoxyCodeLine{01250\ \{}
\DoxyCodeLine{01251\ \ \ \ \ ASSERT(a\_parVars);}
\DoxyCodeLine{01252\ }
\DoxyCodeLine{01253\ \ \ \ \ ELEMTYPEREAL\ biggestDiff;}
\DoxyCodeLine{01254\ \ \ \ \ \textcolor{keywordtype}{int}\ group,\ chosen\ =\ 0,\ betterGroup\ =\ 0;}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ \ \ InitParVars(a\_parVars,\ a\_parVars-\/>m\_branchCount,\ a\_minFill);}
\DoxyCodeLine{01257\ \ \ \ \ PickSeeds(a\_parVars);}
\DoxyCodeLine{01258\ }
\DoxyCodeLine{01259\ \ \ \ \ \textcolor{keywordflow}{while}\ (((a\_parVars-\/>m\_count[0]\ +\ a\_parVars-\/>m\_count[1])\ <\ a\_parVars-\/>m\_total)\ \&\&\ (a\_parVars-\/>m\_count[0]\ <\ (a\_parVars-\/>m\_total\ -\/\ a\_parVars-\/>m\_minFill))\ \&\&\ (a\_parVars-\/>m\_count[1]\ <\ (a\_parVars-\/>m\_total\ -\/\ a\_parVars-\/>m\_minFill)))}
\DoxyCodeLine{01260\ \ \ \ \ \{}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ biggestDiff\ =\ (ELEMTYPEREAL)-\/1;}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PartitionVars::NOT\_TAKEN\ ==\ a\_parVars-\/>m\_partition[index])}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Rect\ *curRect\ =\ \&a\_parVars-\/>m\_branchBuf[index].m\_rect;}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Rect\ rect0\ =\ CombineRect(curRect,\ \&a\_parVars-\/>m\_cover[0]);}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Rect\ rect1\ =\ CombineRect(curRect,\ \&a\_parVars-\/>m\_cover[1]);}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ growth0\ =\ CalcRectVolume(\&rect0)\ -\/\ a\_parVars-\/>m\_area[0];}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ growth1\ =\ CalcRectVolume(\&rect1)\ -\/\ a\_parVars-\/>m\_area[1];}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ diff\ =\ growth1\ -\/\ growth0;}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (diff\ >=\ 0)}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ group\ =\ 0;}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ group\ =\ 1;}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diff\ =\ -\/diff;}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01281\ }
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (diff\ >\ biggestDiff)}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ biggestDiff\ =\ diff;}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chosen\ =\ index;}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ betterGroup\ =\ group;}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((diff\ ==\ biggestDiff)\ \&\&\ (a\_parVars-\/>m\_count[group]\ <\ a\_parVars-\/>m\_count[betterGroup]))}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chosen\ =\ index;}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ betterGroup\ =\ group;}
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ Classify(chosen,\ betterGroup,\ a\_parVars);}
\DoxyCodeLine{01296\ \ \ \ \ \}}
\DoxyCodeLine{01297\ }
\DoxyCodeLine{01298\ \ \ \ \ \textcolor{comment}{//\ If\ one\ group\ too\ full,\ put\ remaining\ rects\ in\ the\ other}}
\DoxyCodeLine{01299\ \ \ \ \ \textcolor{keywordflow}{if}\ ((a\_parVars-\/>m\_count[0]\ +\ a\_parVars-\/>m\_count[1])\ <\ a\_parVars-\/>m\_total)}
\DoxyCodeLine{01300\ \ \ \ \ \{}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_parVars-\/>m\_count[0]\ >=\ a\_parVars-\/>m\_total\ -\/\ a\_parVars-\/>m\_minFill)}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \ \ \ \ group\ =\ 1;}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \ \ \ \ group\ =\ 0;}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PartitionVars::NOT\_TAKEN\ ==\ a\_parVars-\/>m\_partition[index])}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Classify(index,\ group,\ a\_parVars);}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01316\ \ \ \ \ \}}
\DoxyCodeLine{01317\ }
\DoxyCodeLine{01318\ \ \ \ \ ASSERT((a\_parVars-\/>m\_count[0]\ +\ a\_parVars-\/>m\_count[1])\ ==\ a\_parVars-\/>m\_total);}
\DoxyCodeLine{01319\ \ \ \ \ ASSERT((a\_parVars-\/>m\_count[0]\ >=\ a\_parVars-\/>m\_minFill)\ \&\&}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \ \ \ (a\_parVars-\/>m\_count[1]\ >=\ a\_parVars-\/>m\_minFill));}
\DoxyCodeLine{01321\ \}}
\DoxyCodeLine{01322\ }
\DoxyCodeLine{01323\ \textcolor{comment}{//\ Copy\ branches\ from\ the\ buffer\ into\ two\ nodes\ according\ to\ the\ partition.}}
\DoxyCodeLine{01324\ RTREE\_TEMPLATE}
\DoxyCodeLine{01325\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::LoadNodes(Node\ *a\_nodeA,\ Node\ *a\_nodeB,\ PartitionVars\ *a\_parVars)}
\DoxyCodeLine{01326\ \{}
\DoxyCodeLine{01327\ \ \ \ \ ASSERT(a\_nodeA);}
\DoxyCodeLine{01328\ \ \ \ \ ASSERT(a\_nodeB);}
\DoxyCodeLine{01329\ \ \ \ \ ASSERT(a\_parVars);}
\DoxyCodeLine{01330\ }
\DoxyCodeLine{01331\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)}
\DoxyCodeLine{01332\ \ \ \ \ \{}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ ASSERT(a\_parVars-\/>m\_partition[index]\ ==\ 0\ ||\ a\_parVars-\/>m\_partition[index]\ ==\ 1);}
\DoxyCodeLine{01334\ }
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ targetNodeIndex\ =\ a\_parVars-\/>m\_partition[index];}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ Node\ *targetNodes[]\ =\ \{a\_nodeA,\ a\_nodeB\};}
\DoxyCodeLine{01337\ }
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ is\ assured\ that\ AddBranch\ here\ will\ not\ cause\ a\ node\ split.}}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ nodeWasSplit\ =\ AddBranch(\&a\_parVars-\/>m\_branchBuf[index],\ targetNodes[targetNodeIndex],\ NULL);}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nodeWasSplit)}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ \ \ \ \ nodeWasSplit\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \ \ ASSERT(!nodeWasSplit);}
\DoxyCodeLine{01343\ \ \ \ \ \}}
\DoxyCodeLine{01344\ \}}
\DoxyCodeLine{01345\ }
\DoxyCodeLine{01346\ \textcolor{comment}{//\ Initialize\ a\ PartitionVars\ structure.}}
\DoxyCodeLine{01347\ RTREE\_TEMPLATE}
\DoxyCodeLine{01348\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::InitParVars(PartitionVars\ *a\_parVars,\ \textcolor{keywordtype}{int}\ a\_maxRects,\ \textcolor{keywordtype}{int}\ a\_minFill)}
\DoxyCodeLine{01349\ \{}
\DoxyCodeLine{01350\ \ \ \ \ ASSERT(a\_parVars);}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01352\ \ \ \ \ a\_parVars-\/>m\_count[0]\ =\ a\_parVars-\/>m\_count[1]\ =\ 0;}
\DoxyCodeLine{01353\ \ \ \ \ a\_parVars-\/>m\_area[0]\ =\ a\_parVars-\/>m\_area[1]\ =\ (ELEMTYPEREAL)0;}
\DoxyCodeLine{01354\ \ \ \ \ a\_parVars-\/>m\_total\ =\ a\_maxRects;}
\DoxyCodeLine{01355\ \ \ \ \ a\_parVars-\/>m\_minFill\ =\ a\_minFill;}
\DoxyCodeLine{01356\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_maxRects;\ ++index)}
\DoxyCodeLine{01357\ \ \ \ \ \{}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ a\_parVars-\/>m\_partition[index]\ =\ PartitionVars::NOT\_TAKEN;}
\DoxyCodeLine{01359\ \ \ \ \ \}}
\DoxyCodeLine{01360\ \}}
\DoxyCodeLine{01361\ }
\DoxyCodeLine{01362\ RTREE\_TEMPLATE}
\DoxyCodeLine{01363\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::PickSeeds(PartitionVars\ *a\_parVars)}
\DoxyCodeLine{01364\ \{}
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keywordtype}{int}\ seed0\ =\ 0,\ seed1\ =\ 0;}
\DoxyCodeLine{01366\ \ \ \ \ ELEMTYPEREAL\ worst,\ waste;}
\DoxyCodeLine{01367\ \ \ \ \ ELEMTYPEREAL\ area[MAXNODES\ +\ 1];}
\DoxyCodeLine{01368\ }
\DoxyCodeLine{01369\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)}
\DoxyCodeLine{01370\ \ \ \ \ \{}
\DoxyCodeLine{01371\ \ \ \ \ \ \ \ \ area[index]\ =\ CalcRectVolume(\&a\_parVars-\/>m\_branchBuf[index].m\_rect);}
\DoxyCodeLine{01372\ \ \ \ \ \}}
\DoxyCodeLine{01373\ }
\DoxyCodeLine{01374\ \ \ \ \ worst\ =\ -\/a\_parVars-\/>m\_coverSplitArea\ -\/\ 1;}
\DoxyCodeLine{01375\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ indexA\ =\ 0;\ indexA\ <\ a\_parVars-\/>m\_total\ -\/\ 1;\ ++indexA)}
\DoxyCodeLine{01376\ \ \ \ \ \{}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ indexB\ =\ indexA\ +\ 1;\ indexB\ <\ a\_parVars-\/>m\_total;\ ++indexB)}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \ \ \ \ Rect\ oneRect\ =\ CombineRect(\&a\_parVars-\/>m\_branchBuf[indexA].m\_rect,\ \&a\_parVars-\/>m\_branchBuf[indexB].m\_rect);}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ \ \ \ \ waste\ =\ CalcRectVolume(\&oneRect)\ -\/\ area[indexA]\ -\/\ area[indexB];}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (waste\ >\ worst)}
\DoxyCodeLine{01382\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ worst\ =\ waste;}
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed0\ =\ indexA;}
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed1\ =\ indexB;}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01388\ \ \ \ \ \}}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ \ \ \ \ Classify(seed0,\ 0,\ a\_parVars);}
\DoxyCodeLine{01391\ \ \ \ \ Classify(seed1,\ 1,\ a\_parVars);}
\DoxyCodeLine{01392\ \}}
\DoxyCodeLine{01393\ }
\DoxyCodeLine{01394\ \textcolor{comment}{//\ Put\ a\ branch\ in\ one\ of\ the\ groups.}}
\DoxyCodeLine{01395\ RTREE\_TEMPLATE}
\DoxyCodeLine{01396\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::Classify(\textcolor{keywordtype}{int}\ a\_index,\ \textcolor{keywordtype}{int}\ a\_group,\ PartitionVars\ *a\_parVars)}
\DoxyCodeLine{01397\ \{}
\DoxyCodeLine{01398\ \ \ \ \ ASSERT(a\_parVars);}
\DoxyCodeLine{01399\ \ \ \ \ ASSERT(PartitionVars::NOT\_TAKEN\ ==\ a\_parVars-\/>m\_partition[a\_index]);}
\DoxyCodeLine{01400\ }
\DoxyCodeLine{01401\ \ \ \ \ a\_parVars-\/>m\_partition[a\_index]\ =\ a\_group;}
\DoxyCodeLine{01402\ }
\DoxyCodeLine{01403\ \ \ \ \ \textcolor{comment}{//\ Calculate\ combined\ rect}}
\DoxyCodeLine{01404\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_parVars-\/>m\_count[a\_group]\ ==\ 0)}
\DoxyCodeLine{01405\ \ \ \ \ \{}
\DoxyCodeLine{01406\ \ \ \ \ \ \ \ \ a\_parVars-\/>m\_cover[a\_group]\ =\ a\_parVars-\/>m\_branchBuf[a\_index].m\_rect;}
\DoxyCodeLine{01407\ \ \ \ \ \}}
\DoxyCodeLine{01408\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01409\ \ \ \ \ \{}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ \ a\_parVars-\/>m\_cover[a\_group]\ =\ CombineRect(\&a\_parVars-\/>m\_branchBuf[a\_index].m\_rect,\ \&a\_parVars-\/>m\_cover[a\_group]);}
\DoxyCodeLine{01411\ \ \ \ \ \}}
\DoxyCodeLine{01412\ }
\DoxyCodeLine{01413\ \ \ \ \ \textcolor{comment}{//\ Calculate\ volume\ of\ combined\ rect}}
\DoxyCodeLine{01414\ \ \ \ \ a\_parVars-\/>m\_area[a\_group]\ =\ CalcRectVolume(\&a\_parVars-\/>m\_cover[a\_group]);}
\DoxyCodeLine{01415\ }
\DoxyCodeLine{01416\ \ \ \ \ ++a\_parVars-\/>m\_count[a\_group];}
\DoxyCodeLine{01417\ \}}
\DoxyCodeLine{01418\ }
\DoxyCodeLine{01419\ \textcolor{comment}{//\ Delete\ a\ data\ rectangle\ from\ an\ index\ structure.}}
\DoxyCodeLine{01420\ \textcolor{comment}{//\ Pass\ in\ a\ pointer\ to\ a\ Rect,\ the\ tid\ of\ the\ record,\ ptr\ to\ ptr\ to\ root\ node.}}
\DoxyCodeLine{01421\ \textcolor{comment}{//\ Returns\ 1\ if\ record\ not\ found,\ 0\ if\ success.}}
\DoxyCodeLine{01422\ \textcolor{comment}{//\ RemoveRect\ provides\ for\ eliminating\ the\ root.}}
\DoxyCodeLine{01423\ RTREE\_TEMPLATE}
\DoxyCodeLine{01424\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::RemoveRect(Rect\ *a\_rect,\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_id,\ Node\ **a\_root)}
\DoxyCodeLine{01425\ \{}
\DoxyCodeLine{01426\ \ \ \ \ ASSERT(a\_rect\ \&\&\ a\_root);}
\DoxyCodeLine{01427\ \ \ \ \ ASSERT(*a\_root);}
\DoxyCodeLine{01428\ }
\DoxyCodeLine{01429\ \ \ \ \ ListNode\ *reInsertList\ =\ NULL;}
\DoxyCodeLine{01430\ }
\DoxyCodeLine{01431\ \ \ \ \ \textcolor{keywordflow}{if}\ (!RemoveRectRec(a\_rect,\ a\_id,\ *a\_root,\ \&reInsertList))}
\DoxyCodeLine{01432\ \ \ \ \ \{}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Found\ and\ deleted\ a\ data\ item}}
\DoxyCodeLine{01434\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reinsert\ any\ branches\ from\ eliminated\ nodes}}
\DoxyCodeLine{01435\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (reInsertList)}
\DoxyCodeLine{01436\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \ \ \ \ Node\ *tempNode\ =\ reInsertList-\/>m\_node;}
\DoxyCodeLine{01438\ }
\DoxyCodeLine{01439\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ tempNode-\/>m\_count;\ ++index)}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO\ go\ over\ this\ code.\ should\ I\ use\ (tempNode-\/>m\_level\ -\/\ 1)?}}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ InsertRect(tempNode-\/>m\_branch[index],}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_root,}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tempNode-\/>m\_level);}
\DoxyCodeLine{01445\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01446\ }
\DoxyCodeLine{01447\ \ \ \ \ \ \ \ \ \ \ \ \ ListNode\ *remLNode\ =\ reInsertList;}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ \ \ \ \ reInsertList\ =\ reInsertList-\/>m\_next;}
\DoxyCodeLine{01449\ }
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \ \ \ \ FreeNode(remLNode-\/>m\_node);}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \ \ \ \ FreeListNode(remLNode);}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01453\ }
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ for\ redundant\ root\ (not\ leaf,\ 1\ child)\ and\ eliminate\ TODO\ replace}}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ with\ while?\ In\ case\ there\ is\ a\ whole\ branch\ of\ redundant\ roots...}}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*a\_root)-\/>m\_count\ ==\ 1\ \&\&\ (*a\_root)-\/>IsInternalNode())}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \ \ \ \ \ \ Node\ *tempNode\ =\ (*a\_root)-\/>m\_branch[0].m\_child;}
\DoxyCodeLine{01459\ }
\DoxyCodeLine{01460\ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(tempNode);}
\DoxyCodeLine{01461\ \ \ \ \ \ \ \ \ \ \ \ \ FreeNode(*a\_root);}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \ \ \ \ \ \ *a\_root\ =\ tempNode;}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01465\ \ \ \ \ \}}
\DoxyCodeLine{01466\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01467\ \ \ \ \ \{}
\DoxyCodeLine{01468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01469\ \ \ \ \ \}}
\DoxyCodeLine{01470\ \}}
\DoxyCodeLine{01471\ }
\DoxyCodeLine{01472\ \textcolor{comment}{//\ Delete\ a\ rectangle\ from\ non-\/root\ part\ of\ an\ index\ structure.}}
\DoxyCodeLine{01473\ \textcolor{comment}{//\ Called\ by\ RemoveRect.\ \ Descends\ tree\ recursively,}}
\DoxyCodeLine{01474\ \textcolor{comment}{//\ merges\ branches\ on\ the\ way\ back\ up.}}
\DoxyCodeLine{01475\ \textcolor{comment}{//\ Returns\ 1\ if\ record\ not\ found,\ 0\ if\ success.}}
\DoxyCodeLine{01476\ RTREE\_TEMPLATE}
\DoxyCodeLine{01477\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::RemoveRectRec(Rect\ *a\_rect,\ \textcolor{keyword}{const}\ DATATYPE\ \&a\_id,\ Node\ *a\_node,\ ListNode\ **a\_listNode)}
\DoxyCodeLine{01478\ \{}
\DoxyCodeLine{01479\ \ \ \ \ ASSERT(a\_rect\ \&\&\ a\_node\ \&\&\ a\_listNode);}
\DoxyCodeLine{01480\ \ \ \ \ ASSERT(a\_node-\/>m\_level\ >=\ 0);}
\DoxyCodeLine{01481\ }
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>IsInternalNode())\ \textcolor{comment}{//\ not\ a\ leaf\ node}}
\DoxyCodeLine{01483\ \ \ \ \ \{}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Overlap(a\_rect,\ \&(a\_node-\/>m\_branch[index].m\_rect)))}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!RemoveRectRec(a\_rect,\ a\_id,\ a\_node-\/>m\_branch[index].m\_child,\ a\_listNode))}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>m\_branch[index].m\_child-\/>m\_count\ >=\ MINNODES)}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ child\ removed,\ just\ resize\ parent\ rect}}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_node-\/>m\_branch[index].m\_rect\ =\ NodeCover(a\_node-\/>m\_branch[index].m\_child);}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ child\ removed,\ not\ enough\ entries\ in\ node,\ eliminate\ node}}
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ReInsert(a\_node-\/>m\_branch[index].m\_child,\ a\_listNode);}
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DisconnectBranch(a\_node,\ index);\ \textcolor{comment}{//\ Must\ return\ after\ this\ call\ as\ count\ has\ changed}}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01506\ \ \ \ \ \}}
\DoxyCodeLine{01507\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ A\ leaf\ node}}
\DoxyCodeLine{01508\ \ \ \ \ \{}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01510\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>m\_branch[index].m\_data\ ==\ a\_id)}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DisconnectBranch(a\_node,\ index);\ \textcolor{comment}{//\ Must\ return\ after\ this\ call\ as\ count\ has\ changed}}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01518\ \ \ \ \ \}}
\DoxyCodeLine{01519\ \}}
\DoxyCodeLine{01520\ }
\DoxyCodeLine{01521\ \textcolor{comment}{//\ Decide\ whether\ two\ rectangles\ overlap.}}
\DoxyCodeLine{01522\ RTREE\_TEMPLATE}
\DoxyCodeLine{01523\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::Overlap(Rect\ *a\_rectA,\ Rect\ *a\_rectB)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01524\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01525\ \ \ \ \ ASSERT(a\_rectA\ \&\&\ a\_rectB);}
\DoxyCodeLine{01526\ }
\DoxyCodeLine{01527\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)}
\DoxyCodeLine{01528\ \ \ \ \ \{}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_rectA-\/>m\_min[index]\ >\ a\_rectB-\/>m\_max[index]\ ||}
\DoxyCodeLine{01530\ \ \ \ \ \ \ \ \ \ \ \ \ a\_rectB-\/>m\_min[index]\ >\ a\_rectA-\/>m\_max[index])}
\DoxyCodeLine{01531\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01534\ \ \ \ \ \}}
\DoxyCodeLine{01535\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01536\ \}}
\DoxyCodeLine{01537\ }
\DoxyCodeLine{01538\ \textcolor{comment}{//\ Add\ a\ node\ to\ the\ reinsertion\ list.\ \ All\ its\ branches\ will\ later}}
\DoxyCodeLine{01539\ \textcolor{comment}{//\ be\ reinserted\ into\ the\ index\ structure.}}
\DoxyCodeLine{01540\ RTREE\_TEMPLATE}
\DoxyCodeLine{01541\ \textcolor{keywordtype}{void}\ RTREE\_QUAL::ReInsert(Node\ *a\_node,\ ListNode\ **a\_listNode)}
\DoxyCodeLine{01542\ \{}
\DoxyCodeLine{01543\ \ \ \ \ ListNode\ *newListNode;}
\DoxyCodeLine{01544\ }
\DoxyCodeLine{01545\ \ \ \ \ newListNode\ =\ AllocListNode();}
\DoxyCodeLine{01546\ \ \ \ \ newListNode-\/>m\_node\ =\ a\_node;}
\DoxyCodeLine{01547\ \ \ \ \ newListNode-\/>m\_next\ =\ *a\_listNode;}
\DoxyCodeLine{01548\ \ \ \ \ *a\_listNode\ =\ newListNode;}
\DoxyCodeLine{01549\ \}}
\DoxyCodeLine{01550\ }
\DoxyCodeLine{01551\ \textcolor{comment}{//\ Search\ in\ an\ index\ tree\ or\ subtree\ for\ all\ data\ retangles\ that\ overlap\ the\ argument\ rectangle.}}
\DoxyCodeLine{01552\ RTREE\_TEMPLATE}
\DoxyCodeLine{01553\ \textcolor{keywordtype}{bool}\ RTREE\_QUAL::Search(Node\ *a\_node,\ Rect\ *a\_rect,\ \textcolor{keywordtype}{int}\ \&a\_foundCount,\ std::function<\textcolor{keywordtype}{bool}(\textcolor{keyword}{const}\ DATATYPE\ \&)>\ callback)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01554\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01555\ \ \ \ \ ASSERT(a\_node);}
\DoxyCodeLine{01556\ \ \ \ \ ASSERT(a\_node-\/>m\_level\ >=\ 0);}
\DoxyCodeLine{01557\ \ \ \ \ ASSERT(a\_rect);}
\DoxyCodeLine{01558\ }
\DoxyCodeLine{01559\ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>IsInternalNode())}
\DoxyCodeLine{01560\ \ \ \ \ \{}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ an\ internal\ node\ in\ the\ tree}}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Overlap(a\_rect,\ \&a\_node-\/>m\_branch[index].m\_rect))}
\DoxyCodeLine{01565\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!Search(a\_node-\/>m\_branch[index].m\_child,\ a\_rect,\ a\_foundCount,\ callback))}
\DoxyCodeLine{01567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ callback\ indicated\ to\ stop\ searching}}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01573\ \ \ \ \ \}}
\DoxyCodeLine{01574\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01575\ \ \ \ \ \{}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ a\ leaf\ node}}
\DoxyCodeLine{01577\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Overlap(a\_rect,\ \&a\_node-\/>m\_branch[index].m\_rect))}
\DoxyCodeLine{01580\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DATATYPE\ \&\textcolor{keywordtype}{id}\ =\ a\_node-\/>m\_branch[index].m\_data;}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++a\_foundCount;}
\DoxyCodeLine{01583\ }
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (callback\ \&\&\ !callback(\textcolor{keywordtype}{id}))}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \textcolor{comment}{//\ Don't\ continue\ searching}}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01590\ \ \ \ \ \}}
\DoxyCodeLine{01591\ }
\DoxyCodeLine{01592\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ Continue\ searching}}
\DoxyCodeLine{01593\ \}}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01595\ RTREE\_TEMPLATE}
\DoxyCodeLine{01596\ std::vector<typename\ RTREE\_QUAL::Rect>\ RTREE\_QUAL::ListTree()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01597\ \textcolor{keyword}{}\{}
\DoxyCodeLine{01598\ \ \ \ \ ASSERT(m\_root);}
\DoxyCodeLine{01599\ \ \ \ \ ASSERT(m\_root-\/>m\_level\ >=\ 0);}
\DoxyCodeLine{01600\ }
\DoxyCodeLine{01601\ \ \ \ \ std::vector<Rect>\ treeList;}
\DoxyCodeLine{01602\ }
\DoxyCodeLine{01603\ \ \ \ \ std::vector<Node\ *>\ toVisit;}
\DoxyCodeLine{01604\ \ \ \ \ toVisit.push\_back(m\_root);}
\DoxyCodeLine{01605\ }
\DoxyCodeLine{01606\ \ \ \ \ \textcolor{keywordflow}{while}\ (!toVisit.empty())}
\DoxyCodeLine{01607\ \ \ \ \ \{}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ Node\ *a\_node\ =\ toVisit.back();}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ toVisit.pop\_back();}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (a\_node-\/>IsInternalNode())}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ an\ internal\ node\ in\ the\ tree}}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ treeList.push\_back(a\_node-\/>m\_branch[index].m\_rect);}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ toVisit.push\_back(a\_node-\/>m\_branch[index].m\_child);}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ a\ leaf\ node}}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ treeList.push\_back(a\_node-\/>m\_branch[index].m\_rect);}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01627\ \ \ \ \ \}}
\DoxyCodeLine{01628\ }
\DoxyCodeLine{01629\ \ \ \ \ \textcolor{keywordflow}{return}\ treeList;}
\DoxyCodeLine{01630\ \}}
\DoxyCodeLine{01631\ }
\DoxyCodeLine{01632\ \textcolor{preprocessor}{\#undef\ RTREE\_TEMPLATE}}
\DoxyCodeLine{01633\ \textcolor{preprocessor}{\#undef\ RTREE\_QUAL}}
\DoxyCodeLine{01634\ }
\DoxyCodeLine{01635\ \textcolor{comment}{//\#endif\ //RTREE\_H}}
\DoxyCodeLine{01636\ }
\DoxyCodeLine{01637\ \textcolor{comment}{//}}
\DoxyCodeLine{01638\ \textcolor{comment}{//\#ifndef\ RTREE\_H}}
\DoxyCodeLine{01639\ \textcolor{comment}{//\#define\ RTREE\_H}}
\DoxyCodeLine{01640\ \textcolor{comment}{//}}
\DoxyCodeLine{01642\ \textcolor{comment}{//}}
\DoxyCodeLine{01644\ \textcolor{comment}{//\#include\ <stdio.h>}}
\DoxyCodeLine{01645\ \textcolor{comment}{//\#include\ <math.h>}}
\DoxyCodeLine{01646\ \textcolor{comment}{//\#include\ <assert.h>}}
\DoxyCodeLine{01647\ \textcolor{comment}{//\#include\ <stdlib.h>}}
\DoxyCodeLine{01648\ \textcolor{comment}{//}}
\DoxyCodeLine{01649\ \textcolor{comment}{//\#include\ <algorithm>}}
\DoxyCodeLine{01650\ \textcolor{comment}{//\#include\ <functional>}}
\DoxyCodeLine{01651\ \textcolor{comment}{//}}
\DoxyCodeLine{01652\ \textcolor{comment}{//\#define\ ASSERT\ assert\ //\ RTree\ uses\ ASSERT(\ condition\ )}}
\DoxyCodeLine{01653\ \textcolor{comment}{//\#ifndef\ Min}}
\DoxyCodeLine{01654\ \textcolor{comment}{//\#define\ Min\ std::min}}
\DoxyCodeLine{01655\ \textcolor{comment}{//\#endif\ //Min}}
\DoxyCodeLine{01656\ \textcolor{comment}{//\#ifndef\ Max}}
\DoxyCodeLine{01657\ \textcolor{comment}{//\#define\ Max\ std::max}}
\DoxyCodeLine{01658\ \textcolor{comment}{//\#endif\ //Max}}
\DoxyCodeLine{01659\ \textcolor{comment}{//}}
\DoxyCodeLine{01663\ \textcolor{comment}{//}}
\DoxyCodeLine{01664\ \textcolor{comment}{//\#define\ RTREE\_TEMPLATE\ template<class\ DATATYPE,\ class\ ELEMTYPE,\ int\ NUMDIMS,\ class\ ELEMTYPEREAL,\ int\ TMAXNODES,\ int\ TMINNODES>}}
\DoxyCodeLine{01665\ \textcolor{comment}{//\#define\ RTREE\_QUAL\ RTree<DATATYPE,\ ELEMTYPE,\ NUMDIMS,\ ELEMTYPEREAL,\ TMAXNODES,\ TMINNODES>}}
\DoxyCodeLine{01666\ \textcolor{comment}{//}}
\DoxyCodeLine{01667\ \textcolor{comment}{//\#define\ RTREE\_DONT\_USE\_MEMPOOLS\ //\ This\ version\ does\ not\ contain\ a\ fixed\ memory\ allocator,\ fill\ in\ lines\ with\ EXAMPLE\ to\ implement\ one.}}
\DoxyCodeLine{01668\ \textcolor{comment}{//\#define\ RTREE\_USE\_SPHERICAL\_VOLUME\ //\ Better\ split\ classification,\ may\ be\ slower\ on\ some\ systems}}
\DoxyCodeLine{01669\ \textcolor{comment}{//}}
\DoxyCodeLine{01671\ \textcolor{comment}{//\ class\ RTFileStream;\ \ //\ File\ I/O\ helper\ class,\ look\ below\ for\ implementation\ and\ notes.}}
\DoxyCodeLine{01672\ \textcolor{comment}{//}}
\DoxyCodeLine{01673\ \textcolor{comment}{//}}
\DoxyCodeLine{01690\ \textcolor{comment}{//\ template<class\ DATATYPE,\ class\ ELEMTYPE,\ int\ NUMDIMS,}}
\DoxyCodeLine{01691\ \textcolor{comment}{//\ \ class\ ELEMTYPEREAL\ =\ ELEMTYPE,\ int\ TMAXNODES\ =\ 8,\ int\ TMINNODES\ =\ TMAXNODES\ /\ 2>}}
\DoxyCodeLine{01692\ \textcolor{comment}{//\ \ class\ RTree\ \{}}
\DoxyCodeLine{01693\ \textcolor{comment}{//\ \ static\_assert(std::numeric\_limits<ELEMTYPEREAL>::is\_iec559,\ "{}'ELEMTYPEREAL'\ accepts\ floating-\/point\ types\ only"{});}}
\DoxyCodeLine{01694\ \textcolor{comment}{//}}
\DoxyCodeLine{01695\ \textcolor{comment}{//\ \ protected:}}
\DoxyCodeLine{01696\ \textcolor{comment}{//}}
\DoxyCodeLine{01697\ \textcolor{comment}{//\ \ \ \ \ \ struct\ Node;\ \ //\ Fwd\ decl.\ \ Used\ by\ other\ internal\ structs\ and\ iterator}}
\DoxyCodeLine{01698\ \textcolor{comment}{//}}
\DoxyCodeLine{01699\ \textcolor{comment}{//\ \ public:}}
\DoxyCodeLine{01700\ \textcolor{comment}{//}}
\DoxyCodeLine{01701\ \textcolor{comment}{//\ \ \ \ \ \ //\ These\ constant\ must\ be\ declared\ after\ Branch\ and\ before\ Node\ struct}}
\DoxyCodeLine{01702\ \textcolor{comment}{//\ \ \ \ \ \ //\ Stuck\ up\ here\ for\ MSVC\ 6\ compiler.\ \ NSVC\ .NET\ 2003\ is\ much\ happier.}}
\DoxyCodeLine{01703\ \textcolor{comment}{//\ \ \ \ \ \ enum\ \{}}
\DoxyCodeLine{01704\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ MAXNODES\ =\ TMAXNODES,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Max\ elements\ in\ node}}
\DoxyCodeLine{01705\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ MINNODES\ =\ TMINNODES,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Min\ elements\ in\ node}}
\DoxyCodeLine{01706\ \textcolor{comment}{//\ \ \ \ \ \ \};}}
\DoxyCodeLine{01707\ \textcolor{comment}{//}}
\DoxyCodeLine{01708\ \textcolor{comment}{//\ \ public:}}
\DoxyCodeLine{01709\ \textcolor{comment}{//}}
\DoxyCodeLine{01710\ \textcolor{comment}{//\ \ \ \ \ \ RTree();}}
\DoxyCodeLine{01711\ \textcolor{comment}{//\ \ \ \ \ \ RTree(const\ RTree\&\ other);}}
\DoxyCodeLine{01712\ \textcolor{comment}{//\ \ \ \ \ \ virtual\ \string~RTree();}}
\DoxyCodeLine{01713\ \textcolor{comment}{//}}
\DoxyCodeLine{01714\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Insert\ entry}}
\DoxyCodeLine{01715\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_min\ Min\ of\ bounding\ rect}}
\DoxyCodeLine{01716\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_max\ Max\ of\ bounding\ rect}}
\DoxyCodeLine{01717\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_dataId\ Positive\ Id\ of\ data.\ \ Maybe\ zero,\ but\ negative\ numbers\ not\ allowed.}}
\DoxyCodeLine{01718\ \textcolor{comment}{//\ \ \ \ \ \ void\ Insert(const\ ELEMTYPE\ a\_min[NUMDIMS],\ const\ ELEMTYPE\ a\_max[NUMDIMS],\ const\ DATATYPE\&\ a\_dataId);}}
\DoxyCodeLine{01719\ \textcolor{comment}{//}}
\DoxyCodeLine{01720\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Remove\ entry}}
\DoxyCodeLine{01721\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_min\ Min\ of\ bounding\ rect}}
\DoxyCodeLine{01722\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_max\ Max\ of\ bounding\ rect}}
\DoxyCodeLine{01723\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_dataId\ Positive\ Id\ of\ data.\ \ Maybe\ zero,\ but\ negative\ numbers\ not\ allowed.}}
\DoxyCodeLine{01724\ \textcolor{comment}{//\ \ \ \ \ \ void\ Remove(const\ ELEMTYPE\ a\_min[NUMDIMS],\ const\ ELEMTYPE\ a\_max[NUMDIMS],\ const\ DATATYPE\&\ a\_dataId);}}
\DoxyCodeLine{01725\ \textcolor{comment}{//}}
\DoxyCodeLine{01726\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Find\ all\ within\ search\ rectangle}}
\DoxyCodeLine{01727\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_min\ Min\ of\ search\ bounding\ rect}}
\DoxyCodeLine{01728\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_max\ Max\ of\ search\ bounding\ rect}}
\DoxyCodeLine{01729\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_searchResult\ Search\ result\ array.\ \ Caller\ should\ set\ grow\ size.\ Function\ will\ reset,\ not\ append\ to\ array.}}
\DoxyCodeLine{01730\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_resultCallback\ Callback\ function\ to\ return\ result.\ \ Callback\ should\ return\ 'true'\ to\ continue\ searching}}
\DoxyCodeLine{01731\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)param\ a\_context\ User\ context\ to\ pass\ as\ parameter\ to\ a\_resultCallback}}
\DoxyCodeLine{01732\ \textcolor{comment}{//\ \ \ \ \ \ ///\ \(\backslash\)return\ Returns\ the\ number\ of\ entries\ found}}
\DoxyCodeLine{01733\ \textcolor{comment}{//\ \ \ \ \ \ int\ Search(const\ ELEMTYPE\ a\_min[NUMDIMS],\ const\ ELEMTYPE\ a\_max[NUMDIMS],\ std::function<bool(const\ DATATYPE\&)>\ callback)\ const;}}
\DoxyCodeLine{01734\ \textcolor{comment}{//}}
\DoxyCodeLine{01735\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Remove\ all\ entries\ from\ tree}}
\DoxyCodeLine{01736\ \textcolor{comment}{//\ \ \ \ \ \ void\ RemoveAll();}}
\DoxyCodeLine{01737\ \textcolor{comment}{//}}
\DoxyCodeLine{01738\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Count\ the\ data\ elements\ in\ this\ container.\ \ This\ is\ slow\ as\ no\ internal\ counter\ is\ maintained.}}
\DoxyCodeLine{01739\ \textcolor{comment}{//\ \ \ \ \ \ int\ Count();}}
\DoxyCodeLine{01740\ \textcolor{comment}{//}}
\DoxyCodeLine{01741\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Load\ tree\ contents\ from\ file}}
\DoxyCodeLine{01742\ \textcolor{comment}{//\ \ \ \ \ \ bool\ Load(const\ char*\ a\_fileName);}}
\DoxyCodeLine{01743\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Load\ tree\ contents\ from\ stream}}
\DoxyCodeLine{01744\ \textcolor{comment}{//\ \ \ \ \ \ bool\ Load(RTFileStream\&\ a\_stream);}}
\DoxyCodeLine{01745\ \textcolor{comment}{//}}
\DoxyCodeLine{01746\ \textcolor{comment}{//}}
\DoxyCodeLine{01747\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Save\ tree\ contents\ to\ file}}
\DoxyCodeLine{01748\ \textcolor{comment}{//\ \ \ \ \ \ bool\ Save(const\ char*\ a\_fileName);}}
\DoxyCodeLine{01749\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Save\ tree\ contents\ to\ stream}}
\DoxyCodeLine{01750\ \textcolor{comment}{//\ \ \ \ \ \ bool\ Save(RTFileStream\&\ a\_stream);}}
\DoxyCodeLine{01751\ \textcolor{comment}{//}}
\DoxyCodeLine{01752\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Iterator\ is\ not\ remove\ safe.}}
\DoxyCodeLine{01753\ \textcolor{comment}{//\ \ \ \ \ \ class\ Iterator\ \{}}
\DoxyCodeLine{01754\ \textcolor{comment}{//\ \ \ \ \ \ private:}}
\DoxyCodeLine{01755\ \textcolor{comment}{//}}
\DoxyCodeLine{01756\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ enum\ \{\ MAX\_STACK\ =\ 32\ \};\ //\ \ Max\ stack\ size.\ Allows\ almost\ n\string^32\ where\ n\ is\ number\ of\ branches\ in\ node}}
\DoxyCodeLine{01757\ \textcolor{comment}{//}}
\DoxyCodeLine{01758\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ struct\ StackElement\ \{}}
\DoxyCodeLine{01759\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Node*\ m\_node;}}
\DoxyCodeLine{01760\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ int\ m\_branchIndex;}}
\DoxyCodeLine{01761\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \};}}
\DoxyCodeLine{01762\ \textcolor{comment}{//}}
\DoxyCodeLine{01763\ \textcolor{comment}{//\ \ \ \ \ \ public:}}
\DoxyCodeLine{01764\ \textcolor{comment}{//}}
\DoxyCodeLine{01765\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Iterator()\ \{\ Init();\ \}}}
\DoxyCodeLine{01766\ \textcolor{comment}{//}}
\DoxyCodeLine{01767\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \string~Iterator()\ \{\}}}
\DoxyCodeLine{01768\ \textcolor{comment}{//}}
\DoxyCodeLine{01769\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Is\ iterator\ invalid}}
\DoxyCodeLine{01770\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bool\ IsNull()\ \{\ return\ (m\_tos\ <=\ 0);\ \}}}
\DoxyCodeLine{01771\ \textcolor{comment}{//}}
\DoxyCodeLine{01772\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Is\ iterator\ pointing\ to\ valid\ data}}
\DoxyCodeLine{01773\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bool\ IsNotNull()\ \{\ return\ (m\_tos\ >\ 0);\ \}}}
\DoxyCodeLine{01774\ \textcolor{comment}{//}}
\DoxyCodeLine{01775\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Access\ the\ current\ data\ element.\ Caller\ must\ be\ sure\ iterator\ is\ not\ NULL\ first.}}
\DoxyCodeLine{01776\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ DATATYPE\&\ operator*()\ \{}}
\DoxyCodeLine{01777\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(IsNotNull());}}
\DoxyCodeLine{01778\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\&\ curTos\ =\ m\_stack[m\_tos\ -\/\ 1];}}
\DoxyCodeLine{01779\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ curTos.m\_node-\/>m\_branch[curTos.m\_branchIndex].m\_data;}}
\DoxyCodeLine{01780\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01781\ \textcolor{comment}{//}}
\DoxyCodeLine{01782\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Access\ the\ current\ data\ element.\ Caller\ must\ be\ sure\ iterator\ is\ not\ NULL\ first.}}
\DoxyCodeLine{01783\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ const\ DATATYPE\&\ operator*()\ const\ \{}}
\DoxyCodeLine{01784\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(IsNotNull());}}
\DoxyCodeLine{01785\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\&\ curTos\ =\ m\_stack[m\_tos\ -\/\ 1];}}
\DoxyCodeLine{01786\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ curTos.m\_node-\/>m\_branch[curTos.m\_branchIndex].m\_data;}}
\DoxyCodeLine{01787\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01788\ \textcolor{comment}{//}}
\DoxyCodeLine{01789\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Find\ the\ next\ data\ element}}
\DoxyCodeLine{01790\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bool\ operator++()\ \{\ return\ FindNextData();\ \}}}
\DoxyCodeLine{01791\ \textcolor{comment}{//}}
\DoxyCodeLine{01792\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Get\ the\ bounds\ for\ this\ node}}
\DoxyCodeLine{01793\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ void\ GetBounds(ELEMTYPE\ a\_min[NUMDIMS],\ ELEMTYPE\ a\_max[NUMDIMS])\ \{}}
\DoxyCodeLine{01794\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(IsNotNull());}}
\DoxyCodeLine{01795\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\&\ curTos\ =\ m\_stack[m\_tos\ -\/\ 1];}}
\DoxyCodeLine{01796\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Branch\&\ curBranch\ =\ curTos.m\_node-\/>m\_branch[curTos.m\_branchIndex];}}
\DoxyCodeLine{01797\ \textcolor{comment}{//}}
\DoxyCodeLine{01798\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{01799\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_min[index]\ =\ curBranch.m\_rect.m\_min[index];}}
\DoxyCodeLine{01800\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_max[index]\ =\ curBranch.m\_rect.m\_max[index];}}
\DoxyCodeLine{01801\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01802\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01803\ \textcolor{comment}{//}}
\DoxyCodeLine{01804\ \textcolor{comment}{//\ \ \ \ \ \ private:}}
\DoxyCodeLine{01805\ \textcolor{comment}{//}}
\DoxyCodeLine{01806\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Reset\ iterator}}
\DoxyCodeLine{01807\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ void\ Init()\ \{\ m\_tos\ =\ 0;\ \}}}
\DoxyCodeLine{01808\ \textcolor{comment}{//}}
\DoxyCodeLine{01809\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Find\ the\ next\ data\ element\ in\ the\ tree\ (For\ internal\ use\ only)}}
\DoxyCodeLine{01810\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bool\ FindNextData()\ \{}}
\DoxyCodeLine{01811\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (;;)\ \{}}
\DoxyCodeLine{01812\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (m\_tos\ <=\ 0)\ \{}}
\DoxyCodeLine{01813\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{01814\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01815\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StackElement\ curTos\ =\ Pop();\ //\ Copy\ stack\ top\ cause\ it\ may\ change\ as\ we\ use\ it}}
\DoxyCodeLine{01816\ \textcolor{comment}{//}}
\DoxyCodeLine{01817\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (curTos.m\_node-\/>IsLeaf())\ \{}}
\DoxyCodeLine{01818\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ Keep\ walking\ through\ data\ while\ we\ can}}
\DoxyCodeLine{01819\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (curTos.m\_branchIndex\ +\ 1\ <\ curTos.m\_node-\/>m\_count)\ \{}}
\DoxyCodeLine{01820\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ There\ is\ more\ data,\ just\ point\ to\ the\ next\ one}}
\DoxyCodeLine{01821\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Push(curTos.m\_node,\ curTos.m\_branchIndex\ +\ 1);}}
\DoxyCodeLine{01822\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{01823\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01824\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ No\ more\ data,\ so\ it\ will\ fall\ back\ to\ previous\ level}}
\DoxyCodeLine{01825\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ else\ \{}}
\DoxyCodeLine{01826\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (curTos.m\_branchIndex\ +\ 1\ <\ curTos.m\_node-\/>m\_count)\ \{}}
\DoxyCodeLine{01827\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ Push\ sibling\ on\ for\ future\ tree\ walk}}
\DoxyCodeLine{01828\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ This\ is\ the\ 'fall\ back'\ node\ when\ we\ finish\ with\ the\ current\ level}}
\DoxyCodeLine{01829\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Push(curTos.m\_node,\ curTos.m\_branchIndex\ +\ 1);}}
\DoxyCodeLine{01830\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01831\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ Since\ cur\ node\ is\ not\ a\ leaf,\ push\ first\ of\ next\ level\ to\ get\ deeper\ into\ the\ tree}}
\DoxyCodeLine{01832\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Node*\ nextLevelnode\ =\ curTos.m\_node-\/>m\_branch[curTos.m\_branchIndex].m\_child;}}
\DoxyCodeLine{01833\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Push(nextLevelnode,\ 0);}}
\DoxyCodeLine{01834\ \textcolor{comment}{//}}
\DoxyCodeLine{01835\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ If\ we\ pushed\ on\ a\ new\ leaf,\ exit\ as\ the\ data\ is\ ready\ at\ TOS}}
\DoxyCodeLine{01836\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (nextLevelnode-\/>IsLeaf())\ \{}}
\DoxyCodeLine{01837\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{01838\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01839\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01840\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01841\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01842\ \textcolor{comment}{//}}
\DoxyCodeLine{01843\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Push\ node\ and\ branch\ onto\ iteration\ stack\ (For\ internal\ use\ only)}}
\DoxyCodeLine{01844\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ void\ Push(Node*\ a\_node,\ int\ a\_branchIndex)\ \{}}
\DoxyCodeLine{01845\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_stack[m\_tos].m\_node\ =\ a\_node;}}
\DoxyCodeLine{01846\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_stack[m\_tos].m\_branchIndex\ =\ a\_branchIndex;}}
\DoxyCodeLine{01847\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++m\_tos;}}
\DoxyCodeLine{01848\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(m\_tos\ <=\ MAX\_STACK);}}
\DoxyCodeLine{01849\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01850\ \textcolor{comment}{//}}
\DoxyCodeLine{01851\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ///\ Pop\ element\ off\ iteration\ stack\ (For\ internal\ use\ only)}}
\DoxyCodeLine{01852\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ StackElement\&\ Pop()\ \{}}
\DoxyCodeLine{01853\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ASSERT(m\_tos\ >\ 0);}}
\DoxyCodeLine{01854\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/m\_tos;}}
\DoxyCodeLine{01855\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ m\_stack[m\_tos];}}
\DoxyCodeLine{01856\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01857\ \textcolor{comment}{//}}
\DoxyCodeLine{01858\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ StackElement\ m\_stack[MAX\_STACK];\ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Stack\ as\ we\ are\ doing\ iteration\ instead\ of\ recursion}}
\DoxyCodeLine{01859\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_tos;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Top\ Of\ Stack\ index}}
\DoxyCodeLine{01860\ \textcolor{comment}{//}}
\DoxyCodeLine{01861\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ friend\ class\ RTree;\ //\ Allow\ hiding\ of\ non-\/public\ functions\ while\ allowing\ manipulation\ by\ logical\ owner}}
\DoxyCodeLine{01862\ \textcolor{comment}{//\ \ \ \ \ \ \};}}
\DoxyCodeLine{01863\ \textcolor{comment}{//}}
\DoxyCodeLine{01864\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Get\ 'first'\ for\ iteration}}
\DoxyCodeLine{01865\ \textcolor{comment}{//\ \ \ \ \ \ void\ GetFirst(Iterator\&\ a\_it)\ \{}}
\DoxyCodeLine{01866\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_it.Init();}}
\DoxyCodeLine{01867\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Node*\ first\ =\ m\_root;}}
\DoxyCodeLine{01868\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ while\ (first)\ \{}}
\DoxyCodeLine{01869\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (first-\/>IsInternalNode()\ \&\&\ first-\/>m\_count\ >\ 1)\ \{}}
\DoxyCodeLine{01870\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_it.Push(first,\ 1);\ //\ Descend\ sibling\ branch\ later}}
\DoxyCodeLine{01871\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ else\ if\ (first-\/>IsLeaf())\ \{}}
\DoxyCodeLine{01872\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (first-\/>m\_count)\ \{}}
\DoxyCodeLine{01873\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_it.Push(first,\ 0);}}
\DoxyCodeLine{01874\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01875\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ break;}}
\DoxyCodeLine{01876\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01877\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ first\ =\ first-\/>m\_branch[0].m\_child;}}
\DoxyCodeLine{01878\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01879\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{01880\ \textcolor{comment}{//}}
\DoxyCodeLine{01881\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Get\ Next\ for\ iteration}}
\DoxyCodeLine{01882\ \textcolor{comment}{//\ \ \ \ \ \ void\ GetNext(Iterator\&\ a\_it)\ \{\ ++a\_it;\ \}}}
\DoxyCodeLine{01883\ \textcolor{comment}{//}}
\DoxyCodeLine{01884\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Is\ iterator\ NULL,\ or\ at\ end?}}
\DoxyCodeLine{01885\ \textcolor{comment}{//\ \ \ \ \ \ bool\ IsNull(Iterator\&\ a\_it)\ \{\ return\ a\_it.IsNull();\ \}}}
\DoxyCodeLine{01886\ \textcolor{comment}{//}}
\DoxyCodeLine{01887\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Get\ object\ at\ iterator\ position}}
\DoxyCodeLine{01888\ \textcolor{comment}{//\ \ \ \ \ \ DATATYPE\&\ GetAt(Iterator\&\ a\_it)\ \{\ return\ *a\_it;\ \}}}
\DoxyCodeLine{01889\ \textcolor{comment}{//}}
\DoxyCodeLine{01890\ \textcolor{comment}{//\ \ public:}}
\DoxyCodeLine{01891\ \textcolor{comment}{//}}
\DoxyCodeLine{01892\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Minimal\ bounding\ rectangle\ (n-\/dimensional)}}
\DoxyCodeLine{01893\ \textcolor{comment}{//\ \ \ \ \ \ struct\ Rect\ \{}}
\DoxyCodeLine{01894\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ELEMTYPE\ m\_min[NUMDIMS];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Min\ dimensions\ of\ bounding\ box}}
\DoxyCodeLine{01895\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ELEMTYPE\ m\_max[NUMDIMS];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Max\ dimensions\ of\ bounding\ box}}
\DoxyCodeLine{01896\ \textcolor{comment}{//\ \ \ \ \ \ \};}}
\DoxyCodeLine{01897\ \textcolor{comment}{//}}
\DoxyCodeLine{01898\ \textcolor{comment}{//\ \ \ \ \ \ ///\ May\ be\ data\ or\ may\ be\ another\ subtree}}
\DoxyCodeLine{01899\ \textcolor{comment}{//\ \ \ \ \ \ ///\ The\ parents\ level\ determines\ this.}}
\DoxyCodeLine{01900\ \textcolor{comment}{//\ \ \ \ \ \ ///\ If\ the\ parents\ level\ is\ 0,\ then\ this\ is\ data}}
\DoxyCodeLine{01901\ \textcolor{comment}{//\ \ \ \ \ \ struct\ Branch\ \{}}
\DoxyCodeLine{01902\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Rect\ m\_rect;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Bounds}}
\DoxyCodeLine{01903\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Node*\ m\_child;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Child\ node}}
\DoxyCodeLine{01904\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ DATATYPE\ m\_data;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Data\ Id}}
\DoxyCodeLine{01905\ \textcolor{comment}{//\ \ \ \ \ \ \};}}
\DoxyCodeLine{01906\ \textcolor{comment}{//}}
\DoxyCodeLine{01907\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Node\ for\ each\ branch\ level}}
\DoxyCodeLine{01908\ \textcolor{comment}{//\ \ \ \ \ \ struct\ Node\ \{}}
\DoxyCodeLine{01909\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bool\ IsInternalNode()\ \{\ return\ (m\_level\ >\ 0);\ \}\ //\ Not\ a\ leaf,\ but\ a\ internal\ node}}
\DoxyCodeLine{01910\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bool\ IsLeaf()\ \{\ return\ (m\_level\ ==\ 0);\ \}\ //\ A\ leaf,\ contains\ data}}
\DoxyCodeLine{01911\ \textcolor{comment}{//}}
\DoxyCodeLine{01912\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_count;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Count}}
\DoxyCodeLine{01913\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_level;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Leaf\ is\ zero,\ others\ positive}}
\DoxyCodeLine{01914\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch\ m\_branch[MAXNODES];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Branch}}
\DoxyCodeLine{01915\ \textcolor{comment}{//\ \ \ \ \ \ \};}}
\DoxyCodeLine{01916\ \textcolor{comment}{//}}
\DoxyCodeLine{01917\ \textcolor{comment}{//\ \ \ \ \ \ ///\ A\ link\ list\ of\ nodes\ for\ reinsertion\ after\ a\ delete\ operation}}
\DoxyCodeLine{01918\ \textcolor{comment}{//\ \ \ \ \ \ struct\ ListNode\ \{}}
\DoxyCodeLine{01919\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ListNode*\ m\_next;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Next\ in\ list}}
\DoxyCodeLine{01920\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Node*\ m\_node;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Node}}
\DoxyCodeLine{01921\ \textcolor{comment}{//\ \ \ \ \ \ \};}}
\DoxyCodeLine{01922\ \textcolor{comment}{//}}
\DoxyCodeLine{01923\ \textcolor{comment}{//\ \ \ \ \ \ ///\ Variables\ for\ finding\ a\ split\ partition}}
\DoxyCodeLine{01924\ \textcolor{comment}{//\ \ \ \ \ \ struct\ PartitionVars\ \{}}
\DoxyCodeLine{01925\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ enum\ \{\ NOT\_TAKEN\ =\ -\/1\ \};\ //\ indicates\ that\ position}}
\DoxyCodeLine{01926\ \textcolor{comment}{//}}
\DoxyCodeLine{01927\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_partition[MAXNODES\ +\ 1];}}
\DoxyCodeLine{01928\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_total;}}
\DoxyCodeLine{01929\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_minFill;}}
\DoxyCodeLine{01930\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_count[2];}}
\DoxyCodeLine{01931\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Rect\ m\_cover[2];}}
\DoxyCodeLine{01932\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ m\_area[2];}}
\DoxyCodeLine{01933\ \textcolor{comment}{//}}
\DoxyCodeLine{01934\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch\ m\_branchBuf[MAXNODES\ +\ 1];}}
\DoxyCodeLine{01935\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ int\ m\_branchCount;}}
\DoxyCodeLine{01936\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Rect\ m\_coverSplit;}}
\DoxyCodeLine{01937\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ m\_coverSplitArea;}}
\DoxyCodeLine{01938\ \textcolor{comment}{//\ \ \ \ \ \ \};}}
\DoxyCodeLine{01939\ \textcolor{comment}{//}}
\DoxyCodeLine{01940\ \textcolor{comment}{//\ \ \ \ \ \ Node*\ AllocNode();}}
\DoxyCodeLine{01941\ \textcolor{comment}{//\ \ \ \ \ \ void\ FreeNode(Node*\ a\_node);}}
\DoxyCodeLine{01942\ \textcolor{comment}{//\ \ \ \ \ \ void\ InitNode(Node*\ a\_node);}}
\DoxyCodeLine{01943\ \textcolor{comment}{//\ \ \ \ \ \ void\ InitRect(Rect*\ a\_rect);}}
\DoxyCodeLine{01944\ \textcolor{comment}{//\ \ \ \ \ \ bool\ InsertRectRec(const\ Branch\&\ a\_branch,\ Node*\ a\_node,\ Node**\ a\_newNode,\ int\ a\_level);}}
\DoxyCodeLine{01945\ \textcolor{comment}{//\ \ \ \ \ \ bool\ InsertRect(const\ Branch\&\ a\_branch,\ Node**\ a\_root,\ int\ a\_level);}}
\DoxyCodeLine{01946\ \textcolor{comment}{//\ \ \ \ \ \ Rect\ NodeCover(Node*\ a\_node);}}
\DoxyCodeLine{01947\ \textcolor{comment}{//\ \ \ \ \ \ bool\ AddBranch(const\ Branch*\ a\_branch,\ Node*\ a\_node,\ Node**\ a\_newNode);}}
\DoxyCodeLine{01948\ \textcolor{comment}{//\ \ \ \ \ \ void\ DisconnectBranch(Node*\ a\_node,\ int\ a\_index);}}
\DoxyCodeLine{01949\ \textcolor{comment}{//\ \ \ \ \ \ int\ PickBranch(const\ Rect*\ a\_rect,\ Node*\ a\_node);}}
\DoxyCodeLine{01950\ \textcolor{comment}{//\ \ \ \ \ \ Rect\ CombineRect(const\ Rect*\ a\_rectA,\ const\ Rect*\ a\_rectB);}}
\DoxyCodeLine{01951\ \textcolor{comment}{//\ \ \ \ \ \ void\ SplitNode(Node*\ a\_node,\ const\ Branch*\ a\_branch,\ Node**\ a\_newNode);}}
\DoxyCodeLine{01952\ \textcolor{comment}{//\ \ \ \ \ \ ELEMTYPEREAL\ RectSphericalVolume(Rect*\ a\_rect);}}
\DoxyCodeLine{01953\ \textcolor{comment}{//\ \ \ \ \ \ ELEMTYPEREAL\ RectVolume(Rect*\ a\_rect);}}
\DoxyCodeLine{01954\ \textcolor{comment}{//\ \ \ \ \ \ ELEMTYPEREAL\ CalcRectVolume(Rect*\ a\_rect);}}
\DoxyCodeLine{01955\ \textcolor{comment}{//\ \ \ \ \ \ void\ GetBranches(Node*\ a\_node,\ const\ Branch*\ a\_branch,\ PartitionVars*\ a\_parVars);}}
\DoxyCodeLine{01956\ \textcolor{comment}{//\ \ \ \ \ \ void\ ChoosePartition(PartitionVars*\ a\_parVars,\ int\ a\_minFill);}}
\DoxyCodeLine{01957\ \textcolor{comment}{//\ \ \ \ \ \ void\ LoadNodes(Node*\ a\_nodeA,\ Node*\ a\_nodeB,\ PartitionVars*\ a\_parVars);}}
\DoxyCodeLine{01958\ \textcolor{comment}{//\ \ \ \ \ \ void\ InitParVars(PartitionVars*\ a\_parVars,\ int\ a\_maxRects,\ int\ a\_minFill);}}
\DoxyCodeLine{01959\ \textcolor{comment}{//\ \ \ \ \ \ void\ PickSeeds(PartitionVars*\ a\_parVars);}}
\DoxyCodeLine{01960\ \textcolor{comment}{//\ \ \ \ \ \ void\ Classify(int\ a\_index,\ int\ a\_group,\ PartitionVars*\ a\_parVars);}}
\DoxyCodeLine{01961\ \textcolor{comment}{//\ \ \ \ \ \ bool\ RemoveRect(Rect*\ a\_rect,\ const\ DATATYPE\&\ a\_id,\ Node**\ a\_root);}}
\DoxyCodeLine{01962\ \textcolor{comment}{//\ \ \ \ \ \ bool\ RemoveRectRec(Rect*\ a\_rect,\ const\ DATATYPE\&\ a\_id,\ Node*\ a\_node,\ ListNode**\ a\_listNode);}}
\DoxyCodeLine{01963\ \textcolor{comment}{//\ \ \ \ \ \ ListNode*\ AllocListNode();}}
\DoxyCodeLine{01964\ \textcolor{comment}{//\ \ \ \ \ \ void\ FreeListNode(ListNode*\ a\_listNode);}}
\DoxyCodeLine{01965\ \textcolor{comment}{//\ \ \ \ \ \ bool\ Overlap(Rect*\ a\_rectA,\ Rect*\ a\_rectB)\ const;}}
\DoxyCodeLine{01966\ \textcolor{comment}{//\ \ \ \ \ \ void\ ReInsert(Node*\ a\_node,\ ListNode**\ a\_listNode);}}
\DoxyCodeLine{01967\ \textcolor{comment}{//\ \ \ \ \ \ bool\ Search(Node*\ a\_node,\ Rect*\ a\_rect,\ int\&\ a\_foundCount,\ std::function<bool(const\ DATATYPE\&)>\ callback)\ const;}}
\DoxyCodeLine{01968\ \textcolor{comment}{//\ \ \ \ \ \ void\ RemoveAllRec(Node*\ a\_node);}}
\DoxyCodeLine{01969\ \textcolor{comment}{//\ \ \ \ \ \ void\ Reset();}}
\DoxyCodeLine{01970\ \textcolor{comment}{//\ \ \ \ \ \ void\ CountRec(Node*\ a\_node,\ int\&\ a\_count);}}
\DoxyCodeLine{01971\ \textcolor{comment}{//}}
\DoxyCodeLine{01972\ \textcolor{comment}{//\ \ \ \ \ \ bool\ SaveRec(Node*\ a\_node,\ RTFileStream\&\ a\_stream);}}
\DoxyCodeLine{01973\ \textcolor{comment}{//\ \ \ \ \ \ bool\ LoadRec(Node*\ a\_node,\ RTFileStream\&\ a\_stream);}}
\DoxyCodeLine{01974\ \textcolor{comment}{//\ \ \ \ \ \ void\ CopyRec(Node*\ current,\ Node*\ other);}}
\DoxyCodeLine{01975\ \textcolor{comment}{//}}
\DoxyCodeLine{01976\ \textcolor{comment}{//\ \ \ \ \ \ Node*\ m\_root;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Root\ of\ tree}}
\DoxyCodeLine{01977\ \textcolor{comment}{//\ \ \ \ \ \ ELEMTYPEREAL\ m\_unitSphereVolume;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ///<\ Unit\ sphere\ constant\ for\ required\ number\ of\ dimensions}}
\DoxyCodeLine{01978\ \textcolor{comment}{//\ \};}}
\DoxyCodeLine{01979\ \textcolor{comment}{//}}
\DoxyCodeLine{01980\ \textcolor{comment}{//}}
\DoxyCodeLine{01983\ \textcolor{comment}{//\ class\ RTFileStream\ \{}}
\DoxyCodeLine{01984\ \textcolor{comment}{//\ \ FILE*\ m\_file;}}
\DoxyCodeLine{01985\ \textcolor{comment}{//}}
\DoxyCodeLine{01986\ \textcolor{comment}{//\ public:}}
\DoxyCodeLine{01987\ \textcolor{comment}{//}}
\DoxyCodeLine{01988\ \textcolor{comment}{//}}
\DoxyCodeLine{01989\ \textcolor{comment}{//\ \ RTFileStream()\ \{}}
\DoxyCodeLine{01990\ \textcolor{comment}{//\ \ \ \ \ \ m\_file\ =\ NULL;}}
\DoxyCodeLine{01991\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{01992\ \textcolor{comment}{//}}
\DoxyCodeLine{01993\ \textcolor{comment}{//\ \ \string~RTFileStream()\ \{}}
\DoxyCodeLine{01994\ \textcolor{comment}{//\ \ \ \ \ \ Close();}}
\DoxyCodeLine{01995\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{01996\ \textcolor{comment}{//}}
\DoxyCodeLine{01997\ \textcolor{comment}{//\ \ bool\ Open(const\ char*\ a\_fileName,\ const\ char*\ mode)\ \{}}
\DoxyCodeLine{01998\ \textcolor{comment}{//\#if\ defined(\_WIN32)\ \&\&\ defined(\_\_STDC\_WANT\_SECURE\_LIB\_\_)}}
\DoxyCodeLine{01999\ \textcolor{comment}{//\ \ \ \ \ \ return\ fopen\_s(\&m\_file,\ a\_fileName,\ mode)\ ==\ 0;}}
\DoxyCodeLine{02000\ \textcolor{comment}{//\#else}}
\DoxyCodeLine{02001\ \textcolor{comment}{//\ \ \ \ \ \ m\_file\ =\ fopen(a\_fileName,\ mode);}}
\DoxyCodeLine{02002\ \textcolor{comment}{//\ \ \ \ \ \ return\ m\_file\ !=\ nullptr;}}
\DoxyCodeLine{02003\ \textcolor{comment}{//\#endif}}
\DoxyCodeLine{02004\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02005\ \textcolor{comment}{//}}
\DoxyCodeLine{02006\ \textcolor{comment}{//\ \ bool\ OpenRead(const\ char*\ a\_fileName)\ \{}}
\DoxyCodeLine{02007\ \textcolor{comment}{//\ \ \ \ \ \ return\ this-\/>Open(a\_fileName,\ "{}rb"{});}}
\DoxyCodeLine{02008\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02009\ \textcolor{comment}{//}}
\DoxyCodeLine{02010\ \textcolor{comment}{//\ \ bool\ OpenWrite(const\ char*\ a\_fileName)\ \{}}
\DoxyCodeLine{02011\ \textcolor{comment}{//\ \ \ \ \ \ return\ this-\/>Open(a\_fileName,\ "{}wb"{});}}
\DoxyCodeLine{02012\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02013\ \textcolor{comment}{//}}
\DoxyCodeLine{02014\ \textcolor{comment}{//\ \ void\ Close()\ \{}}
\DoxyCodeLine{02015\ \textcolor{comment}{//\ \ \ \ \ \ if\ (m\_file)\ \{}}
\DoxyCodeLine{02016\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ fclose(m\_file);}}
\DoxyCodeLine{02017\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ m\_file\ =\ NULL;}}
\DoxyCodeLine{02018\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02019\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02020\ \textcolor{comment}{//}}
\DoxyCodeLine{02021\ \textcolor{comment}{//\ \ template<\ typename\ TYPE\ >}}
\DoxyCodeLine{02022\ \textcolor{comment}{//\ \ size\_t\ Write(const\ TYPE\&\ a\_value)\ \{}}
\DoxyCodeLine{02023\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(m\_file);}}
\DoxyCodeLine{02024\ \textcolor{comment}{//\ \ \ \ \ \ return\ fwrite((void*)\&a\_value,\ sizeof(a\_value),\ 1,\ m\_file);}}
\DoxyCodeLine{02025\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02026\ \textcolor{comment}{//}}
\DoxyCodeLine{02027\ \textcolor{comment}{//\ \ template<\ typename\ TYPE\ >}}
\DoxyCodeLine{02028\ \textcolor{comment}{//\ \ size\_t\ WriteArray(const\ TYPE*\ a\_array,\ int\ a\_count)\ \{}}
\DoxyCodeLine{02029\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(m\_file);}}
\DoxyCodeLine{02030\ \textcolor{comment}{//\ \ \ \ \ \ return\ fwrite((void*)a\_array,\ sizeof(TYPE)\ *\ a\_count,\ 1,\ m\_file);}}
\DoxyCodeLine{02031\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02032\ \textcolor{comment}{//}}
\DoxyCodeLine{02033\ \textcolor{comment}{//\ \ template<\ typename\ TYPE\ >}}
\DoxyCodeLine{02034\ \textcolor{comment}{//\ \ size\_t\ Read(TYPE\&\ a\_value)\ \{}}
\DoxyCodeLine{02035\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(m\_file);}}
\DoxyCodeLine{02036\ \textcolor{comment}{//\ \ \ \ \ \ return\ fread((void*)\&a\_value,\ sizeof(a\_value),\ 1,\ m\_file);}}
\DoxyCodeLine{02037\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02038\ \textcolor{comment}{//}}
\DoxyCodeLine{02039\ \textcolor{comment}{//\ \ template<\ typename\ TYPE\ >}}
\DoxyCodeLine{02040\ \textcolor{comment}{//\ \ size\_t\ ReadArray(TYPE*\ a\_array,\ int\ a\_count)\ \{}}
\DoxyCodeLine{02041\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(m\_file);}}
\DoxyCodeLine{02042\ \textcolor{comment}{//\ \ \ \ \ \ return\ fread((void*)a\_array,\ sizeof(TYPE)\ *\ a\_count,\ 1,\ m\_file);}}
\DoxyCodeLine{02043\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02044\ \textcolor{comment}{//\ \};}}
\DoxyCodeLine{02045\ \textcolor{comment}{//}}
\DoxyCodeLine{02046\ \textcolor{comment}{//}}
\DoxyCodeLine{02047\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02048\ \textcolor{comment}{//\ RTREE\_QUAL::RTree()\ \{}}
\DoxyCodeLine{02049\ \textcolor{comment}{//\ \ ASSERT(MAXNODES\ >\ MINNODES);}}
\DoxyCodeLine{02050\ \textcolor{comment}{//\ \ ASSERT(MINNODES\ >\ 0);}}
\DoxyCodeLine{02051\ \textcolor{comment}{//}}
\DoxyCodeLine{02052\ \textcolor{comment}{//\ \ //\ Precomputed\ volumes\ of\ the\ unit\ spheres\ for\ the\ first\ few\ dimensions}}
\DoxyCodeLine{02053\ \textcolor{comment}{//\ \ const\ float\ UNIT\_SPHERE\_VOLUMES[]\ =\ \{}}
\DoxyCodeLine{02054\ \textcolor{comment}{//\ \ \ \ 0.000000f,\ 2.000000f,\ 3.141593f,\ //\ Dimension\ \ 0,1,2}}
\DoxyCodeLine{02055\ \textcolor{comment}{//\ \ \ \ 4.188790f,\ 4.934802f,\ 5.263789f,\ //\ Dimension\ \ 3,4,5}}
\DoxyCodeLine{02056\ \textcolor{comment}{//\ \ \ \ 5.167713f,\ 4.724766f,\ 4.058712f,\ //\ Dimension\ \ 6,7,8}}
\DoxyCodeLine{02057\ \textcolor{comment}{//\ \ \ \ 3.298509f,\ 2.550164f,\ 1.884104f,\ //\ Dimension\ \ 9,10,11}}
\DoxyCodeLine{02058\ \textcolor{comment}{//\ \ \ \ 1.335263f,\ 0.910629f,\ 0.599265f,\ //\ Dimension\ \ 12,13,14}}
\DoxyCodeLine{02059\ \textcolor{comment}{//\ \ \ \ 0.381443f,\ 0.235331f,\ 0.140981f,\ //\ Dimension\ \ 15,16,17}}
\DoxyCodeLine{02060\ \textcolor{comment}{//\ \ \ \ 0.082146f,\ 0.046622f,\ 0.025807f,\ //\ Dimension\ \ 18,19,20}}
\DoxyCodeLine{02061\ \textcolor{comment}{//\ \ \};}}
\DoxyCodeLine{02062\ \textcolor{comment}{//}}
\DoxyCodeLine{02063\ \textcolor{comment}{//\ \ m\_root\ =\ AllocNode();}}
\DoxyCodeLine{02064\ \textcolor{comment}{//\ \ m\_root-\/>m\_level\ =\ 0;}}
\DoxyCodeLine{02065\ \textcolor{comment}{//\ \ m\_unitSphereVolume\ =\ (ELEMTYPEREAL)UNIT\_SPHERE\_VOLUMES[NUMDIMS];}}
\DoxyCodeLine{02066\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02067\ \textcolor{comment}{//}}
\DoxyCodeLine{02068\ \textcolor{comment}{//}}
\DoxyCodeLine{02069\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02070\ \textcolor{comment}{//\ RTREE\_QUAL::RTree(const\ RTree\&\ other)\ :\ RTree()\ \{}}
\DoxyCodeLine{02071\ \textcolor{comment}{//\ \ CopyRec(m\_root,\ other.m\_root);}}
\DoxyCodeLine{02072\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02073\ \textcolor{comment}{//}}
\DoxyCodeLine{02074\ \textcolor{comment}{//}}
\DoxyCodeLine{02075\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02076\ \textcolor{comment}{//\ RTREE\_QUAL::\string~RTree()\ \{}}
\DoxyCodeLine{02077\ \textcolor{comment}{//\ \ Reset();\ //\ Free,\ or\ reset\ node\ memory}}
\DoxyCodeLine{02078\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02079\ \textcolor{comment}{//}}
\DoxyCodeLine{02080\ \textcolor{comment}{//}}
\DoxyCodeLine{02081\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02082\ \textcolor{comment}{//\ void\ RTREE\_QUAL::Insert(const\ ELEMTYPE\ a\_min[NUMDIMS],\ const\ ELEMTYPE\ a\_max[NUMDIMS],\ const\ DATATYPE\&\ a\_dataId)\ \{}}
\DoxyCodeLine{02083\ \textcolor{comment}{//\#ifdef\ \_DEBUG}}
\DoxyCodeLine{02084\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02085\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(a\_min[index]\ <=\ a\_max[index]);}}
\DoxyCodeLine{02086\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02087\ \textcolor{comment}{//\#endif\ //\_DEBUG}}
\DoxyCodeLine{02088\ \textcolor{comment}{//}}
\DoxyCodeLine{02089\ \textcolor{comment}{//\ \ Branch\ branch;}}
\DoxyCodeLine{02090\ \textcolor{comment}{//\ \ branch.m\_data\ =\ a\_dataId;}}
\DoxyCodeLine{02091\ \textcolor{comment}{//\ \ branch.m\_child\ =\ NULL;}}
\DoxyCodeLine{02092\ \textcolor{comment}{//}}
\DoxyCodeLine{02093\ \textcolor{comment}{//\ \ for\ (int\ axis\ =\ 0;\ axis\ <\ NUMDIMS;\ ++axis)\ \{}}
\DoxyCodeLine{02094\ \textcolor{comment}{//\ \ \ \ \ \ branch.m\_rect.m\_min[axis]\ =\ a\_min[axis];}}
\DoxyCodeLine{02095\ \textcolor{comment}{//\ \ \ \ \ \ branch.m\_rect.m\_max[axis]\ =\ a\_max[axis];}}
\DoxyCodeLine{02096\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02097\ \textcolor{comment}{//}}
\DoxyCodeLine{02098\ \textcolor{comment}{//\ \ InsertRect(branch,\ \&m\_root,\ 0);}}
\DoxyCodeLine{02099\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02100\ \textcolor{comment}{//}}
\DoxyCodeLine{02101\ \textcolor{comment}{//}}
\DoxyCodeLine{02102\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02103\ \textcolor{comment}{//\ void\ RTREE\_QUAL::Remove(const\ ELEMTYPE\ a\_min[NUMDIMS],\ const\ ELEMTYPE\ a\_max[NUMDIMS],\ const\ DATATYPE\&\ a\_dataId)\ \{}}
\DoxyCodeLine{02104\ \textcolor{comment}{//\#ifdef\ \_DEBUG}}
\DoxyCodeLine{02105\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02106\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(a\_min[index]\ <=\ a\_max[index]);}}
\DoxyCodeLine{02107\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02108\ \textcolor{comment}{//\#endif\ //\_DEBUG}}
\DoxyCodeLine{02109\ \textcolor{comment}{//}}
\DoxyCodeLine{02110\ \textcolor{comment}{//\ \ Rect\ rect;}}
\DoxyCodeLine{02111\ \textcolor{comment}{//}}
\DoxyCodeLine{02112\ \textcolor{comment}{//\ \ for\ (int\ axis\ =\ 0;\ axis\ <\ NUMDIMS;\ ++axis)\ \{}}
\DoxyCodeLine{02113\ \textcolor{comment}{//\ \ \ \ \ \ rect.m\_min[axis]\ =\ a\_min[axis];}}
\DoxyCodeLine{02114\ \textcolor{comment}{//\ \ \ \ \ \ rect.m\_max[axis]\ =\ a\_max[axis];}}
\DoxyCodeLine{02115\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02116\ \textcolor{comment}{//}}
\DoxyCodeLine{02117\ \textcolor{comment}{//\ \ RemoveRect(\&rect,\ a\_dataId,\ \&m\_root);}}
\DoxyCodeLine{02118\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02119\ \textcolor{comment}{//}}
\DoxyCodeLine{02120\ \textcolor{comment}{//}}
\DoxyCodeLine{02121\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02122\ \textcolor{comment}{//\ int\ RTREE\_QUAL::Search(const\ ELEMTYPE\ a\_min[NUMDIMS],\ const\ ELEMTYPE\ a\_max[NUMDIMS],\ std::function<bool(const\ DATATYPE\&)>\ callback)\ const\ \{}}
\DoxyCodeLine{02123\ \textcolor{comment}{//\#ifdef\ \_DEBUG}}
\DoxyCodeLine{02124\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02125\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(a\_min[index]\ <=\ a\_max[index]);}}
\DoxyCodeLine{02126\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02127\ \textcolor{comment}{//\#endif\ //\_DEBUG}}
\DoxyCodeLine{02128\ \textcolor{comment}{//}}
\DoxyCodeLine{02129\ \textcolor{comment}{//\ \ Rect\ rect;}}
\DoxyCodeLine{02130\ \textcolor{comment}{//}}
\DoxyCodeLine{02131\ \textcolor{comment}{//\ \ for\ (int\ axis\ =\ 0;\ axis\ <\ NUMDIMS;\ ++axis)\ \{}}
\DoxyCodeLine{02132\ \textcolor{comment}{//\ \ \ \ \ \ rect.m\_min[axis]\ =\ a\_min[axis];}}
\DoxyCodeLine{02133\ \textcolor{comment}{//\ \ \ \ \ \ rect.m\_max[axis]\ =\ a\_max[axis];}}
\DoxyCodeLine{02134\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02135\ \textcolor{comment}{//}}
\DoxyCodeLine{02136\ \textcolor{comment}{//\ \ //\ NOTE:\ May\ want\ to\ return\ search\ result\ another\ way,\ perhaps\ returning\ the\ number\ of\ found\ elements\ here.}}
\DoxyCodeLine{02137\ \textcolor{comment}{//}}
\DoxyCodeLine{02138\ \textcolor{comment}{//\ \ int\ foundCount\ =\ 0;}}
\DoxyCodeLine{02139\ \textcolor{comment}{//\ \ Search(m\_root,\ \&rect,\ foundCount,\ callback);}}
\DoxyCodeLine{02140\ \textcolor{comment}{//}}
\DoxyCodeLine{02141\ \textcolor{comment}{//\ \ return\ foundCount;}}
\DoxyCodeLine{02142\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02143\ \textcolor{comment}{//}}
\DoxyCodeLine{02144\ \textcolor{comment}{//}}
\DoxyCodeLine{02145\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02146\ \textcolor{comment}{//\ int\ RTREE\_QUAL::Count()\ \{}}
\DoxyCodeLine{02147\ \textcolor{comment}{//\ \ int\ count\ =\ 0;}}
\DoxyCodeLine{02148\ \textcolor{comment}{//\ \ CountRec(m\_root,\ count);}}
\DoxyCodeLine{02149\ \textcolor{comment}{//}}
\DoxyCodeLine{02150\ \textcolor{comment}{//\ \ return\ count;}}
\DoxyCodeLine{02151\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02152\ \textcolor{comment}{//}}
\DoxyCodeLine{02153\ \textcolor{comment}{//}}
\DoxyCodeLine{02154\ \textcolor{comment}{//}}
\DoxyCodeLine{02155\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02156\ \textcolor{comment}{//\ void\ RTREE\_QUAL::CountRec(Node*\ a\_node,\ int\&\ a\_count)\ \{}}
\DoxyCodeLine{02157\ \textcolor{comment}{//\ \ if\ (a\_node-\/>IsInternalNode())\ \ //\ not\ a\ leaf\ node}}
\DoxyCodeLine{02158\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02159\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02160\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ CountRec(a\_node-\/>m\_branch[index].m\_child,\ a\_count);}}
\DoxyCodeLine{02161\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02162\ \textcolor{comment}{//\ \ \}\ else\ //\ A\ leaf\ node}}
\DoxyCodeLine{02163\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02164\ \textcolor{comment}{//\ \ \ \ \ \ a\_count\ +=\ a\_node-\/>m\_count;}}
\DoxyCodeLine{02165\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02166\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02167\ \textcolor{comment}{//}}
\DoxyCodeLine{02168\ \textcolor{comment}{//}}
\DoxyCodeLine{02169\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02170\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::Load(const\ char*\ a\_fileName)\ \{}}
\DoxyCodeLine{02171\ \textcolor{comment}{//\ \ RemoveAll();\ //\ Clear\ existing\ tree}}
\DoxyCodeLine{02172\ \textcolor{comment}{//}}
\DoxyCodeLine{02173\ \textcolor{comment}{//\ \ RTFileStream\ stream;}}
\DoxyCodeLine{02174\ \textcolor{comment}{//\ \ if\ (!stream.OpenRead(a\_fileName))\ \{}}
\DoxyCodeLine{02175\ \textcolor{comment}{//\ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{02176\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02177\ \textcolor{comment}{//}}
\DoxyCodeLine{02178\ \textcolor{comment}{//\ \ bool\ result\ =\ Load(stream);}}
\DoxyCodeLine{02179\ \textcolor{comment}{//}}
\DoxyCodeLine{02180\ \textcolor{comment}{//\ \ stream.Close();}}
\DoxyCodeLine{02181\ \textcolor{comment}{//}}
\DoxyCodeLine{02182\ \textcolor{comment}{//\ \ return\ result;}}
\DoxyCodeLine{02183\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02184\ \textcolor{comment}{//}}
\DoxyCodeLine{02185\ \textcolor{comment}{//}}
\DoxyCodeLine{02186\ \textcolor{comment}{//}}
\DoxyCodeLine{02187\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02188\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::Load(RTFileStream\&\ a\_stream)\ \{}}
\DoxyCodeLine{02189\ \textcolor{comment}{//\ \ //\ Write\ some\ kind\ of\ header}}
\DoxyCodeLine{02190\ \textcolor{comment}{//\ \ int\ \_dataFileId\ =\ ('R'\ <<\ 0)\ |\ ('T'\ <<\ 8)\ |\ ('R'\ <<\ 16)\ |\ ('E'\ <<\ 24);}}
\DoxyCodeLine{02191\ \textcolor{comment}{//\ \ int\ \_dataSize\ =\ sizeof(DATATYPE);}}
\DoxyCodeLine{02192\ \textcolor{comment}{//\ \ int\ \_dataNumDims\ =\ NUMDIMS;}}
\DoxyCodeLine{02193\ \textcolor{comment}{//\ \ int\ \_dataElemSize\ =\ sizeof(ELEMTYPE);}}
\DoxyCodeLine{02194\ \textcolor{comment}{//\ \ int\ \_dataElemRealSize\ =\ sizeof(ELEMTYPEREAL);}}
\DoxyCodeLine{02195\ \textcolor{comment}{//\ \ int\ \_dataMaxNodes\ =\ TMAXNODES;}}
\DoxyCodeLine{02196\ \textcolor{comment}{//\ \ int\ \_dataMinNodes\ =\ TMINNODES;}}
\DoxyCodeLine{02197\ \textcolor{comment}{//}}
\DoxyCodeLine{02198\ \textcolor{comment}{//\ \ int\ dataFileId\ =\ 0;}}
\DoxyCodeLine{02199\ \textcolor{comment}{//\ \ int\ dataSize\ =\ 0;}}
\DoxyCodeLine{02200\ \textcolor{comment}{//\ \ int\ dataNumDims\ =\ 0;}}
\DoxyCodeLine{02201\ \textcolor{comment}{//\ \ int\ dataElemSize\ =\ 0;}}
\DoxyCodeLine{02202\ \textcolor{comment}{//\ \ int\ dataElemRealSize\ =\ 0;}}
\DoxyCodeLine{02203\ \textcolor{comment}{//\ \ int\ dataMaxNodes\ =\ 0;}}
\DoxyCodeLine{02204\ \textcolor{comment}{//\ \ int\ dataMinNodes\ =\ 0;}}
\DoxyCodeLine{02205\ \textcolor{comment}{//}}
\DoxyCodeLine{02206\ \textcolor{comment}{//\ \ a\_stream.Read(dataFileId);}}
\DoxyCodeLine{02207\ \textcolor{comment}{//\ \ a\_stream.Read(dataSize);}}
\DoxyCodeLine{02208\ \textcolor{comment}{//\ \ a\_stream.Read(dataNumDims);}}
\DoxyCodeLine{02209\ \textcolor{comment}{//\ \ a\_stream.Read(dataElemSize);}}
\DoxyCodeLine{02210\ \textcolor{comment}{//\ \ a\_stream.Read(dataElemRealSize);}}
\DoxyCodeLine{02211\ \textcolor{comment}{//\ \ a\_stream.Read(dataMaxNodes);}}
\DoxyCodeLine{02212\ \textcolor{comment}{//\ \ a\_stream.Read(dataMinNodes);}}
\DoxyCodeLine{02213\ \textcolor{comment}{//}}
\DoxyCodeLine{02214\ \textcolor{comment}{//\ \ bool\ result\ =\ false;}}
\DoxyCodeLine{02215\ \textcolor{comment}{//}}
\DoxyCodeLine{02216\ \textcolor{comment}{//\ \ //\ Test\ if\ header\ was\ valid\ and\ compatible}}
\DoxyCodeLine{02217\ \textcolor{comment}{//\ \ if\ ((dataFileId\ ==\ \_dataFileId)}}
\DoxyCodeLine{02218\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (dataSize\ ==\ \_dataSize)}}
\DoxyCodeLine{02219\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (dataNumDims\ ==\ \_dataNumDims)}}
\DoxyCodeLine{02220\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (dataElemSize\ ==\ \_dataElemSize)}}
\DoxyCodeLine{02221\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (dataElemRealSize\ ==\ \_dataElemRealSize)}}
\DoxyCodeLine{02222\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (dataMaxNodes\ ==\ \_dataMaxNodes)}}
\DoxyCodeLine{02223\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (dataMinNodes\ ==\ \_dataMinNodes)}}
\DoxyCodeLine{02224\ \textcolor{comment}{//\ \ \ \ \ \ )\ \{}}
\DoxyCodeLine{02225\ \textcolor{comment}{//\ \ \ \ \ \ //\ Recursively\ load\ tree}}
\DoxyCodeLine{02226\ \textcolor{comment}{//\ \ \ \ \ \ result\ =\ LoadRec(m\_root,\ a\_stream);}}
\DoxyCodeLine{02227\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02228\ \textcolor{comment}{//}}
\DoxyCodeLine{02229\ \textcolor{comment}{//\ \ return\ result;}}
\DoxyCodeLine{02230\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02231\ \textcolor{comment}{//}}
\DoxyCodeLine{02232\ \textcolor{comment}{//}}
\DoxyCodeLine{02233\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02234\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::LoadRec(Node*\ a\_node,\ RTFileStream\&\ a\_stream)\ \{}}
\DoxyCodeLine{02235\ \textcolor{comment}{//\ \ a\_stream.Read(a\_node-\/>m\_level);}}
\DoxyCodeLine{02236\ \textcolor{comment}{//\ \ a\_stream.Read(a\_node-\/>m\_count);}}
\DoxyCodeLine{02237\ \textcolor{comment}{//}}
\DoxyCodeLine{02238\ \textcolor{comment}{//\ \ if\ (a\_node-\/>IsInternalNode())\ \ //\ not\ a\ leaf\ node}}
\DoxyCodeLine{02239\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02240\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02241\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ curBranch\ =\ \&a\_node-\/>m\_branch[index];}}
\DoxyCodeLine{02242\ \textcolor{comment}{//}}
\DoxyCodeLine{02243\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}}
\DoxyCodeLine{02244\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}}
\DoxyCodeLine{02245\ \textcolor{comment}{//}}
\DoxyCodeLine{02246\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ curBranch-\/>m\_child\ =\ AllocNode();}}
\DoxyCodeLine{02247\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ LoadRec(curBranch-\/>m\_child,\ a\_stream);}}
\DoxyCodeLine{02248\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02249\ \textcolor{comment}{//\ \ \}\ else\ //\ A\ leaf\ node}}
\DoxyCodeLine{02250\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02251\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02252\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ curBranch\ =\ \&a\_node-\/>m\_branch[index];}}
\DoxyCodeLine{02253\ \textcolor{comment}{//}}
\DoxyCodeLine{02254\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}}
\DoxyCodeLine{02255\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.ReadArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}}
\DoxyCodeLine{02256\ \textcolor{comment}{//}}
\DoxyCodeLine{02257\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.Read(curBranch-\/>m\_data);}}
\DoxyCodeLine{02258\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02259\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02260\ \textcolor{comment}{//}}
\DoxyCodeLine{02261\ \textcolor{comment}{//\ \ return\ true;\ //\ Should\ do\ more\ error\ checking\ on\ I/O\ operations}}
\DoxyCodeLine{02262\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02263\ \textcolor{comment}{//}}
\DoxyCodeLine{02264\ \textcolor{comment}{//}}
\DoxyCodeLine{02265\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02266\ \textcolor{comment}{//\ void\ RTREE\_QUAL::CopyRec(Node*\ current,\ Node*\ other)\ \{}}
\DoxyCodeLine{02267\ \textcolor{comment}{//\ \ current-\/>m\_level\ =\ other-\/>m\_level;}}
\DoxyCodeLine{02268\ \textcolor{comment}{//\ \ current-\/>m\_count\ =\ other-\/>m\_count;}}
\DoxyCodeLine{02269\ \textcolor{comment}{//}}
\DoxyCodeLine{02270\ \textcolor{comment}{//\ \ if\ (current-\/>IsInternalNode())\ \ //\ not\ a\ leaf\ node}}
\DoxyCodeLine{02271\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02272\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ current-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02273\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ currentBranch\ =\ \&current-\/>m\_branch[index];}}
\DoxyCodeLine{02274\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ otherBranch\ =\ \&other-\/>m\_branch[index];}}
\DoxyCodeLine{02275\ \textcolor{comment}{//}}
\DoxyCodeLine{02276\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_min,}}
\DoxyCodeLine{02277\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_min\ +\ NUMDIMS,}}
\DoxyCodeLine{02278\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_min);}}
\DoxyCodeLine{02279\ \textcolor{comment}{//}}
\DoxyCodeLine{02280\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_max,}}
\DoxyCodeLine{02281\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_max\ +\ NUMDIMS,}}
\DoxyCodeLine{02282\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_max);}}
\DoxyCodeLine{02283\ \textcolor{comment}{//}}
\DoxyCodeLine{02284\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_child\ =\ AllocNode();}}
\DoxyCodeLine{02285\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ CopyRec(currentBranch-\/>m\_child,\ otherBranch-\/>m\_child);}}
\DoxyCodeLine{02286\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02287\ \textcolor{comment}{//\ \ \}\ else\ //\ A\ leaf\ node}}
\DoxyCodeLine{02288\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02289\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ current-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02290\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ currentBranch\ =\ \&current-\/>m\_branch[index];}}
\DoxyCodeLine{02291\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ otherBranch\ =\ \&other-\/>m\_branch[index];}}
\DoxyCodeLine{02292\ \textcolor{comment}{//}}
\DoxyCodeLine{02293\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_min,}}
\DoxyCodeLine{02294\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_min\ +\ NUMDIMS,}}
\DoxyCodeLine{02295\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_min);}}
\DoxyCodeLine{02296\ \textcolor{comment}{//}}
\DoxyCodeLine{02297\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ std::copy(otherBranch-\/>m\_rect.m\_max,}}
\DoxyCodeLine{02298\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ otherBranch-\/>m\_rect.m\_max\ +\ NUMDIMS,}}
\DoxyCodeLine{02299\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_rect.m\_max);}}
\DoxyCodeLine{02300\ \textcolor{comment}{//}}
\DoxyCodeLine{02301\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ currentBranch-\/>m\_data\ =\ otherBranch-\/>m\_data;}}
\DoxyCodeLine{02302\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02303\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02304\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02305\ \textcolor{comment}{//}}
\DoxyCodeLine{02306\ \textcolor{comment}{//}}
\DoxyCodeLine{02307\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02308\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::Save(const\ char*\ a\_fileName)\ \{}}
\DoxyCodeLine{02309\ \textcolor{comment}{//\ \ RTFileStream\ stream;}}
\DoxyCodeLine{02310\ \textcolor{comment}{//\ \ if\ (!stream.OpenWrite(a\_fileName))\ \{}}
\DoxyCodeLine{02311\ \textcolor{comment}{//\ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{02312\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02313\ \textcolor{comment}{//}}
\DoxyCodeLine{02314\ \textcolor{comment}{//\ \ bool\ result\ =\ Save(stream);}}
\DoxyCodeLine{02315\ \textcolor{comment}{//}}
\DoxyCodeLine{02316\ \textcolor{comment}{//\ \ stream.Close();}}
\DoxyCodeLine{02317\ \textcolor{comment}{//}}
\DoxyCodeLine{02318\ \textcolor{comment}{//\ \ return\ result;}}
\DoxyCodeLine{02319\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02320\ \textcolor{comment}{//}}
\DoxyCodeLine{02321\ \textcolor{comment}{//}}
\DoxyCodeLine{02322\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02323\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::Save(RTFileStream\&\ a\_stream)\ \{}}
\DoxyCodeLine{02324\ \textcolor{comment}{//\ \ //\ Write\ some\ kind\ of\ header}}
\DoxyCodeLine{02325\ \textcolor{comment}{//\ \ int\ dataFileId\ =\ ('R'\ <<\ 0)\ |\ ('T'\ <<\ 8)\ |\ ('R'\ <<\ 16)\ |\ ('E'\ <<\ 24);}}
\DoxyCodeLine{02326\ \textcolor{comment}{//\ \ int\ dataSize\ =\ sizeof(DATATYPE);}}
\DoxyCodeLine{02327\ \textcolor{comment}{//\ \ int\ dataNumDims\ =\ NUMDIMS;}}
\DoxyCodeLine{02328\ \textcolor{comment}{//\ \ int\ dataElemSize\ =\ sizeof(ELEMTYPE);}}
\DoxyCodeLine{02329\ \textcolor{comment}{//\ \ int\ dataElemRealSize\ =\ sizeof(ELEMTYPEREAL);}}
\DoxyCodeLine{02330\ \textcolor{comment}{//\ \ int\ dataMaxNodes\ =\ TMAXNODES;}}
\DoxyCodeLine{02331\ \textcolor{comment}{//\ \ int\ dataMinNodes\ =\ TMINNODES;}}
\DoxyCodeLine{02332\ \textcolor{comment}{//}}
\DoxyCodeLine{02333\ \textcolor{comment}{//\ \ a\_stream.Write(dataFileId);}}
\DoxyCodeLine{02334\ \textcolor{comment}{//\ \ a\_stream.Write(dataSize);}}
\DoxyCodeLine{02335\ \textcolor{comment}{//\ \ a\_stream.Write(dataNumDims);}}
\DoxyCodeLine{02336\ \textcolor{comment}{//\ \ a\_stream.Write(dataElemSize);}}
\DoxyCodeLine{02337\ \textcolor{comment}{//\ \ a\_stream.Write(dataElemRealSize);}}
\DoxyCodeLine{02338\ \textcolor{comment}{//\ \ a\_stream.Write(dataMaxNodes);}}
\DoxyCodeLine{02339\ \textcolor{comment}{//\ \ a\_stream.Write(dataMinNodes);}}
\DoxyCodeLine{02340\ \textcolor{comment}{//}}
\DoxyCodeLine{02341\ \textcolor{comment}{//\ \ //\ Recursively\ save\ tree}}
\DoxyCodeLine{02342\ \textcolor{comment}{//\ \ bool\ result\ =\ SaveRec(m\_root,\ a\_stream);}}
\DoxyCodeLine{02343\ \textcolor{comment}{//}}
\DoxyCodeLine{02344\ \textcolor{comment}{//\ \ return\ result;}}
\DoxyCodeLine{02345\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02346\ \textcolor{comment}{//}}
\DoxyCodeLine{02347\ \textcolor{comment}{//}}
\DoxyCodeLine{02348\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02349\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::SaveRec(Node*\ a\_node,\ RTFileStream\&\ a\_stream)\ \{}}
\DoxyCodeLine{02350\ \textcolor{comment}{//\ \ a\_stream.Write(a\_node-\/>m\_level);}}
\DoxyCodeLine{02351\ \textcolor{comment}{//\ \ a\_stream.Write(a\_node-\/>m\_count);}}
\DoxyCodeLine{02352\ \textcolor{comment}{//}}
\DoxyCodeLine{02353\ \textcolor{comment}{//\ \ if\ (a\_node-\/>IsInternalNode())\ \ //\ not\ a\ leaf\ node}}
\DoxyCodeLine{02354\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02355\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02356\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ curBranch\ =\ \&a\_node-\/>m\_branch[index];}}
\DoxyCodeLine{02357\ \textcolor{comment}{//}}
\DoxyCodeLine{02358\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}}
\DoxyCodeLine{02359\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}}
\DoxyCodeLine{02360\ \textcolor{comment}{//}}
\DoxyCodeLine{02361\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ SaveRec(curBranch-\/>m\_child,\ a\_stream);}}
\DoxyCodeLine{02362\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02363\ \textcolor{comment}{//\ \ \}\ else\ //\ A\ leaf\ node}}
\DoxyCodeLine{02364\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02365\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02366\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch*\ curBranch\ =\ \&a\_node-\/>m\_branch[index];}}
\DoxyCodeLine{02367\ \textcolor{comment}{//}}
\DoxyCodeLine{02368\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_min,\ NUMDIMS);}}
\DoxyCodeLine{02369\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.WriteArray(curBranch-\/>m\_rect.m\_max,\ NUMDIMS);}}
\DoxyCodeLine{02370\ \textcolor{comment}{//}}
\DoxyCodeLine{02371\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_stream.Write(curBranch-\/>m\_data);}}
\DoxyCodeLine{02372\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02373\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02374\ \textcolor{comment}{//}}
\DoxyCodeLine{02375\ \textcolor{comment}{//\ \ return\ true;\ //\ Should\ do\ more\ error\ checking\ on\ I/O\ operations}}
\DoxyCodeLine{02376\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02377\ \textcolor{comment}{//}}
\DoxyCodeLine{02378\ \textcolor{comment}{//}}
\DoxyCodeLine{02379\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02380\ \textcolor{comment}{//\ void\ RTREE\_QUAL::RemoveAll()\ \{}}
\DoxyCodeLine{02381\ \textcolor{comment}{//\ \ //\ Delete\ all\ existing\ nodes}}
\DoxyCodeLine{02382\ \textcolor{comment}{//\ \ Reset();}}
\DoxyCodeLine{02383\ \textcolor{comment}{//}}
\DoxyCodeLine{02384\ \textcolor{comment}{//\ \ m\_root\ =\ AllocNode();}}
\DoxyCodeLine{02385\ \textcolor{comment}{//\ \ m\_root-\/>m\_level\ =\ 0;}}
\DoxyCodeLine{02386\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02387\ \textcolor{comment}{//}}
\DoxyCodeLine{02388\ \textcolor{comment}{//}}
\DoxyCodeLine{02389\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02390\ \textcolor{comment}{//\ void\ RTREE\_QUAL::Reset()\ \{}}
\DoxyCodeLine{02391\ \textcolor{comment}{//\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02392\ \textcolor{comment}{//\ \ //\ Delete\ all\ existing\ nodes}}
\DoxyCodeLine{02393\ \textcolor{comment}{//\ \ RemoveAllRec(m\_root);}}
\DoxyCodeLine{02394\ \textcolor{comment}{//\#else\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02395\ \textcolor{comment}{//\ \ //\ Just\ reset\ memory\ pools.\ \ We\ are\ not\ using\ complex\ types}}
\DoxyCodeLine{02396\ \textcolor{comment}{//\ \ //\ EXAMPLE}}
\DoxyCodeLine{02397\ \textcolor{comment}{//\#endif\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02398\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02399\ \textcolor{comment}{//}}
\DoxyCodeLine{02400\ \textcolor{comment}{//}}
\DoxyCodeLine{02401\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02402\ \textcolor{comment}{//\ void\ RTREE\_QUAL::RemoveAllRec(Node*\ a\_node)\ \{}}
\DoxyCodeLine{02403\ \textcolor{comment}{//\ \ ASSERT(a\_node);}}
\DoxyCodeLine{02404\ \textcolor{comment}{//\ \ ASSERT(a\_node-\/>m\_level\ >=\ 0);}}
\DoxyCodeLine{02405\ \textcolor{comment}{//}}
\DoxyCodeLine{02406\ \textcolor{comment}{//\ \ if\ (a\_node-\/>IsInternalNode())\ //\ This\ is\ an\ internal\ node\ in\ the\ tree}}
\DoxyCodeLine{02407\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02408\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02409\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ RemoveAllRec(a\_node-\/>m\_branch[index].m\_child);}}
\DoxyCodeLine{02410\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02411\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02412\ \textcolor{comment}{//\ \ FreeNode(a\_node);}}
\DoxyCodeLine{02413\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02414\ \textcolor{comment}{//}}
\DoxyCodeLine{02415\ \textcolor{comment}{//}}
\DoxyCodeLine{02416\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02417\ \textcolor{comment}{//\ typename\ RTREE\_QUAL::Node*\ RTREE\_QUAL::AllocNode()\ \{}}
\DoxyCodeLine{02418\ \textcolor{comment}{//\ \ Node*\ newNode;}}
\DoxyCodeLine{02419\ \textcolor{comment}{//\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02420\ \textcolor{comment}{//\ \ newNode\ =\ new\ Node;}}
\DoxyCodeLine{02421\ \textcolor{comment}{//\#else\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02422\ \textcolor{comment}{//\ \ //\ EXAMPLE}}
\DoxyCodeLine{02423\ \textcolor{comment}{//\#endif\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02424\ \textcolor{comment}{//\ \ InitNode(newNode);}}
\DoxyCodeLine{02425\ \textcolor{comment}{//\ \ return\ newNode;}}
\DoxyCodeLine{02426\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02427\ \textcolor{comment}{//}}
\DoxyCodeLine{02428\ \textcolor{comment}{//}}
\DoxyCodeLine{02429\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02430\ \textcolor{comment}{//\ void\ RTREE\_QUAL::FreeNode(Node*\ a\_node)\ \{}}
\DoxyCodeLine{02431\ \textcolor{comment}{//\ \ ASSERT(a\_node);}}
\DoxyCodeLine{02432\ \textcolor{comment}{//}}
\DoxyCodeLine{02433\ \textcolor{comment}{//\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02434\ \textcolor{comment}{//\ \ delete\ a\_node;}}
\DoxyCodeLine{02435\ \textcolor{comment}{//\#else\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02436\ \textcolor{comment}{//\ \ //\ EXAMPLE}}
\DoxyCodeLine{02437\ \textcolor{comment}{//\#endif\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02438\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02439\ \textcolor{comment}{//}}
\DoxyCodeLine{02440\ \textcolor{comment}{//}}
\DoxyCodeLine{02443\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02444\ \textcolor{comment}{//\ typename\ RTREE\_QUAL::ListNode*\ RTREE\_QUAL::AllocListNode()\ \{}}
\DoxyCodeLine{02445\ \textcolor{comment}{//\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02446\ \textcolor{comment}{//\ \ return\ new\ ListNode;}}
\DoxyCodeLine{02447\ \textcolor{comment}{//\#else\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02448\ \textcolor{comment}{//\ \ //\ EXAMPLE}}
\DoxyCodeLine{02449\ \textcolor{comment}{//\#endif\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02450\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02451\ \textcolor{comment}{//}}
\DoxyCodeLine{02452\ \textcolor{comment}{//}}
\DoxyCodeLine{02453\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02454\ \textcolor{comment}{//\ void\ RTREE\_QUAL::FreeListNode(ListNode*\ a\_listNode)\ \{}}
\DoxyCodeLine{02455\ \textcolor{comment}{//\#ifdef\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02456\ \textcolor{comment}{//\ \ delete\ a\_listNode;}}
\DoxyCodeLine{02457\ \textcolor{comment}{//\#else\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02458\ \textcolor{comment}{//\ \ //\ EXAMPLE}}
\DoxyCodeLine{02459\ \textcolor{comment}{//\#endif\ //\ RTREE\_DONT\_USE\_MEMPOOLS}}
\DoxyCodeLine{02460\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02461\ \textcolor{comment}{//}}
\DoxyCodeLine{02462\ \textcolor{comment}{//}}
\DoxyCodeLine{02463\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02464\ \textcolor{comment}{//\ void\ RTREE\_QUAL::InitNode(Node*\ a\_node)\ \{}}
\DoxyCodeLine{02465\ \textcolor{comment}{//\ \ a\_node-\/>m\_count\ =\ 0;}}
\DoxyCodeLine{02466\ \textcolor{comment}{//\ \ a\_node-\/>m\_level\ =\ -\/1;}}
\DoxyCodeLine{02467\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02468\ \textcolor{comment}{//}}
\DoxyCodeLine{02469\ \textcolor{comment}{//}}
\DoxyCodeLine{02470\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02471\ \textcolor{comment}{//\ void\ RTREE\_QUAL::InitRect(Rect*\ a\_rect)\ \{}}
\DoxyCodeLine{02472\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02473\ \textcolor{comment}{//\ \ \ \ \ \ a\_rect-\/>m\_min[index]\ =\ (ELEMTYPE)0;}}
\DoxyCodeLine{02474\ \textcolor{comment}{//\ \ \ \ \ \ a\_rect-\/>m\_max[index]\ =\ (ELEMTYPE)0;}}
\DoxyCodeLine{02475\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02476\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02477\ \textcolor{comment}{//}}
\DoxyCodeLine{02478\ \textcolor{comment}{//}}
\DoxyCodeLine{02486\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02487\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::InsertRectRec(const\ Branch\&\ a\_branch,\ Node*\ a\_node,\ Node**\ a\_newNode,\ int\ a\_level)\ \{}}
\DoxyCodeLine{02488\ \textcolor{comment}{//\ \ ASSERT(a\_node\ \&\&\ a\_newNode);}}
\DoxyCodeLine{02489\ \textcolor{comment}{//\ \ ASSERT(a\_level\ >=\ 0\ \&\&\ a\_level\ <=\ a\_node-\/>m\_level);}}
\DoxyCodeLine{02490\ \textcolor{comment}{//}}
\DoxyCodeLine{02491\ \textcolor{comment}{//\ \ //\ recurse\ until\ we\ reach\ the\ correct\ level\ for\ the\ new\ record.\ data\ records}}
\DoxyCodeLine{02492\ \textcolor{comment}{//\ \ //\ will\ always\ be\ called\ with\ a\_level\ ==\ 0\ (leaf)}}
\DoxyCodeLine{02493\ \textcolor{comment}{//\ \ if\ (a\_node-\/>m\_level\ >\ a\_level)\ \{}}
\DoxyCodeLine{02494\ \textcolor{comment}{//\ \ \ \ \ \ //\ Still\ above\ level\ for\ insertion,\ go\ down\ tree\ recursively}}
\DoxyCodeLine{02495\ \textcolor{comment}{//\ \ \ \ \ \ Node*\ otherNode;}}
\DoxyCodeLine{02496\ \textcolor{comment}{//}}
\DoxyCodeLine{02497\ \textcolor{comment}{//\ \ \ \ \ \ //\ find\ the\ optimal\ branch\ for\ this\ record}}
\DoxyCodeLine{02498\ \textcolor{comment}{//\ \ \ \ \ \ int\ index\ =\ PickBranch(\&a\_branch.m\_rect,\ a\_node);}}
\DoxyCodeLine{02499\ \textcolor{comment}{//}}
\DoxyCodeLine{02500\ \textcolor{comment}{//\ \ \ \ \ \ //\ recursively\ insert\ this\ record\ into\ the\ picked\ branch}}
\DoxyCodeLine{02501\ \textcolor{comment}{//\ \ \ \ \ \ bool\ childWasSplit\ =\ InsertRectRec(a\_branch,\ a\_node-\/>m\_branch[index].m\_child,\ \&otherNode,\ a\_level);}}
\DoxyCodeLine{02502\ \textcolor{comment}{//}}
\DoxyCodeLine{02503\ \textcolor{comment}{//\ \ \ \ \ \ if\ (!childWasSplit)\ \{}}
\DoxyCodeLine{02504\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ Child\ was\ not\ split.\ Merge\ the\ bounding\ box\ of\ the\ new\ record\ with\ the}}
\DoxyCodeLine{02505\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ existing\ bounding\ box}}
\DoxyCodeLine{02506\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_node-\/>m\_branch[index].m\_rect\ =\ CombineRect(\&a\_branch.m\_rect,\ \&(a\_node-\/>m\_branch[index].m\_rect));}}
\DoxyCodeLine{02507\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{02508\ \textcolor{comment}{//\ \ \ \ \ \ \}\ else\ \{}}
\DoxyCodeLine{02509\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ Child\ was\ split.\ The\ old\ branches\ are\ now\ re-\/partitioned\ to\ two\ nodes}}
\DoxyCodeLine{02510\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ so\ we\ have\ to\ re-\/calculate\ the\ bounding\ boxes\ of\ each\ node}}
\DoxyCodeLine{02511\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_node-\/>m\_branch[index].m\_rect\ =\ NodeCover(a\_node-\/>m\_branch[index].m\_child);}}
\DoxyCodeLine{02512\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Branch\ branch;}}
\DoxyCodeLine{02513\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ branch.m\_child\ =\ otherNode;}}
\DoxyCodeLine{02514\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ branch.m\_rect\ =\ NodeCover(otherNode);}}
\DoxyCodeLine{02515\ \textcolor{comment}{//}}
\DoxyCodeLine{02516\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ The\ old\ node\ is\ already\ a\ child\ of\ a\_node.\ Now\ add\ the\ newly-\/created}}
\DoxyCodeLine{02517\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ //\ node\ to\ a\_node\ as\ well.\ a\_node\ might\ be\ split\ because\ of\ that.}}
\DoxyCodeLine{02518\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ return\ AddBranch(\&branch,\ a\_node,\ a\_newNode);}}
\DoxyCodeLine{02519\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02520\ \textcolor{comment}{//\ \ \}\ else\ if\ (a\_node-\/>m\_level\ ==\ a\_level)\ \{}}
\DoxyCodeLine{02521\ \textcolor{comment}{//\ \ \ \ \ \ //\ We\ have\ reached\ level\ for\ insertion.\ Add\ rect,\ split\ if\ necessary}}
\DoxyCodeLine{02522\ \textcolor{comment}{//\ \ \ \ \ \ return\ AddBranch(\&a\_branch,\ a\_node,\ a\_newNode);}}
\DoxyCodeLine{02523\ \textcolor{comment}{//\ \ \}\ else\ \{}}
\DoxyCodeLine{02524\ \textcolor{comment}{//\ \ \ \ \ \ //\ Should\ never\ occur}}
\DoxyCodeLine{02525\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(0);}}
\DoxyCodeLine{02526\ \textcolor{comment}{//\ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{02527\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02528\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02529\ \textcolor{comment}{//}}
\DoxyCodeLine{02530\ \textcolor{comment}{//}}
\DoxyCodeLine{02538\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02539\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::InsertRect(const\ Branch\&\ a\_branch,\ Node**\ a\_root,\ int\ a\_level)\ \{}}
\DoxyCodeLine{02540\ \textcolor{comment}{//\ \ ASSERT(a\_root);}}
\DoxyCodeLine{02541\ \textcolor{comment}{//\ \ ASSERT(a\_level\ >=\ 0\ \&\&\ a\_level\ <=\ (*a\_root)-\/>m\_level);}}
\DoxyCodeLine{02542\ \textcolor{comment}{//\#ifdef\ \_DEBUG}}
\DoxyCodeLine{02543\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02544\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(a\_branch.m\_rect.m\_min[index]\ <=\ a\_branch.m\_rect.m\_max[index]);}}
\DoxyCodeLine{02545\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02546\ \textcolor{comment}{//\#endif\ //\_DEBUG}}
\DoxyCodeLine{02547\ \textcolor{comment}{//}}
\DoxyCodeLine{02548\ \textcolor{comment}{//\ \ Node*\ newNode;}}
\DoxyCodeLine{02549\ \textcolor{comment}{//}}
\DoxyCodeLine{02550\ \textcolor{comment}{//\ \ if\ (InsertRectRec(a\_branch,\ *a\_root,\ \&newNode,\ a\_level))\ \ //\ Root\ split}}
\DoxyCodeLine{02551\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02552\ \textcolor{comment}{//\ \ \ \ \ \ //\ Grow\ tree\ taller\ and\ new\ root}}
\DoxyCodeLine{02553\ \textcolor{comment}{//\ \ \ \ \ \ Node*\ newRoot\ =\ AllocNode();}}
\DoxyCodeLine{02554\ \textcolor{comment}{//\ \ \ \ \ \ newRoot-\/>m\_level\ =\ (*a\_root)-\/>m\_level\ +\ 1;}}
\DoxyCodeLine{02555\ \textcolor{comment}{//}}
\DoxyCodeLine{02556\ \textcolor{comment}{//\ \ \ \ \ \ Branch\ branch;}}
\DoxyCodeLine{02557\ \textcolor{comment}{//}}
\DoxyCodeLine{02558\ \textcolor{comment}{//\ \ \ \ \ \ //\ add\ old\ root\ node\ as\ a\ child\ of\ the\ new\ root}}
\DoxyCodeLine{02559\ \textcolor{comment}{//\ \ \ \ \ \ branch.m\_rect\ =\ NodeCover(*a\_root);}}
\DoxyCodeLine{02560\ \textcolor{comment}{//\ \ \ \ \ \ branch.m\_child\ =\ *a\_root;}}
\DoxyCodeLine{02561\ \textcolor{comment}{//\ \ \ \ \ \ AddBranch(\&branch,\ newRoot,\ NULL);}}
\DoxyCodeLine{02562\ \textcolor{comment}{//}}
\DoxyCodeLine{02563\ \textcolor{comment}{//\ \ \ \ \ \ //\ add\ the\ split\ node\ as\ a\ child\ of\ the\ new\ root}}
\DoxyCodeLine{02564\ \textcolor{comment}{//\ \ \ \ \ \ branch.m\_rect\ =\ NodeCover(newNode);}}
\DoxyCodeLine{02565\ \textcolor{comment}{//\ \ \ \ \ \ branch.m\_child\ =\ newNode;}}
\DoxyCodeLine{02566\ \textcolor{comment}{//\ \ \ \ \ \ AddBranch(\&branch,\ newRoot,\ NULL);}}
\DoxyCodeLine{02567\ \textcolor{comment}{//}}
\DoxyCodeLine{02568\ \textcolor{comment}{//\ \ \ \ \ \ //\ set\ the\ new\ root\ as\ the\ root\ node}}
\DoxyCodeLine{02569\ \textcolor{comment}{//\ \ \ \ \ \ *a\_root\ =\ newRoot;}}
\DoxyCodeLine{02570\ \textcolor{comment}{//}}
\DoxyCodeLine{02571\ \textcolor{comment}{//\ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{02572\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02573\ \textcolor{comment}{//}}
\DoxyCodeLine{02574\ \textcolor{comment}{//\ \ return\ false;}}
\DoxyCodeLine{02575\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02576\ \textcolor{comment}{//}}
\DoxyCodeLine{02577\ \textcolor{comment}{//}}
\DoxyCodeLine{02579\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02580\ \textcolor{comment}{//\ typename\ RTREE\_QUAL::Rect\ RTREE\_QUAL::NodeCover(Node*\ a\_node)\ \{}}
\DoxyCodeLine{02581\ \textcolor{comment}{//\ \ ASSERT(a\_node);}}
\DoxyCodeLine{02582\ \textcolor{comment}{//}}
\DoxyCodeLine{02583\ \textcolor{comment}{//\ \ Rect\ rect\ =\ a\_node-\/>m\_branch[0].m\_rect;}}
\DoxyCodeLine{02584\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 1;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02585\ \textcolor{comment}{//\ \ \ \ \ \ rect\ =\ CombineRect(\&rect,\ \&(a\_node-\/>m\_branch[index].m\_rect));}}
\DoxyCodeLine{02586\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02587\ \textcolor{comment}{//}}
\DoxyCodeLine{02588\ \textcolor{comment}{//\ \ return\ rect;}}
\DoxyCodeLine{02589\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02590\ \textcolor{comment}{//}}
\DoxyCodeLine{02591\ \textcolor{comment}{//}}
\DoxyCodeLine{02596\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02597\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::AddBranch(const\ Branch*\ a\_branch,\ Node*\ a\_node,\ Node**\ a\_newNode)\ \{}}
\DoxyCodeLine{02598\ \textcolor{comment}{//\ \ ASSERT(a\_branch);}}
\DoxyCodeLine{02599\ \textcolor{comment}{//\ \ ASSERT(a\_node);}}
\DoxyCodeLine{02600\ \textcolor{comment}{//}}
\DoxyCodeLine{02601\ \textcolor{comment}{//\ \ if\ (a\_node-\/>m\_count\ <\ MAXNODES)\ \ //\ Split\ won't\ be\ necessary}}
\DoxyCodeLine{02602\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{02603\ \textcolor{comment}{//\ \ \ \ \ \ a\_node-\/>m\_branch[a\_node-\/>m\_count]\ =\ *a\_branch;}}
\DoxyCodeLine{02604\ \textcolor{comment}{//\ \ \ \ \ \ ++a\_node-\/>m\_count;}}
\DoxyCodeLine{02605\ \textcolor{comment}{//}}
\DoxyCodeLine{02606\ \textcolor{comment}{//\ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{02607\ \textcolor{comment}{//\ \ \}\ else\ \{}}
\DoxyCodeLine{02608\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(a\_newNode);}}
\DoxyCodeLine{02609\ \textcolor{comment}{//}}
\DoxyCodeLine{02610\ \textcolor{comment}{//\ \ \ \ \ \ SplitNode(a\_node,\ a\_branch,\ a\_newNode);}}
\DoxyCodeLine{02611\ \textcolor{comment}{//\ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{02612\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02613\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02614\ \textcolor{comment}{//}}
\DoxyCodeLine{02615\ \textcolor{comment}{//}}
\DoxyCodeLine{02618\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02619\ \textcolor{comment}{//\ void\ RTREE\_QUAL::DisconnectBranch(Node*\ a\_node,\ int\ a\_index)\ \{}}
\DoxyCodeLine{02620\ \textcolor{comment}{//\ \ ASSERT(a\_node\ \&\&\ (a\_index\ >=\ 0)\ \&\&\ (a\_index\ <\ MAXNODES));}}
\DoxyCodeLine{02621\ \textcolor{comment}{//\ \ ASSERT(a\_node-\/>m\_count\ >\ 0);}}
\DoxyCodeLine{02622\ \textcolor{comment}{//}}
\DoxyCodeLine{02623\ \textcolor{comment}{//\ \ //\ Remove\ element\ by\ swapping\ with\ the\ last\ element\ to\ prevent\ gaps\ in\ array}}
\DoxyCodeLine{02624\ \textcolor{comment}{//\ \ a\_node-\/>m\_branch[a\_index]\ =\ a\_node-\/>m\_branch[a\_node-\/>m\_count\ -\/\ 1];}}
\DoxyCodeLine{02625\ \textcolor{comment}{//}}
\DoxyCodeLine{02626\ \textcolor{comment}{//\ \ -\/-\/a\_node-\/>m\_count;}}
\DoxyCodeLine{02627\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02628\ \textcolor{comment}{//}}
\DoxyCodeLine{02629\ \textcolor{comment}{//}}
\DoxyCodeLine{02635\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02636\ \textcolor{comment}{//\ int\ RTREE\_QUAL::PickBranch(const\ Rect*\ a\_rect,\ Node*\ a\_node)\ \{}}
\DoxyCodeLine{02637\ \textcolor{comment}{//\ \ ASSERT(a\_rect\ \&\&\ a\_node);}}
\DoxyCodeLine{02638\ \textcolor{comment}{//}}
\DoxyCodeLine{02639\ \textcolor{comment}{//\ \ bool\ firstTime\ =\ true;}}
\DoxyCodeLine{02640\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ increase;}}
\DoxyCodeLine{02641\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ bestIncr\ =\ (ELEMTYPEREAL)-\/1;}}
\DoxyCodeLine{02642\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ area;}}
\DoxyCodeLine{02643\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ bestArea;}}
\DoxyCodeLine{02644\ \textcolor{comment}{//\ \ int\ best\ =\ 0;}}
\DoxyCodeLine{02645\ \textcolor{comment}{//\ \ Rect\ tempRect;}}
\DoxyCodeLine{02646\ \textcolor{comment}{//}}
\DoxyCodeLine{02647\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02648\ \textcolor{comment}{//\ \ \ \ \ \ Rect*\ curRect\ =\ \&a\_node-\/>m\_branch[index].m\_rect;}}
\DoxyCodeLine{02649\ \textcolor{comment}{//\ \ \ \ \ \ area\ =\ CalcRectVolume(curRect);}}
\DoxyCodeLine{02650\ \textcolor{comment}{//\ \ \ \ \ \ tempRect\ =\ CombineRect(a\_rect,\ curRect);}}
\DoxyCodeLine{02651\ \textcolor{comment}{//\ \ \ \ \ \ increase\ =\ CalcRectVolume(\&tempRect)\ -\/\ area;}}
\DoxyCodeLine{02652\ \textcolor{comment}{//\ \ \ \ \ \ if\ ((increase\ <\ bestIncr)\ ||\ firstTime)\ \{}}
\DoxyCodeLine{02653\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ best\ =\ index;}}
\DoxyCodeLine{02654\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bestArea\ =\ area;}}
\DoxyCodeLine{02655\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bestIncr\ =\ increase;}}
\DoxyCodeLine{02656\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ firstTime\ =\ false;}}
\DoxyCodeLine{02657\ \textcolor{comment}{//\ \ \ \ \ \ \}\ else\ if\ ((increase\ ==\ bestIncr)\ \&\&\ (area\ <\ bestArea))\ \{}}
\DoxyCodeLine{02658\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ best\ =\ index;}}
\DoxyCodeLine{02659\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bestArea\ =\ area;}}
\DoxyCodeLine{02660\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ bestIncr\ =\ increase;}}
\DoxyCodeLine{02661\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02662\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02663\ \textcolor{comment}{//\ \ return\ best;}}
\DoxyCodeLine{02664\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02665\ \textcolor{comment}{//}}
\DoxyCodeLine{02666\ \textcolor{comment}{//}}
\DoxyCodeLine{02668\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02669\ \textcolor{comment}{//\ typename\ RTREE\_QUAL::Rect\ RTREE\_QUAL::CombineRect(const\ Rect*\ a\_rectA,\ const\ Rect*\ a\_rectB)\ \{}}
\DoxyCodeLine{02670\ \textcolor{comment}{//\ \ ASSERT(a\_rectA\ \&\&\ a\_rectB);}}
\DoxyCodeLine{02671\ \textcolor{comment}{//}}
\DoxyCodeLine{02672\ \textcolor{comment}{//\ \ Rect\ newRect;}}
\DoxyCodeLine{02673\ \textcolor{comment}{//}}
\DoxyCodeLine{02674\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02675\ \textcolor{comment}{//\ \ \ \ \ \ newRect.m\_min[index]\ =\ Min(a\_rectA-\/>m\_min[index],\ a\_rectB-\/>m\_min[index]);}}
\DoxyCodeLine{02676\ \textcolor{comment}{//\ \ \ \ \ \ newRect.m\_max[index]\ =\ Max(a\_rectA-\/>m\_max[index],\ a\_rectB-\/>m\_max[index]);}}
\DoxyCodeLine{02677\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02678\ \textcolor{comment}{//}}
\DoxyCodeLine{02679\ \textcolor{comment}{//\ \ return\ newRect;}}
\DoxyCodeLine{02680\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02681\ \textcolor{comment}{//}}
\DoxyCodeLine{02682\ \textcolor{comment}{//}}
\DoxyCodeLine{02683\ \textcolor{comment}{//}}
\DoxyCodeLine{02688\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02689\ \textcolor{comment}{//\ void\ RTREE\_QUAL::SplitNode(Node*\ a\_node,\ const\ Branch*\ a\_branch,\ Node**\ a\_newNode)\ \{}}
\DoxyCodeLine{02690\ \textcolor{comment}{//\ \ ASSERT(a\_node);}}
\DoxyCodeLine{02691\ \textcolor{comment}{//\ \ ASSERT(a\_branch);}}
\DoxyCodeLine{02692\ \textcolor{comment}{//}}
\DoxyCodeLine{02693\ \textcolor{comment}{//\ \ //\ Could\ just\ use\ local\ here,\ but\ member\ or\ external\ is\ faster\ since\ it\ is\ reused}}
\DoxyCodeLine{02694\ \textcolor{comment}{//\ \ PartitionVars\ localVars;}}
\DoxyCodeLine{02695\ \textcolor{comment}{//\ \ PartitionVars*\ parVars\ =\ \&localVars;}}
\DoxyCodeLine{02696\ \textcolor{comment}{//}}
\DoxyCodeLine{02697\ \textcolor{comment}{//\ \ //\ Load\ all\ the\ branches\ into\ a\ buffer,\ initialize\ old\ node}}
\DoxyCodeLine{02698\ \textcolor{comment}{//\ \ GetBranches(a\_node,\ a\_branch,\ parVars);}}
\DoxyCodeLine{02699\ \textcolor{comment}{//}}
\DoxyCodeLine{02700\ \textcolor{comment}{//\ \ //\ Find\ partition}}
\DoxyCodeLine{02701\ \textcolor{comment}{//\ \ ChoosePartition(parVars,\ MINNODES);}}
\DoxyCodeLine{02702\ \textcolor{comment}{//}}
\DoxyCodeLine{02703\ \textcolor{comment}{//\ \ //\ Create\ a\ new\ node\ to\ hold\ (about)\ half\ of\ the\ branches}}
\DoxyCodeLine{02704\ \textcolor{comment}{//\ \ *a\_newNode\ =\ AllocNode();}}
\DoxyCodeLine{02705\ \textcolor{comment}{//\ \ (*a\_newNode)-\/>m\_level\ =\ a\_node-\/>m\_level;}}
\DoxyCodeLine{02706\ \textcolor{comment}{//}}
\DoxyCodeLine{02707\ \textcolor{comment}{//\ \ //\ Put\ branches\ from\ buffer\ into\ 2\ nodes\ according\ to\ the\ chosen\ partition}}
\DoxyCodeLine{02708\ \textcolor{comment}{//\ \ a\_node-\/>m\_count\ =\ 0;}}
\DoxyCodeLine{02709\ \textcolor{comment}{//\ \ LoadNodes(a\_node,\ *a\_newNode,\ parVars);}}
\DoxyCodeLine{02710\ \textcolor{comment}{//}}
\DoxyCodeLine{02711\ \textcolor{comment}{//\ \ ASSERT((a\_node-\/>m\_count\ +\ (*a\_newNode)-\/>m\_count)\ ==\ parVars-\/>m\_total);}}
\DoxyCodeLine{02712\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02713\ \textcolor{comment}{//}}
\DoxyCodeLine{02714\ \textcolor{comment}{//}}
\DoxyCodeLine{02716\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02717\ \textcolor{comment}{//\ ELEMTYPEREAL\ RTREE\_QUAL::RectVolume(Rect*\ a\_rect)\ \{}}
\DoxyCodeLine{02718\ \textcolor{comment}{//\ \ ASSERT(a\_rect);}}
\DoxyCodeLine{02719\ \textcolor{comment}{//}}
\DoxyCodeLine{02720\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ volume\ =\ (ELEMTYPEREAL)1;}}
\DoxyCodeLine{02721\ \textcolor{comment}{//}}
\DoxyCodeLine{02722\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02723\ \textcolor{comment}{//\ \ \ \ \ \ volume\ *=\ a\_rect-\/>m\_max[index]\ -\/\ a\_rect-\/>m\_min[index];}}
\DoxyCodeLine{02724\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02725\ \textcolor{comment}{//}}
\DoxyCodeLine{02726\ \textcolor{comment}{//\ \ ASSERT(volume\ >=\ (ELEMTYPEREAL)0);}}
\DoxyCodeLine{02727\ \textcolor{comment}{//}}
\DoxyCodeLine{02728\ \textcolor{comment}{//\ \ return\ volume;}}
\DoxyCodeLine{02729\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02730\ \textcolor{comment}{//}}
\DoxyCodeLine{02731\ \textcolor{comment}{//}}
\DoxyCodeLine{02733\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02734\ \textcolor{comment}{//\ ELEMTYPEREAL\ RTREE\_QUAL::RectSphericalVolume(Rect*\ a\_rect)\ \{}}
\DoxyCodeLine{02735\ \textcolor{comment}{//\ \ ASSERT(a\_rect);}}
\DoxyCodeLine{02736\ \textcolor{comment}{//}}
\DoxyCodeLine{02737\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ sumOfSquares\ =\ (ELEMTYPEREAL)0;}}
\DoxyCodeLine{02738\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ radius;}}
\DoxyCodeLine{02739\ \textcolor{comment}{//}}
\DoxyCodeLine{02740\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{02741\ \textcolor{comment}{//\ \ \ \ \ \ ELEMTYPEREAL\ halfExtent\ =\ ((ELEMTYPEREAL)a\_rect-\/>m\_max[index]\ -\/\ (ELEMTYPEREAL)a\_rect-\/>m\_min[index])\ *\ (ELEMTYPEREAL)0.5;}}
\DoxyCodeLine{02742\ \textcolor{comment}{//\ \ \ \ \ \ sumOfSquares\ +=\ halfExtent\ *\ halfExtent;}}
\DoxyCodeLine{02743\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02744\ \textcolor{comment}{//}}
\DoxyCodeLine{02745\ \textcolor{comment}{//\ \ radius\ =\ (ELEMTYPEREAL)sqrt(sumOfSquares);}}
\DoxyCodeLine{02746\ \textcolor{comment}{//}}
\DoxyCodeLine{02747\ \textcolor{comment}{//\ \ //\ Pow\ maybe\ slow,\ so\ test\ for\ common\ dims\ like\ 2,3\ and\ just\ use\ x*x,\ x*x*x.}}
\DoxyCodeLine{02748\ \textcolor{comment}{//\ \ if\ (NUMDIMS\ ==\ 3)\ \{}}
\DoxyCodeLine{02749\ \textcolor{comment}{//\ \ \ \ \ \ return\ (radius\ *\ radius\ *\ radius\ *\ m\_unitSphereVolume);}}
\DoxyCodeLine{02750\ \textcolor{comment}{//\ \ \}\ else\ if\ (NUMDIMS\ ==\ 2)\ \{}}
\DoxyCodeLine{02751\ \textcolor{comment}{//\ \ \ \ \ \ return\ (radius\ *\ radius\ *\ m\_unitSphereVolume);}}
\DoxyCodeLine{02752\ \textcolor{comment}{//\ \ \}\ else\ \{}}
\DoxyCodeLine{02753\ \textcolor{comment}{//\ \ \ \ \ \ return\ (ELEMTYPEREAL)(pow(radius,\ NUMDIMS)\ *\ m\_unitSphereVolume);}}
\DoxyCodeLine{02754\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02755\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02756\ \textcolor{comment}{//}}
\DoxyCodeLine{02757\ \textcolor{comment}{//}}
\DoxyCodeLine{02759\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02760\ \textcolor{comment}{//\ ELEMTYPEREAL\ RTREE\_QUAL::CalcRectVolume(Rect*\ a\_rect)\ \{}}
\DoxyCodeLine{02761\ \textcolor{comment}{//\#ifdef\ RTREE\_USE\_SPHERICAL\_VOLUME}}
\DoxyCodeLine{02762\ \textcolor{comment}{//\ \ return\ RectSphericalVolume(a\_rect);\ //\ Slower\ but\ helps\ certain\ merge\ cases}}
\DoxyCodeLine{02763\ \textcolor{comment}{//\#else\ //\ RTREE\_USE\_SPHERICAL\_VOLUME}}
\DoxyCodeLine{02764\ \textcolor{comment}{//\ \ return\ RectVolume(a\_rect);\ //\ Faster\ but\ can\ cause\ poor\ merges}}
\DoxyCodeLine{02765\ \textcolor{comment}{//\#endif\ //\ RTREE\_USE\_SPHERICAL\_VOLUME}}
\DoxyCodeLine{02766\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02767\ \textcolor{comment}{//}}
\DoxyCodeLine{02768\ \textcolor{comment}{//}}
\DoxyCodeLine{02770\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02771\ \textcolor{comment}{//\ void\ RTREE\_QUAL::GetBranches(Node*\ a\_node,\ const\ Branch*\ a\_branch,\ PartitionVars*\ a\_parVars)\ \{}}
\DoxyCodeLine{02772\ \textcolor{comment}{//\ \ ASSERT(a\_node);}}
\DoxyCodeLine{02773\ \textcolor{comment}{//\ \ ASSERT(a\_branch);}}
\DoxyCodeLine{02774\ \textcolor{comment}{//}}
\DoxyCodeLine{02775\ \textcolor{comment}{//\ \ ASSERT(a\_node-\/>m\_count\ ==\ MAXNODES);}}
\DoxyCodeLine{02776\ \textcolor{comment}{//}}
\DoxyCodeLine{02777\ \textcolor{comment}{//\ \ //\ Load\ the\ branch\ buffer}}
\DoxyCodeLine{02778\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ MAXNODES;\ ++index)\ \{}}
\DoxyCodeLine{02779\ \textcolor{comment}{//\ \ \ \ \ \ a\_parVars-\/>m\_branchBuf[index]\ =\ a\_node-\/>m\_branch[index];}}
\DoxyCodeLine{02780\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02781\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_branchBuf[MAXNODES]\ =\ *a\_branch;}}
\DoxyCodeLine{02782\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_branchCount\ =\ MAXNODES\ +\ 1;}}
\DoxyCodeLine{02783\ \textcolor{comment}{//}}
\DoxyCodeLine{02784\ \textcolor{comment}{//\ \ //\ Calculate\ rect\ containing\ all\ in\ the\ set}}
\DoxyCodeLine{02785\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_coverSplit\ =\ a\_parVars-\/>m\_branchBuf[0].m\_rect;}}
\DoxyCodeLine{02786\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 1;\ index\ <\ MAXNODES\ +\ 1;\ ++index)\ \{}}
\DoxyCodeLine{02787\ \textcolor{comment}{//\ \ \ \ \ \ a\_parVars-\/>m\_coverSplit\ =\ CombineRect(\&a\_parVars-\/>m\_coverSplit,\ \&a\_parVars-\/>m\_branchBuf[index].m\_rect);}}
\DoxyCodeLine{02788\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02789\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_coverSplitArea\ =\ CalcRectVolume(\&a\_parVars-\/>m\_coverSplit);}}
\DoxyCodeLine{02790\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02791\ \textcolor{comment}{//}}
\DoxyCodeLine{02792\ \textcolor{comment}{//}}
\DoxyCodeLine{02804\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02805\ \textcolor{comment}{//\ void\ RTREE\_QUAL::ChoosePartition(PartitionVars*\ a\_parVars,\ int\ a\_minFill)\ \{}}
\DoxyCodeLine{02806\ \textcolor{comment}{//\ \ ASSERT(a\_parVars);}}
\DoxyCodeLine{02807\ \textcolor{comment}{//}}
\DoxyCodeLine{02808\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ biggestDiff;}}
\DoxyCodeLine{02809\ \textcolor{comment}{//\ \ int\ group,\ chosen\ =\ 0,\ betterGroup\ =\ 0;}}
\DoxyCodeLine{02810\ \textcolor{comment}{//}}
\DoxyCodeLine{02811\ \textcolor{comment}{//\ \ InitParVars(a\_parVars,\ a\_parVars-\/>m\_branchCount,\ a\_minFill);}}
\DoxyCodeLine{02812\ \textcolor{comment}{//\ \ PickSeeds(a\_parVars);}}
\DoxyCodeLine{02813\ \textcolor{comment}{//}}
\DoxyCodeLine{02814\ \textcolor{comment}{//\ \ while\ (((a\_parVars-\/>m\_count[0]\ +\ a\_parVars-\/>m\_count[1])\ <\ a\_parVars-\/>m\_total)}}
\DoxyCodeLine{02815\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (a\_parVars-\/>m\_count[0]\ <\ (a\_parVars-\/>m\_total\ -\/\ a\_parVars-\/>m\_minFill))}}
\DoxyCodeLine{02816\ \textcolor{comment}{//\ \ \ \ \ \ \&\&\ (a\_parVars-\/>m\_count[1]\ <\ (a\_parVars-\/>m\_total\ -\/\ a\_parVars-\/>m\_minFill)))\ \{}}
\DoxyCodeLine{02817\ \textcolor{comment}{//\ \ \ \ \ \ biggestDiff\ =\ (ELEMTYPEREAL)-\/1;}}
\DoxyCodeLine{02818\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)\ \{}}
\DoxyCodeLine{02819\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ if\ (PartitionVars::NOT\_TAKEN\ ==\ a\_parVars-\/>m\_partition[index])\ \{}}
\DoxyCodeLine{02820\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Rect*\ curRect\ =\ \&a\_parVars-\/>m\_branchBuf[index].m\_rect;}}
\DoxyCodeLine{02821\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Rect\ rect0\ =\ CombineRect(curRect,\ \&a\_parVars-\/>m\_cover[0]);}}
\DoxyCodeLine{02822\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Rect\ rect1\ =\ CombineRect(curRect,\ \&a\_parVars-\/>m\_cover[1]);}}
\DoxyCodeLine{02823\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ growth0\ =\ CalcRectVolume(\&rect0)\ -\/\ a\_parVars-\/>m\_area[0];}}
\DoxyCodeLine{02824\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ growth1\ =\ CalcRectVolume(\&rect1)\ -\/\ a\_parVars-\/>m\_area[1];}}
\DoxyCodeLine{02825\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ELEMTYPEREAL\ diff\ =\ growth1\ -\/\ growth0;}}
\DoxyCodeLine{02826\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (diff\ >=\ 0)\ \{}}
\DoxyCodeLine{02827\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ group\ =\ 0;}}
\DoxyCodeLine{02828\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ else\ \{}}
\DoxyCodeLine{02829\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ group\ =\ 1;}}
\DoxyCodeLine{02830\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diff\ =\ -\/diff;}}
\DoxyCodeLine{02831\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02832\ \textcolor{comment}{//}}
\DoxyCodeLine{02833\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (diff\ >\ biggestDiff)\ \{}}
\DoxyCodeLine{02834\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ biggestDiff\ =\ diff;}}
\DoxyCodeLine{02835\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chosen\ =\ index;}}
\DoxyCodeLine{02836\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ betterGroup\ =\ group;}}
\DoxyCodeLine{02837\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ else\ if\ ((diff\ ==\ biggestDiff)\ \&\&\ (a\_parVars-\/>m\_count[group]\ <\ a\_parVars-\/>m\_count[betterGroup]))\ \{}}
\DoxyCodeLine{02838\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chosen\ =\ index;}}
\DoxyCodeLine{02839\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ betterGroup\ =\ group;}}
\DoxyCodeLine{02840\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02841\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02842\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02843\ \textcolor{comment}{//\ \ \ \ \ \ Classify(chosen,\ betterGroup,\ a\_parVars);}}
\DoxyCodeLine{02844\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02845\ \textcolor{comment}{//}}
\DoxyCodeLine{02846\ \textcolor{comment}{//\ \ //\ If\ one\ group\ too\ full,\ put\ remaining\ rects\ in\ the\ other}}
\DoxyCodeLine{02847\ \textcolor{comment}{//\ \ if\ ((a\_parVars-\/>m\_count[0]\ +\ a\_parVars-\/>m\_count[1])\ <\ a\_parVars-\/>m\_total)\ \{}}
\DoxyCodeLine{02848\ \textcolor{comment}{//\ \ \ \ \ \ if\ (a\_parVars-\/>m\_count[0]\ >=\ a\_parVars-\/>m\_total\ -\/\ a\_parVars-\/>m\_minFill)\ \{}}
\DoxyCodeLine{02849\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ group\ =\ 1;}}
\DoxyCodeLine{02850\ \textcolor{comment}{//\ \ \ \ \ \ \}\ else\ \{}}
\DoxyCodeLine{02851\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ group\ =\ 0;}}
\DoxyCodeLine{02852\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02853\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)\ \{}}
\DoxyCodeLine{02854\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ if\ (PartitionVars::NOT\_TAKEN\ ==\ a\_parVars-\/>m\_partition[index])\ \{}}
\DoxyCodeLine{02855\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Classify(index,\ group,\ a\_parVars);}}
\DoxyCodeLine{02856\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02857\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02858\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02859\ \textcolor{comment}{//}}
\DoxyCodeLine{02860\ \textcolor{comment}{//\ \ ASSERT((a\_parVars-\/>m\_count[0]\ +\ a\_parVars-\/>m\_count[1])\ ==\ a\_parVars-\/>m\_total);}}
\DoxyCodeLine{02861\ \textcolor{comment}{//\ \ ASSERT((a\_parVars-\/>m\_count[0]\ >=\ a\_parVars-\/>m\_minFill)\ \&\&}}
\DoxyCodeLine{02862\ \textcolor{comment}{//\ \ \ \ \ \ (a\_parVars-\/>m\_count[1]\ >=\ a\_parVars-\/>m\_minFill));}}
\DoxyCodeLine{02863\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02864\ \textcolor{comment}{//}}
\DoxyCodeLine{02865\ \textcolor{comment}{//}}
\DoxyCodeLine{02867\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02868\ \textcolor{comment}{//\ void\ RTREE\_QUAL::LoadNodes(Node*\ a\_nodeA,\ Node*\ a\_nodeB,\ PartitionVars*\ a\_parVars)\ \{}}
\DoxyCodeLine{02869\ \textcolor{comment}{//\ \ ASSERT(a\_nodeA);}}
\DoxyCodeLine{02870\ \textcolor{comment}{//\ \ ASSERT(a\_nodeB);}}
\DoxyCodeLine{02871\ \textcolor{comment}{//\ \ ASSERT(a\_parVars);}}
\DoxyCodeLine{02872\ \textcolor{comment}{//}}
\DoxyCodeLine{02873\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)\ \{}}
\DoxyCodeLine{02874\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(a\_parVars-\/>m\_partition[index]\ ==\ 0\ ||\ a\_parVars-\/>m\_partition[index]\ ==\ 1);}}
\DoxyCodeLine{02875\ \textcolor{comment}{//}}
\DoxyCodeLine{02876\ \textcolor{comment}{//\ \ \ \ \ \ int\ targetNodeIndex\ =\ a\_parVars-\/>m\_partition[index];}}
\DoxyCodeLine{02877\ \textcolor{comment}{//\ \ \ \ \ \ Node*\ targetNodes[]\ =\ \{\ a\_nodeA,\ a\_nodeB\ \};}}
\DoxyCodeLine{02878\ \textcolor{comment}{//}}
\DoxyCodeLine{02879\ \textcolor{comment}{//\ \ \ \ \ \ //\ It\ is\ assured\ that\ AddBranch\ here\ will\ not\ cause\ a\ node\ split.}}
\DoxyCodeLine{02880\ \textcolor{comment}{//\ \ \ \ \ \ bool\ nodeWasSplit\ =\ AddBranch(\&a\_parVars-\/>m\_branchBuf[index],\ targetNodes[targetNodeIndex],\ NULL);}}
\DoxyCodeLine{02881\ \textcolor{comment}{//\ \ \ \ \ \ ASSERT(!nodeWasSplit);}}
\DoxyCodeLine{02882\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02883\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02884\ \textcolor{comment}{//}}
\DoxyCodeLine{02885\ \textcolor{comment}{//}}
\DoxyCodeLine{02887\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02888\ \textcolor{comment}{//\ void\ RTREE\_QUAL::InitParVars(PartitionVars*\ a\_parVars,\ int\ a\_maxRects,\ int\ a\_minFill)\ \{}}
\DoxyCodeLine{02889\ \textcolor{comment}{//\ \ ASSERT(a\_parVars);}}
\DoxyCodeLine{02890\ \textcolor{comment}{//}}
\DoxyCodeLine{02891\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_count[0]\ =\ a\_parVars-\/>m\_count[1]\ =\ 0;}}
\DoxyCodeLine{02892\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_area[0]\ =\ a\_parVars-\/>m\_area[1]\ =\ (ELEMTYPEREAL)0;}}
\DoxyCodeLine{02893\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_total\ =\ a\_maxRects;}}
\DoxyCodeLine{02894\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_minFill\ =\ a\_minFill;}}
\DoxyCodeLine{02895\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_maxRects;\ ++index)\ \{}}
\DoxyCodeLine{02896\ \textcolor{comment}{//\ \ \ \ \ \ a\_parVars-\/>m\_partition[index]\ =\ PartitionVars::NOT\_TAKEN;}}
\DoxyCodeLine{02897\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02898\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02899\ \textcolor{comment}{//}}
\DoxyCodeLine{02900\ \textcolor{comment}{//}}
\DoxyCodeLine{02901\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02902\ \textcolor{comment}{//\ void\ RTREE\_QUAL::PickSeeds(PartitionVars*\ a\_parVars)\ \{}}
\DoxyCodeLine{02903\ \textcolor{comment}{//\ \ int\ seed0\ =\ 0,\ seed1\ =\ 0;}}
\DoxyCodeLine{02904\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ worst,\ waste;}}
\DoxyCodeLine{02905\ \textcolor{comment}{//\ \ ELEMTYPEREAL\ area[MAXNODES\ +\ 1];}}
\DoxyCodeLine{02906\ \textcolor{comment}{//}}
\DoxyCodeLine{02907\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_parVars-\/>m\_total;\ ++index)\ \{}}
\DoxyCodeLine{02908\ \textcolor{comment}{//\ \ \ \ \ \ area[index]\ =\ CalcRectVolume(\&a\_parVars-\/>m\_branchBuf[index].m\_rect);}}
\DoxyCodeLine{02909\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02910\ \textcolor{comment}{//}}
\DoxyCodeLine{02911\ \textcolor{comment}{//\ \ worst\ =\ -\/a\_parVars-\/>m\_coverSplitArea\ -\/\ 1;}}
\DoxyCodeLine{02912\ \textcolor{comment}{//\ \ for\ (int\ indexA\ =\ 0;\ indexA\ <\ a\_parVars-\/>m\_total\ -\/\ 1;\ ++indexA)\ \{}}
\DoxyCodeLine{02913\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ indexB\ =\ indexA\ +\ 1;\ indexB\ <\ a\_parVars-\/>m\_total;\ ++indexB)\ \{}}
\DoxyCodeLine{02914\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Rect\ oneRect\ =\ CombineRect(\&a\_parVars-\/>m\_branchBuf[indexA].m\_rect,\ \&a\_parVars-\/>m\_branchBuf[indexB].m\_rect);}}
\DoxyCodeLine{02915\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ waste\ =\ CalcRectVolume(\&oneRect)\ -\/\ area[indexA]\ -\/\ area[indexB];}}
\DoxyCodeLine{02916\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ if\ (waste\ >\ worst)\ \{}}
\DoxyCodeLine{02917\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ worst\ =\ waste;}}
\DoxyCodeLine{02918\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ seed0\ =\ indexA;}}
\DoxyCodeLine{02919\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ seed1\ =\ indexB;}}
\DoxyCodeLine{02920\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02921\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02922\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02923\ \textcolor{comment}{//}}
\DoxyCodeLine{02924\ \textcolor{comment}{//\ \ Classify(seed0,\ 0,\ a\_parVars);}}
\DoxyCodeLine{02925\ \textcolor{comment}{//\ \ Classify(seed1,\ 1,\ a\_parVars);}}
\DoxyCodeLine{02926\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02927\ \textcolor{comment}{//}}
\DoxyCodeLine{02928\ \textcolor{comment}{//}}
\DoxyCodeLine{02930\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02931\ \textcolor{comment}{//\ void\ RTREE\_QUAL::Classify(int\ a\_index,\ int\ a\_group,\ PartitionVars*\ a\_parVars)\ \{}}
\DoxyCodeLine{02932\ \textcolor{comment}{//\ \ ASSERT(a\_parVars);}}
\DoxyCodeLine{02933\ \textcolor{comment}{//\ \ ASSERT(PartitionVars::NOT\_TAKEN\ ==\ a\_parVars-\/>m\_partition[a\_index]);}}
\DoxyCodeLine{02934\ \textcolor{comment}{//}}
\DoxyCodeLine{02935\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_partition[a\_index]\ =\ a\_group;}}
\DoxyCodeLine{02936\ \textcolor{comment}{//}}
\DoxyCodeLine{02937\ \textcolor{comment}{//\ \ //\ Calculate\ combined\ rect}}
\DoxyCodeLine{02938\ \textcolor{comment}{//\ \ if\ (a\_parVars-\/>m\_count[a\_group]\ ==\ 0)\ \{}}
\DoxyCodeLine{02939\ \textcolor{comment}{//\ \ \ \ \ \ a\_parVars-\/>m\_cover[a\_group]\ =\ a\_parVars-\/>m\_branchBuf[a\_index].m\_rect;}}
\DoxyCodeLine{02940\ \textcolor{comment}{//\ \ \}\ else\ \{}}
\DoxyCodeLine{02941\ \textcolor{comment}{//\ \ \ \ \ \ a\_parVars-\/>m\_cover[a\_group]\ =\ CombineRect(\&a\_parVars-\/>m\_branchBuf[a\_index].m\_rect,\ \&a\_parVars-\/>m\_cover[a\_group]);}}
\DoxyCodeLine{02942\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02943\ \textcolor{comment}{//}}
\DoxyCodeLine{02944\ \textcolor{comment}{//\ \ //\ Calculate\ volume\ of\ combined\ rect}}
\DoxyCodeLine{02945\ \textcolor{comment}{//\ \ a\_parVars-\/>m\_area[a\_group]\ =\ CalcRectVolume(\&a\_parVars-\/>m\_cover[a\_group]);}}
\DoxyCodeLine{02946\ \textcolor{comment}{//}}
\DoxyCodeLine{02947\ \textcolor{comment}{//\ \ ++a\_parVars-\/>m\_count[a\_group];}}
\DoxyCodeLine{02948\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02949\ \textcolor{comment}{//}}
\DoxyCodeLine{02950\ \textcolor{comment}{//}}
\DoxyCodeLine{02955\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{02956\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::RemoveRect(Rect*\ a\_rect,\ const\ DATATYPE\&\ a\_id,\ Node**\ a\_root)\ \{}}
\DoxyCodeLine{02957\ \textcolor{comment}{//\ \ ASSERT(a\_rect\ \&\&\ a\_root);}}
\DoxyCodeLine{02958\ \textcolor{comment}{//\ \ ASSERT(*a\_root);}}
\DoxyCodeLine{02959\ \textcolor{comment}{//}}
\DoxyCodeLine{02960\ \textcolor{comment}{//\ \ ListNode*\ reInsertList\ =\ NULL;}}
\DoxyCodeLine{02961\ \textcolor{comment}{//}}
\DoxyCodeLine{02962\ \textcolor{comment}{//\ \ if\ (!RemoveRectRec(a\_rect,\ a\_id,\ *a\_root,\ \&reInsertList))\ \{}}
\DoxyCodeLine{02963\ \textcolor{comment}{//\ \ \ \ \ \ //\ Found\ and\ deleted\ a\ data\ item}}
\DoxyCodeLine{02964\ \textcolor{comment}{//\ \ \ \ \ \ //\ Reinsert\ any\ branches\ from\ eliminated\ nodes}}
\DoxyCodeLine{02965\ \textcolor{comment}{//\ \ \ \ \ \ while\ (reInsertList)\ \{}}
\DoxyCodeLine{02966\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Node*\ tempNode\ =\ reInsertList-\/>m\_node;}}
\DoxyCodeLine{02967\ \textcolor{comment}{//}}
\DoxyCodeLine{02968\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ tempNode-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{02969\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ TODO\ go\ over\ this\ code.\ should\ I\ use\ (tempNode-\/>m\_level\ -\/\ 1)?}}
\DoxyCodeLine{02970\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ InsertRect(tempNode-\/>m\_branch[index],}}
\DoxyCodeLine{02971\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_root,}}
\DoxyCodeLine{02972\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tempNode-\/>m\_level);}}
\DoxyCodeLine{02973\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02974\ \textcolor{comment}{//}}
\DoxyCodeLine{02975\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ListNode*\ remLNode\ =\ reInsertList;}}
\DoxyCodeLine{02976\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ reInsertList\ =\ reInsertList-\/>m\_next;}}
\DoxyCodeLine{02977\ \textcolor{comment}{//}}
\DoxyCodeLine{02978\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ FreeNode(remLNode-\/>m\_node);}}
\DoxyCodeLine{02979\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ FreeListNode(remLNode);}}
\DoxyCodeLine{02980\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02981\ \textcolor{comment}{//}}
\DoxyCodeLine{02982\ \textcolor{comment}{//\ \ \ \ \ \ //\ Check\ for\ redundant\ root\ (not\ leaf,\ 1\ child)\ and\ eliminate\ TODO\ replace}}
\DoxyCodeLine{02983\ \textcolor{comment}{//\ \ \ \ \ \ //\ if\ with\ while?\ In\ case\ there\ is\ a\ whole\ branch\ of\ redundant\ roots...}}
\DoxyCodeLine{02984\ \textcolor{comment}{//\ \ \ \ \ \ if\ ((*a\_root)-\/>m\_count\ ==\ 1\ \&\&\ (*a\_root)-\/>IsInternalNode())\ \{}}
\DoxyCodeLine{02985\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Node*\ tempNode\ =\ (*a\_root)-\/>m\_branch[0].m\_child;}}
\DoxyCodeLine{02986\ \textcolor{comment}{//}}
\DoxyCodeLine{02987\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ ASSERT(tempNode);}}
\DoxyCodeLine{02988\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ FreeNode(*a\_root);}}
\DoxyCodeLine{02989\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ *a\_root\ =\ tempNode;}}
\DoxyCodeLine{02990\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{02991\ \textcolor{comment}{//\ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{02992\ \textcolor{comment}{//\ \ \}\ else\ \{}}
\DoxyCodeLine{02993\ \textcolor{comment}{//\ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{02994\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{02995\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02996\ \textcolor{comment}{//}}
\DoxyCodeLine{02997\ \textcolor{comment}{//}}
\DoxyCodeLine{03002\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{03003\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::RemoveRectRec(Rect*\ a\_rect,\ const\ DATATYPE\&\ a\_id,\ Node*\ a\_node,\ ListNode**\ a\_listNode)\ \{}}
\DoxyCodeLine{03004\ \textcolor{comment}{//\ \ ASSERT(a\_rect\ \&\&\ a\_node\ \&\&\ a\_listNode);}}
\DoxyCodeLine{03005\ \textcolor{comment}{//\ \ ASSERT(a\_node-\/>m\_level\ >=\ 0);}}
\DoxyCodeLine{03006\ \textcolor{comment}{//}}
\DoxyCodeLine{03007\ \textcolor{comment}{//\ \ if\ (a\_node-\/>IsInternalNode())\ \ //\ not\ a\ leaf\ node}}
\DoxyCodeLine{03008\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{03009\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{03010\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ if\ (Overlap(a\_rect,\ \&(a\_node-\/>m\_branch[index].m\_rect)))\ \{}}
\DoxyCodeLine{03011\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (!RemoveRectRec(a\_rect,\ a\_id,\ a\_node-\/>m\_branch[index].m\_child,\ a\_listNode))\ \{}}
\DoxyCodeLine{03012\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (a\_node-\/>m\_branch[index].m\_child-\/>m\_count\ >=\ MINNODES)\ \{}}
\DoxyCodeLine{03013\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ child\ removed,\ just\ resize\ parent\ rect}}
\DoxyCodeLine{03014\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_node-\/>m\_branch[index].m\_rect\ =\ NodeCover(a\_node-\/>m\_branch[index].m\_child);}}
\DoxyCodeLine{03015\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ else\ \{}}
\DoxyCodeLine{03016\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ child\ removed,\ not\ enough\ entries\ in\ node,\ eliminate\ node}}
\DoxyCodeLine{03017\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ReInsert(a\_node-\/>m\_branch[index].m\_child,\ a\_listNode);}}
\DoxyCodeLine{03018\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DisconnectBranch(a\_node,\ index);\ //\ Must\ return\ after\ this\ call\ as\ count\ has\ changed}}
\DoxyCodeLine{03019\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03020\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{03021\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03022\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03023\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{03024\ \textcolor{comment}{//\ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{03025\ \textcolor{comment}{//\ \ \}\ else\ //\ A\ leaf\ node}}
\DoxyCodeLine{03026\ \textcolor{comment}{//\ \ \{}}
\DoxyCodeLine{03027\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{03028\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ if\ (a\_node-\/>m\_branch[index].m\_data\ ==\ a\_id)\ \{}}
\DoxyCodeLine{03029\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ DisconnectBranch(a\_node,\ index);\ //\ Must\ return\ after\ this\ call\ as\ count\ has\ changed}}
\DoxyCodeLine{03030\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{03031\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03032\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{03033\ \textcolor{comment}{//\ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{03034\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{03035\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{03036\ \textcolor{comment}{//}}
\DoxyCodeLine{03037\ \textcolor{comment}{//}}
\DoxyCodeLine{03039\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{03040\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::Overlap(Rect*\ a\_rectA,\ Rect*\ a\_rectB)\ const\ \{}}
\DoxyCodeLine{03041\ \textcolor{comment}{//\ \ ASSERT(a\_rectA\ \&\&\ a\_rectB);}}
\DoxyCodeLine{03042\ \textcolor{comment}{//}}
\DoxyCodeLine{03043\ \textcolor{comment}{//\ \ for\ (int\ index\ =\ 0;\ index\ <\ NUMDIMS;\ ++index)\ \{}}
\DoxyCodeLine{03044\ \textcolor{comment}{//\ \ \ \ \ \ if\ (a\_rectA-\/>m\_min[index]\ >\ a\_rectB-\/>m\_max[index]\ ||}}
\DoxyCodeLine{03045\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ a\_rectB-\/>m\_min[index]\ >\ a\_rectA-\/>m\_max[index])\ \{}}
\DoxyCodeLine{03046\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{03047\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{03048\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{03049\ \textcolor{comment}{//\ \ return\ true;}}
\DoxyCodeLine{03050\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{03051\ \textcolor{comment}{//}}
\DoxyCodeLine{03052\ \textcolor{comment}{//}}
\DoxyCodeLine{03055\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{03056\ \textcolor{comment}{//\ void\ RTREE\_QUAL::ReInsert(Node*\ a\_node,\ ListNode**\ a\_listNode)\ \{}}
\DoxyCodeLine{03057\ \textcolor{comment}{//\ \ ListNode*\ newListNode;}}
\DoxyCodeLine{03058\ \textcolor{comment}{//}}
\DoxyCodeLine{03059\ \textcolor{comment}{//\ \ newListNode\ =\ AllocListNode();}}
\DoxyCodeLine{03060\ \textcolor{comment}{//\ \ newListNode-\/>m\_node\ =\ a\_node;}}
\DoxyCodeLine{03061\ \textcolor{comment}{//\ \ newListNode-\/>m\_next\ =\ *a\_listNode;}}
\DoxyCodeLine{03062\ \textcolor{comment}{//\ \ *a\_listNode\ =\ newListNode;}}
\DoxyCodeLine{03063\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{03064\ \textcolor{comment}{//}}
\DoxyCodeLine{03065\ \textcolor{comment}{//}}
\DoxyCodeLine{03067\ \textcolor{comment}{//\ RTREE\_TEMPLATE}}
\DoxyCodeLine{03068\ \textcolor{comment}{//\ bool\ RTREE\_QUAL::Search(Node*\ a\_node,\ Rect*\ a\_rect,\ int\&\ a\_foundCount,\ std::function<bool(const\ DATATYPE\&)>\ callback)\ const\ \{}}
\DoxyCodeLine{03069\ \textcolor{comment}{//\ \ ASSERT(a\_node);}}
\DoxyCodeLine{03070\ \textcolor{comment}{//\ \ ASSERT(a\_node-\/>m\_level\ >=\ 0);}}
\DoxyCodeLine{03071\ \textcolor{comment}{//\ \ ASSERT(a\_rect);}}
\DoxyCodeLine{03072\ \textcolor{comment}{//}}
\DoxyCodeLine{03073\ \textcolor{comment}{//\ \ if\ (a\_node-\/>IsInternalNode())\ \{}}
\DoxyCodeLine{03074\ \textcolor{comment}{//\ \ \ \ \ \ //\ This\ is\ an\ internal\ node\ in\ the\ tree}}
\DoxyCodeLine{03075\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{03076\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ if\ (Overlap(a\_rect,\ \&a\_node-\/>m\_branch[index].m\_rect))\ \{}}
\DoxyCodeLine{03077\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (!Search(a\_node-\/>m\_branch[index].m\_child,\ a\_rect,\ a\_foundCount,\ callback))\ \{}}
\DoxyCodeLine{03078\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ The\ callback\ indicated\ to\ stop\ searching}}
\DoxyCodeLine{03079\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{03080\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03081\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03082\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{03083\ \textcolor{comment}{//\ \ \}\ else\ \{}}
\DoxyCodeLine{03084\ \textcolor{comment}{//\ \ \ \ \ \ //\ This\ is\ a\ leaf\ node}}
\DoxyCodeLine{03085\ \textcolor{comment}{//\ \ \ \ \ \ for\ (int\ index\ =\ 0;\ index\ <\ a\_node-\/>m\_count;\ ++index)\ \{}}
\DoxyCodeLine{03086\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ if\ (Overlap(a\_rect,\ \&a\_node-\/>m\_branch[index].m\_rect))\ \{}}
\DoxyCodeLine{03087\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ DATATYPE\&\ id\ =\ a\_node-\/>m\_branch[index].m\_data;}}
\DoxyCodeLine{03088\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++a\_foundCount;}}
\DoxyCodeLine{03089\ \textcolor{comment}{//}}
\DoxyCodeLine{03090\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (callback\ \&\&\ !callback(id))\ \{}}
\DoxyCodeLine{03091\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ false;\ //\ Don't\ continue\ searching}}
\DoxyCodeLine{03092\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03093\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03094\ \textcolor{comment}{//\ \ \ \ \ \ \}}}
\DoxyCodeLine{03095\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{03096\ \textcolor{comment}{//}}
\DoxyCodeLine{03097\ \textcolor{comment}{//\ \ return\ true;\ //\ Continue\ searching}}
\DoxyCodeLine{03098\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{03099\ \textcolor{comment}{//}}
\DoxyCodeLine{03100\ \textcolor{comment}{//}}
\DoxyCodeLine{03101\ \textcolor{comment}{//\#undef\ RTREE\_TEMPLATE}}
\DoxyCodeLine{03102\ \textcolor{comment}{//\#undef\ RTREE\_QUAL}}
\DoxyCodeLine{03103\ \textcolor{comment}{//}}
\DoxyCodeLine{03104\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ RTREE\_H}}
\DoxyCodeLine{03105\ \textcolor{comment}{//}}

\end{DoxyCode}
